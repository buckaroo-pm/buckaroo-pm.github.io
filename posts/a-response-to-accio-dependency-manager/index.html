<!DOCTYPE html>
    <html>
      <head>
        <title>Buckaroo - The C++ Package Manager A Response to "Accio Dependency Manager"</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" type="text/css" href="/styles/normalize.min.css"/>
        <link rel="stylesheet" type="text/css" href="/styles.css"/>

        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
        <script type="text/javascript">
          window.rootUrl = ""
        </script>
        <!-- start Mixpanel --><script type="text/javascript">(function(c,a){if(!a.__SV){var b=window;try{var d,m,j,k=b.location,f=k.hash;d=function(a,b){return(m=a.match(RegExp(b+"=([^&]*)")))?m[1]:null};f&&d(f,"state")&&(j=JSON.parse(decodeURIComponent(d(f,"state"))),"mpeditor"===j.action&&(b.sessionStorage.setItem("_mpcehash",f),history.replaceState(j.desiredHash||"",c.title,k.pathname+k.search)))}catch(n){}var l,h;window.mixpanel=a;a._i=[];a.init=function(b,d,g){function c(b,i){var a=i.split(".");2==a.length&&(b=b[a[0]],i=a[1]);b[i]=function(){b.push([i].concat(Array.prototype.slice.call(arguments,
0)))}}var e=a;"undefined"!==typeof g?e=a[g]=[]:g="mixpanel";e.people=e.people||[];e.toString=function(b){var a="mixpanel";"mixpanel"!==g&&(a+="."+g);b||(a+=" (stub)");return a};e.people.toString=function(){return e.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)c(e,l[h]);var f="set set_once union unset remove delete".split(" ");e.get_group=function(){function a(c){b[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));e.push([d,call2])}}for(var b={},d=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<f.length;c++)a(f[c]);return b};a._i.push([b,d,g])};a.__SV=1.2;b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===c.location.protocol&&"//cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn4.mxpnl.com/libs/mixpanel-2-latest.min.js";d=c.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d)}})(document,window.mixpanel||[]);
mixpanel.init("8441e3f6b1aae54160bf747f4f1967d5");</script><!-- end Mixpanel -->
      </head>
      <body>
        <div id="react-root">
        <header id="header"><div class="content"><a id="logo" href="/">Buckaroo</a><nav><ul><li><a href="/blog">Blog</a></li><li><a href="https://github.com/LoopPerfect/buckaroo/wiki">Docs</a></li><li><a href="https://github.com/LoopPerfect/buckaroo">Code</a></li><li><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></li></ul></nav></div></header><div class="page mt-4 ph-1"><div class="content"><h1>A Response to &quot;Accio Dependency Manager&quot;</h1><p>üìù¬†<!-- -->Team Buckaroo<!-- -->, <!-- -->22/02/2019<!-- --> <br/>üí¨¬†<a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fbuckaroo.pm%2Fposts%2Fa-response-to-accio-dependency-manager&amp;t=A%20Response%20to%20%22Accio%20Dependency%20Manager%22">Discuss on Hacker News</a></p><hr/><div class="post-container"><div><p>There is a Medium post making the rounds at the moment about a dream C++ dependency manager. It&#x27;s well written, and definitely worth a read: <a href="https://medium.com/@corentin.jabot/accio-dependency-manager-b1846e1caf76">Accio Dependency Manager</a>.</p><p>As you might imagine, we have spent a <em>lot of time</em> thinking about these issues. Package management is much harder in C++ than in other languages, and the design of Buckaroo went through quite a few iterations! Here&#x27;s our take on the points discussed in &quot;Accio Dependency Manager&quot;.</p><h2 id="&quot;A-sane-naming-scheme&quot;">&quot;A sane naming scheme&quot;</h2><p>We agree! That&#x27;s why packages in Buckaroo are one of two kinds:</p><ul><li>A (normalized) URL to their project on GitHub, BitBucket or GitLab. For example: <span class="inline-code">github.com/LoopPerfect/neither</span></li><li>A simple organization and project pair, for ad-hoc dependencies. For example: <span class="inline-code">myorg/myproject</span></li></ul><h2 id="&quot;A-sane-versioning-scheme&quot;">&quot;A sane versioning scheme&quot;</h2><p>Most Buckaroo packages use <em>sem-ver</em>, as you suggest. However, we think it is also important to be able to depend on versions that are not yet ready to be given a sem-ver. For this reason, packages can also depend directly on Git branches and tags. It is always clear what a version refers to because you can view it in Git.</p><p>The version DSL is <a href="https://github.com/LoopPerfect/buckaroo/wiki/Version-Constraints-DSL">described in our docs</a>.</p><h2 id="&quot;A-Serious-dependency-Manager&quot;">&quot;A Serious dependency Manager&quot;</h2><p>This is a big difference between Buckaroo and other package managers. We don&#x27;t want to host your packages and we don&#x27;t have to. This is because <a href="https://github.com/LoopPerfect/buckaroo/wiki/Git-as-a-Package-Registry">Buckaroo packages live directly in source-control</a>, which is a piece of infrastructure your company already has.</p><p>Furthermore, after the packages have been resolved, we save the exact hashes of each. Future installations will use <em>precisely</em> the same versions you installed the first time.</p><h2 id="&quot;A-source-based-dependency-manager&quot;">&quot;A source-based dependency manager&quot;</h2><p>We agree in principle, and Buckaroo is <em>source-first</em>.</p><p>But there is one big exception: proprietary packages that are only available in binary form. For these we support packages that download the binaries during the build process. The hash is locked-down and always verified.</p><h2 id="&quot;But-compile-times-are-slow?&quot;">&quot;But compile times are slow?&quot;</h2><p>Not when you use a build-system with <a href="https://buckbuild.com/concept/what_makes_buck_so_fast.html">hermetically sealed build-steps and network caching</a>. This is the main reason that we use <a href="https://buckbuild.com/">Buck</a> for packages. CMake does not scale well here.</p><h2 id="&quot;What‚Äôs-a-dependency-anyway?&quot;">&quot;What‚Äôs a dependency anyway?&quot;</h2><p>A package might be a signed tar-ball, but that is only half the story. We need to give packages sensible names, and that implies a registry of some kind. Buckaroo <a href="https://github.com/LoopPerfect/buckaroo/wiki/Git-as-a-Package-Registry">uses existing Git providers</a> for these names.</p><p>OK, sure, GitHub is a single-point of failure. However, it is a single-point of failure that most developers <em>already have</em>. We think depending on GitHub (or BitBucket, or GitLab) is completely reasonable. For the paranoid, Buckaroo works equally well with a self-hosted Git instance.</p><h2 id="&quot;Building-dependencies&quot;">&quot;Building dependencies&quot;</h2><p>We need a build-system.</p><p>To see why, consider what we need to be able to do to build each package:</p><ul><li>Set the toolchain</li><li>Set any flags for compilation</li><li>Build a shared library (where applicable)</li><li>Build a static library (where applicable)</li><li>Find the headers provided by the library (generated and source-files)</li><li>Figure out which artifacts are required from its dependencies (so we can build those, and only those)</li><li>Link static and shared libraries from its dependencies (where does the package expect them to be?)</li><li>Extract the list of translation-units (generated and source-files) for IDE integration</li><li>Cache the build steps so that from-source builds are practical</li><li>Balance memory and CPU usage across the build so that the whole thing doesn&#x27;t fall over (hello <span class="inline-code">make -j12</span>)</li><li>Ensure unrelated packages don&#x27;t interfere with each-other&#x27;s build process (hermetically sealed builds)</li></ul><p>If you have implemented all of these things, then... you have implemented a build-system. You might call this just a &quot;wrapper&quot; script that defers work to another build-system, but this is analagous to how CMake relies on Make. It&#x27;s another layer of indirection.</p><p>Fixing C++ build-system fragmentation is a huge challenge. Luckily, the vast majority of builds are actually quite simple (Boost can be described entirely with globs, for example). We are going to open-source <a href="https://buildinfer.loopperfect.com/">automated build-system transpilation tools</a> in the very near future. Stay tuned!</p><p>And of course you can always call one build-system from other. It&#x27;s hacky, but in a pinch it can work.</p><h2 id="Summing-Up">Summing Up</h2><h3 id="&quot;Decentralized&quot;">&quot;Decentralized&quot;</h3><p>Check!</p><h3 id="&quot;Have-discovery-and-aggregation-features-that-are-or-feel-centralized,-so-that-end-users-don‚Äôt-have-to-handle-URL/URI.&quot;">&quot;Have discovery and aggregation features that are or feel centralized, so that end users don‚Äôt have to handle URL/URI.&quot;</h3><p>We have GitHub search, but Buckaroo could be improved in this aspect. More tools are coming!</p><h3 id="&quot;Impervious-to-the-loss-of-nodes,-robust-and-transparently-mirrored&quot;">&quot;Impervious to the loss of nodes, robust and transparently mirrored&quot;</h3><p>We rely on GitHub, BitBucket and GitLab here. This is a reasonable trade-off given that people already depend on them. Self-hosted Git is fully supported. Buckaroo works offline if your cache is populated.</p><h3 id="&quot;Based-on-strong-security-foundations&quot;">&quot;Based on strong security foundations&quot;</h3><p>We hash everything, and access-control leverages your existing Git key infrastructure. Using Git commits you have full audits of every build.</p><h3 id="&quot;Orthogonal-to-build-systems&quot;">&quot;Orthogonal to build systems&quot;</h3><p>A nice idea, but not really compatible with from-source packages. This approach will lead to a reimplementation of build-system features in meta-meta-build-systems. Build-system transpilation is a better approach in the long run (not to mention the other benefits).</p><h3 id="&quot;Only-handling-sources,-not-binaries&quot;">&quot;Only handling sources, not binaries&quot;</h3><p>We are source-first, but not handling binaries is impractical. We always check the hash of binaries.</p><h3 id="&quot;Easy-to-use-for-a-variety-of-use-cases.&quot;">&quot;Easy to use for a variety of use cases.&quot;</h3><p>We think so, but would love your feedback! ü§†</p></div></div><hr/><p>üí¨¬†<a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fbuckaroo.pm%2Fposts%2Fa-response-to-accio-dependency-manager&amp;t=A%20Response%20to%20%22Accio%20Dependency%20Manager%22">Discuss on Hacker News</a></p></div></div>
      </div>
      <script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-98721445-1', 'buckaroo.pm');
ga('send', 'pageview');
</script>
      <script type="text/javascript" src="/main.js"></script>

      </body>
    </html>