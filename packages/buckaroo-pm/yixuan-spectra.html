<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/yixuan-spectra/logo.png"/></div><div><h1>buckaroo-pm/yixuan-spectra</h1><div style="max-width:600px">A header-only C++ library for large scale eigenvalue problems</div><br/><div><b>455</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">eigenvalues</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">arpack</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">linear-algebra</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">spectra</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">header-only</span></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Buck</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Manifest</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">LockFile</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Dependencies</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><h1>&lt;a href=&quot;https://spectralib.org&quot;&gt;<!-- -->&lt;img src=&quot;https://spectralib.org/img/logo.png&quot; width=&quot;200px&quot; /&gt;<!-- -->&lt;/a&gt;</h1><p><a href="https://travis-ci.org/yixuan/spectra"><img src="https://travis-ci.org/yixuan/spectra.svg?branch=master" alt="Build Status"/></a></p><blockquote><p><strong>NOTE</strong>: Starting from v0.7 all header files are moved into a directory
named <code>Spectra</code>. Hence the recommended include directive would look like
<code>#include &lt;Spectra/SymEigsSolver.h&gt;</code>.</p></blockquote><p><a href="https://spectralib.org"><strong>Spectra</strong></a> stands for <strong>Sp</strong>arse <strong>E</strong>igenvalue <strong>C</strong>omputation <strong>T</strong>oolkit
as a <strong>R</strong>edesigned <strong>A</strong>RPACK. It is a C++ library for large scale eigenvalue
problems, built on top of <a href="http://eigen.tuxfamily.org">Eigen</a>,
an open source linear algebra library.</p><p><strong>Spectra</strong> is implemented as a header-only C++ library, whose only dependency,
<strong>Eigen</strong>, is also header-only. Hence <strong>Spectra</strong> can be easily embedded in
C++ projects that require calculating eigenvalues of large matrices.</p><h2>Relation to ARPACK</h2><p><a href="http://www.caam.rice.edu/software/ARPACK/">ARPACK</a> is a software written in
FORTRAN for solving large scale eigenvalue problems. The development of
<strong>Spectra</strong> is much inspired by ARPACK, and as the whole name indicates,
<strong>Spectra</strong> is a redesign of the ARPACK library using the C++ language.</p><p>In fact, <strong>Spectra</strong> is based on the algorithm described in the
<a href="http://www.caam.rice.edu/software/ARPACK/UG/ug.html">ARPACK Users&#x27; Guide</a>,
the implicitly restarted Arnoldi/Lanczos method. However,
it does not use the ARPACK code, and it is <strong>NOT</strong> a clone of ARPACK for C++.
In short, <strong>Spectra</strong> implements the major algorithms in ARPACK,
but <strong>Spectra</strong> provides a completely different interface, and it does not
depend on ARPACK.</p><h2>Common Usage</h2><p><strong>Spectra</strong> is designed to calculate a specified number (<code>k</code>) of eigenvalues
of a large square matrix (<code>A</code>). Usually <code>k</code> is much less than the size of matrix
(<code>n</code>), so that only a few eigenvalues and eigenvectors are computed, which
in general is more efficient than calculating the whole spectral decomposition.
Users can choose eigenvalue selection rules to pick up the eigenvalues of interest,
such as the largest <code>k</code> eigenvalues, or eigenvalues with largest real parts,
etc.</p><p>To use the eigen solvers in this library, the user does not need to directly
provide the whole matrix, but instead, the algorithm only requires certain operations
defined on <code>A</code>, and in the basic setting, it is simply the matrix-vector
multiplication. Therefore, if the matrix-vector product <code>A * x</code> can be computed
efficiently, which is the case when <code>A</code> is sparse, <strong>Spectra</strong>
will be very powerful for large scale eigenvalue problems.</p><p>There are two major steps to use the <strong>Spectra</strong> library:</p><ol><li>Define a class that implements a certain matrix operation, for example the</li></ol><p>matrix-vector multiplication <code>y = A * x</code> or the shift-solve operation
<code>y = inv(A - σ * I) * x</code>. <strong>Spectra</strong> has defined a number of
helper classes to quickly create such operations from a matrix object.
See the documentation of
<a href="https://spectralib.org/doc/classSpectra_1_1DenseGenMatProd.html">DenseGenMatProd</a>,
<a href="https://spectralib.org/doc/classSpectra_1_1DenseSymShiftSolve.html">DenseSymShiftSolve</a>, etc.
2. Create an object of one of the eigen solver classes, for example
<a href="https://spectralib.org/doc/classSpectra_1_1SymEigsSolver.html">SymEigsSolver</a>
for symmetric matrices, and
<a href="https://spectralib.org/doc/classSpectra_1_1GenEigsSolver.html">GenEigsSolver</a>
for general matrices. Member functions
of this object can then be called to conduct the computation and retrieve the
eigenvalues and/or eigenvectors.</p><p>Below is a list of the available eigen solvers in <strong>Spectra</strong>:</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1SymEigsSolver.html">SymEigsSolver</a>:</li></ul><p>For real symmetric matrices</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1GenEigsSolver.html">GenEigsSolver</a>:</li></ul><p>For general real matrices</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1SymEigsShiftSolver.html">SymEigsShiftSolver</a>:</li></ul><p>For real symmetric matrices using the shift-and-invert mode</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1GenEigsRealShiftSolver.html">GenEigsRealShiftSolver</a>:</li></ul><p>For general real matrices using the shift-and-invert mode,
with a real-valued shift</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1GenEigsComplexShiftSolver.html">GenEigsComplexShiftSolver</a>:</li></ul><p>For general real matrices using the shift-and-invert mode,
with a complex-valued shift</p><ul><li><a href="https://spectralib.org/doc/classSpectra_1_1SymGEigsSolver.html">SymGEigsSolver</a>:</li></ul><p>For generalized eigen solver for real symmetric matrices</p><h2>Examples</h2><p>Below is an example that demonstrates the use of the eigen solver for symmetric
matrices.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Eigen/Core&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Spectra/SymEigsSolver.h&gt;</span><span>
</span><span></span><span class="token" style="color:slategray">// &lt;Spectra/MatOp/DenseSymMatProd.h&gt; is implicitly included</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">using</span><span> </span><span class="token" style="color:#07a">namespace</span><span> Spectra</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// We are going to calculate the eigenvalues of M</span><span>
</span><span>    Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>MatrixXd A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">MatrixXd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Random</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>MatrixXd M </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">transpose</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Construct matrix operation object using the wrapper class DenseSymMatProd</span><span>
</span><span>    DenseSymMatProd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">op</span><span class="token" style="color:#999">(</span><span>M</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Construct eigen solver object, requesting the largest three eigenvalues</span><span>
</span><span>    SymEigsSolver</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> </span><span class="token" style="color:#07a">double</span><span class="token" style="color:#999">,</span><span> LARGEST_ALGE</span><span class="token" style="color:#999">,</span><span> DenseSymMatProd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">eigs</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>op</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Initialize and compute</span><span>
</span><span>    eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">init</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">int</span><span> nconv </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">compute</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Retrieve results</span><span>
</span><span>    Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>VectorXd evalues</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">info</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> SUCCESSFUL</span><span class="token" style="color:#999">)</span><span>
</span><span>        evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">eigenvalues</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Eigenvalues found:\n&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>Sparse matrix is supported via the <code>SparseGenMatProd</code> class.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Eigen/Core&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Eigen/SparseCore&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Spectra/GenEigsSolver.h&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Spectra/MatOp/SparseGenMatProd.h&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">using</span><span> </span><span class="token" style="color:#07a">namespace</span><span> Spectra</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// A band matrix with 1 on the main diagonal, 2 on the below-main subdiagonal,</span><span>
</span><span>    </span><span class="token" style="color:slategray">// and 3 on the above-main subdiagonal</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">int</span><span> n </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">;</span><span>
</span><span>    Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>SparseMatrix</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">M</span><span class="token" style="color:#999">(</span><span>n</span><span class="token" style="color:#999">,</span><span> n</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    M</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">reserve</span><span class="token" style="color:#999">(</span><span>Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">VectorXi</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Constant</span><span class="token" style="color:#999">(</span><span>n</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">for</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> n</span><span class="token" style="color:#999">;</span><span> i</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span class="token" style="color:#999">)</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        M</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">insert</span><span class="token" style="color:#999">(</span><span>i</span><span class="token" style="color:#999">,</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">1.0</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span>
</span><span>            M</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">insert</span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">3.0</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> n </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">)</span><span>
</span><span>            M</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">insert</span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">2.0</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Construct matrix operation object using the wrapper class SparseGenMatProd</span><span>
</span><span>    SparseGenMatProd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">op</span><span class="token" style="color:#999">(</span><span>M</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Construct eigen solver object, requesting the largest three eigenvalues</span><span>
</span><span>    GenEigsSolver</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> </span><span class="token" style="color:#07a">double</span><span class="token" style="color:#999">,</span><span> LARGEST_MAGN</span><span class="token" style="color:#999">,</span><span> SparseGenMatProd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">eigs</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>op</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Initialize and compute</span><span>
</span><span>    eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">init</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">int</span><span> nconv </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">compute</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Retrieve results</span><span>
</span><span>    Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>VectorXcd evalues</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">info</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> SUCCESSFUL</span><span class="token" style="color:#999">)</span><span>
</span><span>        evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">eigenvalues</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Eigenvalues found:\n&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>And here is an example for user-supplied matrix operation class.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Eigen/Core&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;Spectra/SymEigsSolver.h&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">using</span><span> </span><span class="token" style="color:#07a">namespace</span><span> Spectra</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// M = diag(1, 2, ..., 10)</span><span>
</span><span></span><span class="token" style="color:#07a">class</span><span> </span><span class="token" style="color:#DD4A68">MyDiagonalTen</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span></span><span class="token" style="color:#07a">public</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span>
</span><span>    </span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">rows</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">cols</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:slategray">// y_out = M * x_in</span><span>
</span><span>    </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">perform_op</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">double</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>x_in</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">double</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>y_out</span><span class="token" style="color:#999">)</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">for</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> </span><span class="token" style="color:#DD4A68">rows</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> i</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span class="token" style="color:#999">)</span><span>
</span><span>        </span><span class="token" style="color:#999">{</span><span>
</span><span>            y_out</span><span class="token" style="color:#999">[</span><span>i</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> x_in</span><span class="token" style="color:#999">[</span><span>i</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    MyDiagonalTen op</span><span class="token" style="color:#999">;</span><span>
</span><span>    SymEigsSolver</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">double</span><span class="token" style="color:#999">,</span><span> LARGEST_ALGE</span><span class="token" style="color:#999">,</span><span> MyDiagonalTen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#DD4A68">eigs</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>op</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">init</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">compute</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">info</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> SUCCESSFUL</span><span class="token" style="color:#999">)</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        Eigen</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>VectorXd evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> eigs</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">eigenvalues</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Eigenvalues found:\n&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> evalues </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><h2>Shift-and-invert Mode</h2><p>When we want to find eigenvalues that are closest to a number <code>σ</code>,
for example to find the smallest eigenvalues of a positive definite matrix
(in which case <code>σ = 0</code>), it is advised to use the shift-and-invert mode
of eigen solvers.</p><p>In the shift-and-invert mode, selection rules are applied to <code>1/(λ - σ)</code>
rather than <code>λ</code>, where <code>λ</code> are eigenvalues of <code>A</code>.
To use this mode, users need to define the shift-solve matrix operation. See
the documentation of
<a href="https://spectralib.org/doc/classSpectra_1_1SymEigsShiftSolver.html">SymEigsShiftSolver</a>
for details.</p><h2>Documentation</h2><p>The <a href="https://spectralib.org/doc/">API reference</a> page contains the documentation
of <strong>Spectra</strong> generated by <a href="http://www.doxygen.org/">Doxygen</a>,
including all the background knowledge, example code and class APIs.</p><p>More information can be found in the project page <a href="https://spectralib.org">https://spectralib.org</a>.</p><h2>License</h2><p><strong>Spectra</strong> is an open source project licensed under
<a href="https://www.mozilla.org/MPL/2.0/">MPL2</a>, the same license used by <strong>Eigen</strong>.</p></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/yixuan-spectra","name":"yixuan/spectra","licence":"MPL-2.0","description":"A header-only C++ library for large scale eigenvalue problems","readme":"# \u003ca href=\"https://spectralib.org\"\u003e\u003cimg src=\"https://spectralib.org/img/logo.png\" width=\"200px\" /\u003e\u003c/a\u003e\n\n[![Build Status](https://travis-ci.org/yixuan/spectra.svg?branch=master)](https://travis-ci.org/yixuan/spectra)\n\n\u003e **NOTE**: Starting from v0.7 all header files are moved into a directory\n\u003e named `Spectra`. Hence the recommended include directive would look like\n\u003e `#include \u003cSpectra/SymEigsSolver.h\u003e`.\n\n[**Spectra**](https://spectralib.org) stands for **Sp**arse **E**igenvalue **C**omputation **T**oolkit\nas a **R**edesigned **A**RPACK. It is a C++ library for large scale eigenvalue\nproblems, built on top of [Eigen](http://eigen.tuxfamily.org),\nan open source linear algebra library.\n\n**Spectra** is implemented as a header-only C++ library, whose only dependency,\n**Eigen**, is also header-only. Hence **Spectra** can be easily embedded in\nC++ projects that require calculating eigenvalues of large matrices.\n\n## Relation to ARPACK\n\n[ARPACK](http://www.caam.rice.edu/software/ARPACK/) is a software written in\nFORTRAN for solving large scale eigenvalue problems. The development of\n**Spectra** is much inspired by ARPACK, and as the whole name indicates,\n**Spectra** is a redesign of the ARPACK library using the C++ language.\n\nIn fact, **Spectra** is based on the algorithm described in the\n[ARPACK Users' Guide](http://www.caam.rice.edu/software/ARPACK/UG/ug.html),\nthe implicitly restarted Arnoldi/Lanczos method. However,\nit does not use the ARPACK code, and it is **NOT** a clone of ARPACK for C++.\nIn short, **Spectra** implements the major algorithms in ARPACK,\nbut **Spectra** provides a completely different interface, and it does not\ndepend on ARPACK.\n\n## Common Usage\n\n**Spectra** is designed to calculate a specified number (`k`) of eigenvalues\nof a large square matrix (`A`). Usually `k` is much less than the size of matrix\n(`n`), so that only a few eigenvalues and eigenvectors are computed, which\nin general is more efficient than calculating the whole spectral decomposition.\nUsers can choose eigenvalue selection rules to pick up the eigenvalues of interest,\nsuch as the largest `k` eigenvalues, or eigenvalues with largest real parts,\netc.\n\nTo use the eigen solvers in this library, the user does not need to directly\nprovide the whole matrix, but instead, the algorithm only requires certain operations\ndefined on `A`, and in the basic setting, it is simply the matrix-vector\nmultiplication. Therefore, if the matrix-vector product `A * x` can be computed\nefficiently, which is the case when `A` is sparse, **Spectra**\nwill be very powerful for large scale eigenvalue problems.\n\nThere are two major steps to use the **Spectra** library:\n\n1. Define a class that implements a certain matrix operation, for example the\nmatrix-vector multiplication `y = A * x` or the shift-solve operation\n`y = inv(A - σ * I) * x`. **Spectra** has defined a number of\nhelper classes to quickly create such operations from a matrix object.\nSee the documentation of\n[DenseGenMatProd](https://spectralib.org/doc/classSpectra_1_1DenseGenMatProd.html),\n[DenseSymShiftSolve](https://spectralib.org/doc/classSpectra_1_1DenseSymShiftSolve.html), etc.\n2. Create an object of one of the eigen solver classes, for example\n[SymEigsSolver](https://spectralib.org/doc/classSpectra_1_1SymEigsSolver.html)\nfor symmetric matrices, and\n[GenEigsSolver](https://spectralib.org/doc/classSpectra_1_1GenEigsSolver.html)\nfor general matrices. Member functions\nof this object can then be called to conduct the computation and retrieve the\neigenvalues and/or eigenvectors.\n\nBelow is a list of the available eigen solvers in **Spectra**:\n- [SymEigsSolver](https://spectralib.org/doc/classSpectra_1_1SymEigsSolver.html):\nFor real symmetric matrices\n- [GenEigsSolver](https://spectralib.org/doc/classSpectra_1_1GenEigsSolver.html):\nFor general real matrices\n- [SymEigsShiftSolver](https://spectralib.org/doc/classSpectra_1_1SymEigsShiftSolver.html):\nFor real symmetric matrices using the shift-and-invert mode\n- [GenEigsRealShiftSolver](https://spectralib.org/doc/classSpectra_1_1GenEigsRealShiftSolver.html):\nFor general real matrices using the shift-and-invert mode,\nwith a real-valued shift\n- [GenEigsComplexShiftSolver](https://spectralib.org/doc/classSpectra_1_1GenEigsComplexShiftSolver.html):\nFor general real matrices using the shift-and-invert mode,\nwith a complex-valued shift\n- [SymGEigsSolver](https://spectralib.org/doc/classSpectra_1_1SymGEigsSolver.html):\nFor generalized eigen solver for real symmetric matrices\n\n## Examples\n\nBelow is an example that demonstrates the use of the eigen solver for symmetric\nmatrices.\n\n```cpp\n#include \u003cEigen/Core\u003e\n#include \u003cSpectra/SymEigsSolver.h\u003e\n// \u003cSpectra/MatOp/DenseSymMatProd.h\u003e is implicitly included\n#include \u003ciostream\u003e\n\nusing namespace Spectra;\n\nint main()\n{\n    // We are going to calculate the eigenvalues of M\n    Eigen::MatrixXd A = Eigen::MatrixXd::Random(10, 10);\n    Eigen::MatrixXd M = A + A.transpose();\n\n    // Construct matrix operation object using the wrapper class DenseSymMatProd\n    DenseSymMatProd\u003cdouble\u003e op(M);\n\n    // Construct eigen solver object, requesting the largest three eigenvalues\n    SymEigsSolver\u003c double, LARGEST_ALGE, DenseSymMatProd\u003cdouble\u003e \u003e eigs(\u0026op, 3, 6);\n\n    // Initialize and compute\n    eigs.init();\n    int nconv = eigs.compute();\n\n    // Retrieve results\n    Eigen::VectorXd evalues;\n    if(eigs.info() == SUCCESSFUL)\n        evalues = eigs.eigenvalues();\n\n    std::cout \u003c\u003c \"Eigenvalues found:\\n\" \u003c\u003c evalues \u003c\u003c std::endl;\n\n    return 0;\n}\n```\n\nSparse matrix is supported via the `SparseGenMatProd` class.\n\n```cpp\n#include \u003cEigen/Core\u003e\n#include \u003cEigen/SparseCore\u003e\n#include \u003cSpectra/GenEigsSolver.h\u003e\n#include \u003cSpectra/MatOp/SparseGenMatProd.h\u003e\n#include \u003ciostream\u003e\n\nusing namespace Spectra;\n\nint main()\n{\n    // A band matrix with 1 on the main diagonal, 2 on the below-main subdiagonal,\n    // and 3 on the above-main subdiagonal\n    const int n = 10;\n    Eigen::SparseMatrix\u003cdouble\u003e M(n, n);\n    M.reserve(Eigen::VectorXi::Constant(n, 3));\n    for(int i = 0; i \u003c n; i++)\n    {\n        M.insert(i, i) = 1.0;\n        if(i \u003e 0)\n            M.insert(i - 1, i) = 3.0;\n        if(i \u003c n - 1)\n            M.insert(i + 1, i) = 2.0;\n    }\n\n    // Construct matrix operation object using the wrapper class SparseGenMatProd\n    SparseGenMatProd\u003cdouble\u003e op(M);\n\n    // Construct eigen solver object, requesting the largest three eigenvalues\n    GenEigsSolver\u003c double, LARGEST_MAGN, SparseGenMatProd\u003cdouble\u003e \u003e eigs(\u0026op, 3, 6);\n\n    // Initialize and compute\n    eigs.init();\n    int nconv = eigs.compute();\n\n    // Retrieve results\n    Eigen::VectorXcd evalues;\n    if(eigs.info() == SUCCESSFUL)\n        evalues = eigs.eigenvalues();\n\n    std::cout \u003c\u003c \"Eigenvalues found:\\n\" \u003c\u003c evalues \u003c\u003c std::endl;\n\n    return 0;\n}\n```\n\nAnd here is an example for user-supplied matrix operation class.\n\n```cpp\n#include \u003cEigen/Core\u003e\n#include \u003cSpectra/SymEigsSolver.h\u003e\n#include \u003ciostream\u003e\n\nusing namespace Spectra;\n\n// M = diag(1, 2, ..., 10)\nclass MyDiagonalTen\n{\npublic:\n    int rows() { return 10; }\n    int cols() { return 10; }\n    // y_out = M * x_in\n    void perform_op(double *x_in, double *y_out)\n    {\n        for(int i = 0; i \u003c rows(); i++)\n        {\n            y_out[i] = x_in[i] * (i + 1);\n        }\n    }\n};\n\nint main()\n{\n    MyDiagonalTen op;\n    SymEigsSolver\u003cdouble, LARGEST_ALGE, MyDiagonalTen\u003e eigs(\u0026op, 3, 6);\n    eigs.init();\n    eigs.compute();\n    if(eigs.info() == SUCCESSFUL)\n    {\n        Eigen::VectorXd evalues = eigs.eigenvalues();\n        std::cout \u003c\u003c \"Eigenvalues found:\\n\" \u003c\u003c evalues \u003c\u003c std::endl;\n    }\n\n    return 0;\n}\n```\n\n## Shift-and-invert Mode\n\nWhen we want to find eigenvalues that are closest to a number `σ`,\nfor example to find the smallest eigenvalues of a positive definite matrix\n(in which case `σ = 0`), it is advised to use the shift-and-invert mode\nof eigen solvers.\n\nIn the shift-and-invert mode, selection rules are applied to `1/(λ - σ)`\nrather than `λ`, where `λ` are eigenvalues of `A`.\nTo use this mode, users need to define the shift-solve matrix operation. See\nthe documentation of\n[SymEigsShiftSolver](https://spectralib.org/doc/classSpectra_1_1SymEigsShiftSolver.html)\nfor details.\n\n## Documentation\n\nThe [API reference](https://spectralib.org/doc/) page contains the documentation\nof **Spectra** generated by [Doxygen](http://www.doxygen.org/),\nincluding all the background knowledge, example code and class APIs.\n\nMore information can be found in the project page [https://spectralib.org](https://spectralib.org).\n\n## License\n\n**Spectra** is an open source project licensed under\n[MPL2](https://www.mozilla.org/MPL/2.0/), the same license used by **Eigen**.\n","versions":[{"ref":"master","manifest":"targets = [ \"//:spectra\" ]\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/eigen\"\nversion = \"*\"\n","lockFile":"manifest = \"23c3cd3db28af9d9992a3a5e11f6f33b43f122918eb21066ffb0ecc997ac42f7\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/eigen\"\ntarget = \"//:eigen\"\n\n[lock.\"github.com/buckaroo-pm/eigen\"]\nversions = [ \"branch=master\" ]\nrevision = \"edbb9e459fee8e1bb58e20493b7c03a98077c918\"\n","buck":"load('//:buckaroo_macros.bzl', 'buckaroo_deps')\nload('//:subdir_glob.bzl', 'subdir_glob')\n\nprebuilt_cxx_library(\n  name = 'spectra',\n  header_only = True,\n  header_namespace = '',\n  exported_headers = subdir_glob([\n    ('include', '**/*.h'),\n  ]),\n  licenses = [\n    'LICENSE',\n  ],\n  deps = buckaroo_deps(),\n  visibility = [\n    'PUBLIC',\n  ],\n)\n","bazel":"","deps":[{"uri":"github.com/buckaroo-pm/eigen","name":"buckaroo-pm/eigen","version":"*"}],"lock":[{"uri":"github.com/buckaroo-pm/eigen","name":"buckaroo-pm/eigen","spec":{"versions":["branch=master"],"revision":"edbb9e459fee8e1bb58e20493b7c03a98077c918"}}]}],"updated":"2019-01-18T17:28:12Z","updatedUpstream":"2021-01-13T15:13:23Z","contributors":[{"login":"yixuan","avatarUrl":"https://avatars2.githubusercontent.com/u/216398?v=4"},{"login":"v1kko","avatarUrl":"https://avatars2.githubusercontent.com/u/1472570?v=4"},{"login":"jkflying","avatarUrl":"https://avatars1.githubusercontent.com/u/1746276?u=d0752e6e6943201cecd320f849f17bad9f84daa2\u0026v=4"},{"login":"filiatra","avatarUrl":"https://avatars0.githubusercontent.com/u/3185717?u=5dd14628c5fe17ebbd175589fa943af19ac37b81\u0026v=4"},{"login":"pmoulon","avatarUrl":"https://avatars0.githubusercontent.com/u/3235050?u=24e61620e6ec7a0a2be7d92c1717e300495b79d7\u0026v=4"},{"login":"jschueller","avatarUrl":"https://avatars2.githubusercontent.com/u/3832365?v=4"},{"login":"felipeZ","avatarUrl":"https://avatars2.githubusercontent.com/u/4108663?u=496695b74024ff0b11060ce758f332e3be188aea\u0026v=4"},{"login":"jdbancal","avatarUrl":"https://avatars1.githubusercontent.com/u/5440791?v=4"},{"login":"ryanlevy","avatarUrl":"https://avatars0.githubusercontent.com/u/7354063?u=70030bd29342315c9963790a0f2062761c7c4c43\u0026v=4"},{"login":"guacke","avatarUrl":"https://avatars0.githubusercontent.com/u/10919923?u=302f589e436bc3fc2c1fdefa7795476523152f3a\u0026v=4"},{"login":"kriolog","avatarUrl":"https://avatars3.githubusercontent.com/u/11281193?u=d3706260df27321bd6900ae5697de5acacaa1b75\u0026v=4"},{"login":"JensWehner","avatarUrl":"https://avatars0.githubusercontent.com/u/12139113?u=e4ed2197d385e004a0c8b0d7a6bfd6e0278f2498\u0026v=4"},{"login":"AnnaAraslanova","avatarUrl":"https://avatars3.githubusercontent.com/u/19228754?u=3750a7c7650ac391e7cc148e96972cf806349179\u0026v=4"},{"login":"NicoRenaud","avatarUrl":"https://avatars2.githubusercontent.com/u/24918192?u=7e56e8132da7a41c2534875f8dfb14f416d77e5e\u0026v=4"}],"fundingLinks":[],"contactLinks":[],"stars":455,"forks":88,"topics":["eigenvalues","arpack","linear-algebra","spectra","header-only"]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"yixuan-spectra"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>