<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/mapbox-polylabel/logo.png"/></div><div><h1>buckaroo-pm/mapbox-polylabel</h1><div style="max-width:600px">A fast algorithm for finding the pole of inaccessibility of a polygon (in JavaScript and C++)</div><br/><div><b>873</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Buck</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Manifest</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">LockFile</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Dependencies</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><h2>polylabel <a href="https://travis-ci.org/mapbox/polylabel"><img src="https://travis-ci.org/mapbox/polylabel.svg?branch=master" alt="Build Status"/></a></h2><p>A fast algorithm for finding polygon <em>pole of inaccessibility</em>,
the most distant internal point from the polygon outline (not to be confused with centroid),
implemented as a JavaScript library.
Useful for optimal placement of a text label on a polygon.</p><p>It&#x27;s an iterative grid algorithm,
inspired by <a href="https://sites.google.com/site/polesofinaccessibility/">paper by Garcia-Castellanos &amp; Lombardo, 2007</a>.
Unlike the one in the paper, this algorithm:</p><ul><li>guarantees finding <strong>global optimum</strong> within the given precision</li><li>is many times faster (10-40x)</li></ul><p><img src="https://cloud.githubusercontent.com/assets/25395/16745865/864a0a30-47c0-11e6-87bc-58acac41a520.png" alt=""/></p><h3>How the algorithm works</h3><p>This is an iterative grid-based algorithm, which starts by covering the polygon with big square cells and then iteratively splitting them in the order of the most promising ones, while aggressively pruning uninteresting cells.</p><ol><li>Generate initial square cells that fully cover the polygon (with cell size equal to either width or height, whichever is lower). Calculate distance from the center of each cell to the outer polygon, using negative value if the point is outside the polygon (detected by ray-casting).</li><li>Put the cells into a priority queue sorted by the maximum potential distance from a point inside a cell, defined as a sum of the distance from the center and the cell radius (equal to <code>cell_size * sqrt(2) / 2</code>).</li><li>Calculate the distance from the centroid of the polygon and pick it as the first &quot;best so far&quot;.</li><li>Pull out cells from the priority queue one by one. If a cell&#x27;s distance is better than the current best, save it as such.</li></ol><p>Then, if the cell potentially contains a better solution that the current best (<code>cell_max - best_dist &gt; precision</code>),
split it into 4 children cells and put them in the queue.
5. Stop the algorithm when we have exhausted the queue and return the best cell&#x27;s center as the pole of inaccessibility.
It will be guaranteed to be a global optimum within the given precision.</p><p><img src="https://cloud.githubusercontent.com/assets/25395/16748630/e6b3336c-47cd-11e6-8059-0eeccf22cf6b.png" alt="image"/></p><h3>JavaScript Usage</h3><p>Given polygon coordinates in
<a href="http://geojson.org/geojson-spec.html#polygon">GeoJSON-like format</a>
and precision (<code>1.0</code> by default),
Polylabel returns the pole of inaccessibility coordinate in <code>[x, y]</code> format.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-js" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">var</span><span> p </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">polylabel</span><span class="token" style="color:#999">(</span><span>polygon</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">1.0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3>TypeScript</h3><p><a href="https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/concaveman">TypeScript type definitions</a>
are available via <code>npm install --save @types/polylabel</code>.</p><h3>C++ Usage</h3><p>It is recommended to install polylabel via <a href="https://github.com/mapbox/mason">mason</a>. You will also need to install its dependencies: <a href="https://github.com/mapbox/geometry.hpp">geometry.hpp</a> and <a href="https://github.com/mapbox/variant">variant</a>.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-C++" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>#include &lt;mapbox/polylabel.hpp&gt;
</span>
<!-- -->int main() {
<!-- -->    mapbox::geometry::polygon&lt;double&gt; polygon = readPolygon(); // Get polygon data from somewhere.
<!-- -->    mapbox::geometry::point&lt;double&gt; p = mapbox::polylabel(polygon, 1.0);
<!-- -->    return 0;
<!-- -->}
</code></pre><h4>Ports to other languages</h4><ul><li><a href="https://github.com/andrewharvey/geojson-polygon-labels">andrewharvey/geojson-polygon-labels</a> (CLI)</li><li><a href="https://github.com/Twista/python-polylabel">Twista/python-polylabel</a> (Python)</li><li><a href="https://github.com/Toblerity/Shapely/blob/master/shapely/algorithms/polylabel.py">Shapely</a> (Python)</li><li><a href="https://CRAN.R-project.org/package=polylabelr">polylabelr</a> (R)</li></ul></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/mapbox-polylabel","name":"mapbox/polylabel","licence":"NOASSERTION","description":"A fast algorithm for finding the pole of inaccessibility of a polygon (in JavaScript and C++)","readme":"## polylabel [![Build Status](https://travis-ci.org/mapbox/polylabel.svg?branch=master)](https://travis-ci.org/mapbox/polylabel)\n\nA fast algorithm for finding polygon _pole of inaccessibility_,\nthe most distant internal point from the polygon outline (not to be confused with centroid),\nimplemented as a JavaScript library.\nUseful for optimal placement of a text label on a polygon.\n\nIt's an iterative grid algorithm,\ninspired by [paper by Garcia-Castellanos \u0026 Lombardo, 2007](https://sites.google.com/site/polesofinaccessibility/).\nUnlike the one in the paper, this algorithm:\n\n- guarantees finding **global optimum** within the given precision\n- is many times faster (10-40x)\n\n![](https://cloud.githubusercontent.com/assets/25395/16745865/864a0a30-47c0-11e6-87bc-58acac41a520.png)\n\n### How the algorithm works\n\nThis is an iterative grid-based algorithm, which starts by covering the polygon with big square cells and then iteratively splitting them in the order of the most promising ones, while aggressively pruning uninteresting cells.\n\n1. Generate initial square cells that fully cover the polygon (with cell size equal to either width or height, whichever is lower). Calculate distance from the center of each cell to the outer polygon, using negative value if the point is outside the polygon (detected by ray-casting).\n2. Put the cells into a priority queue sorted by the maximum potential distance from a point inside a cell, defined as a sum of the distance from the center and the cell radius (equal to `cell_size * sqrt(2) / 2`).\n3. Calculate the distance from the centroid of the polygon and pick it as the first \"best so far\".\n4. Pull out cells from the priority queue one by one. If a cell's distance is better than the current best, save it as such.\nThen, if the cell potentially contains a better solution that the current best (`cell_max - best_dist \u003e precision`),\nsplit it into 4 children cells and put them in the queue.\n5. Stop the algorithm when we have exhausted the queue and return the best cell's center as the pole of inaccessibility.\nIt will be guaranteed to be a global optimum within the given precision.\n\n![image](https://cloud.githubusercontent.com/assets/25395/16748630/e6b3336c-47cd-11e6-8059-0eeccf22cf6b.png)\n\n### JavaScript Usage\n\nGiven polygon coordinates in\n[GeoJSON-like format](http://geojson.org/geojson-spec.html#polygon)\nand precision (`1.0` by default),\nPolylabel returns the pole of inaccessibility coordinate in `[x, y]` format.\n\n```js\nvar p = polylabel(polygon, 1.0);\n```\n\n### TypeScript\n\n[TypeScript type definitions](https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/concaveman)\nare available via `npm install --save @types/polylabel`.\n\n### C++ Usage\n\nIt is recommended to install polylabel via [mason](https://github.com/mapbox/mason). You will also need to install its dependencies: [geometry.hpp](https://github.com/mapbox/geometry.hpp) and [variant](https://github.com/mapbox/variant).\n\n```C++\n#include \u003cmapbox/polylabel.hpp\u003e\n\nint main() {\n    mapbox::geometry::polygon\u003cdouble\u003e polygon = readPolygon(); // Get polygon data from somewhere.\n    mapbox::geometry::point\u003cdouble\u003e p = mapbox::polylabel(polygon, 1.0);\n    return 0;\n}\n```\n\n#### Ports to other languages\n\n- [andrewharvey/geojson-polygon-labels](https://github.com/andrewharvey/geojson-polygon-labels) (CLI) \n- [Twista/python-polylabel](https://github.com/Twista/python-polylabel) (Python)\n- [Shapely](https://github.com/Toblerity/Shapely/blob/master/shapely/algorithms/polylabel.py) (Python)\n- [polylabelr](https://CRAN.R-project.org/package=polylabelr) (R)\n","versions":[{"ref":"master","manifest":"targets = [ \"//:polylabel\" ]\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/mapbox-geometry.hpp\"\nversion = \"branch=master\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/mapbox-rapidjson\"\nversion = \"*\"\n","lockFile":"manifest = \"90163c326abd8c438a0f996ec3ba9f9e1b82d5691a45f1ddcba89645df932215\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/mapbox-geometry.hpp\"\ntarget = \"//:geometry\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/mapbox-rapidjson\"\ntarget = \"//:rapidjson\"\n\n[[lock]]\nname = \"github.com/buckaroo-pm/Catch2\"\nversion = \"1.12.1\"\nrevision = \"3974bb1cc2d5a5b800b38b09907911213153b468\"\n\n[[lock]]\nname = \"github.com/buckaroo-pm/mapbox-geometry.hpp\"\nversion = \"branch=master\"\nrevision = \"dc886c9705ebec3b4c8ddf3b305537a450267944\"\n\n[[lock]]\nname = \"github.com/buckaroo-pm/mapbox-rapidjson\"\nversion = \"branch=master\"\nrevision = \"44ccecfb229c4862ef4fa924a4841749196abfc7\"\n\n[[lock]]\nname = \"github.com/buckaroo-pm/mapbox-variant\"\nversion = \"branch=master\"\nrevision = \"e735b7c1be9fe58e364685e6093628644776baf3\"\n","buck":"prebuilt_cxx_library(\n  name = 'polylabel', \n  header_namespace = 'mapbox', \n  header_only = True, \n  exported_headers = subdir_glob([\n    ('include/mapbox', '**/*.hpp'), \n  ]), \n  deps = [\n    'buckaroo.github.buckaroo-pm.mapbox-geometry.hpp//:geometry', \n  ], \n  visibility = [\n    'PUBLIC', \n  ], \n)\n","bazel":"","deps":[{"uri":"github.com/buckaroo-pm/mapbox-geometry.hpp","name":"buckaroo-pm/mapbox-geometry.hpp","version":"branch=master"},{"uri":"github.com/buckaroo-pm/mapbox-rapidjson","name":"buckaroo-pm/mapbox-rapidjson","version":"*"}],"lock":[{"uri":"0","name":"0","spec":{"name":"github.com/buckaroo-pm/Catch2","version":"1.12.1","revision":"3974bb1cc2d5a5b800b38b09907911213153b468"}},{"uri":"1","name":"1","spec":{"name":"github.com/buckaroo-pm/mapbox-geometry.hpp","version":"branch=master","revision":"dc886c9705ebec3b4c8ddf3b305537a450267944"}},{"uri":"2","name":"2","spec":{"name":"github.com/buckaroo-pm/mapbox-rapidjson","version":"branch=master","revision":"44ccecfb229c4862ef4fa924a4841749196abfc7"}},{"uri":"3","name":"3","spec":{"name":"github.com/buckaroo-pm/mapbox-variant","version":"branch=master","revision":"e735b7c1be9fe58e364685e6093628644776baf3"}}]}],"updated":"2018-11-23T17:16:19Z","updatedUpstream":"2021-01-12T04:33:59Z","contributors":[{"login":"zugaldia","avatarUrl":"https://avatars1.githubusercontent.com/u/6964?u=e17bd7e9c8e0d4ca1df6956596cffc4ef10176de\u0026v=4"},{"login":"bookest","avatarUrl":"https://avatars1.githubusercontent.com/u/14640?u=75e815f366d32a63b0d223fe47182a1570a96bb3\u0026v=4"},{"login":"springmeyer","avatarUrl":"https://avatars1.githubusercontent.com/u/20300?v=4"},{"login":"mikelmaron","avatarUrl":"https://avatars1.githubusercontent.com/u/22896?u=f22126445e688b260ca316709407189f669c2083\u0026v=4"},{"login":"mourner","avatarUrl":"https://avatars2.githubusercontent.com/u/25395?u=6f04fa0e30ee06ee7ef8d13dd6c166d0ca70aeea\u0026v=4"},{"login":"sbma44","avatarUrl":"https://avatars2.githubusercontent.com/u/31717?v=4"},{"login":"tmcw","avatarUrl":"https://avatars1.githubusercontent.com/u/32314?u=f6cb43dcfd33ae3df8cd1c6679922b08a24ef509\u0026v=4"},{"login":"sgillies","avatarUrl":"https://avatars3.githubusercontent.com/u/33697?u=518c359114c548926c56fef4b51a123e9a4a5d47\u0026v=4"},{"login":"kkaefer","avatarUrl":"https://avatars1.githubusercontent.com/u/52399?u=7b3a53dfef51246b5c1342108a664842b4ea3571\u0026v=4"},{"login":"alfwatt","avatarUrl":"https://avatars1.githubusercontent.com/u/53469?u=ff9e35352887e919bfd74b6ad0bee578af80e165\u0026v=4"},{"login":"anderco","avatarUrl":"https://avatars1.githubusercontent.com/u/55106?v=4"},{"login":"yuletide","avatarUrl":"https://avatars3.githubusercontent.com/u/58695?u=6322adc3fcbff377e32f0e6299d7aaddd841dc6e\u0026v=4"},{"login":"artemp","avatarUrl":"https://avatars1.githubusercontent.com/u/59056?u=84b41abea2ca9e9c6e5a6af9277ee06e8376c68f\u0026v=4"},{"login":"tristen","avatarUrl":"https://avatars1.githubusercontent.com/u/61150?u=40b52d083ac2c6f414ef35c79271c776787e7bd0\u0026v=4"},{"login":"ivovandongen","avatarUrl":"https://avatars1.githubusercontent.com/u/64527?u=e284cc763f7ca8765196fc0f6279e7538742cdfd\u0026v=4"},{"login":"curran","avatarUrl":"https://avatars3.githubusercontent.com/u/68416?u=31d283c06af36e3cc7f6da3aac1e302064d68f81\u0026v=4"},{"login":"brunoabinader","avatarUrl":"https://avatars2.githubusercontent.com/u/76133?v=4"},{"login":"apendleton","avatarUrl":"https://avatars3.githubusercontent.com/u/78930?u=911348d600e91c721685538a958ee4252a854589\u0026v=4"},{"login":"yhahn","avatarUrl":"https://avatars1.githubusercontent.com/u/83384?u=b2c1ca34e763ba420f510b5a1d62201c1d9624eb\u0026v=4"},{"login":"PureW","avatarUrl":"https://avatars0.githubusercontent.com/u/85910?v=4"},{"login":"jwkvam","avatarUrl":"https://avatars0.githubusercontent.com/u/86304?u=0aa583ff6636a9aa5882d59eace17f1ac2d9e0f9\u0026v=4"},{"login":"AlekseiCherkes","avatarUrl":"https://avatars3.githubusercontent.com/u/87640?u=f75d2bf7fd442db59db853feab57a208761fddef\u0026v=4"},{"login":"ianshward","avatarUrl":"https://avatars2.githubusercontent.com/u/91258?u=5e631aa4328b540f955d9c2e9e2588fcc1bd0d0d\u0026v=4"},{"login":"gundersen","avatarUrl":"https://avatars0.githubusercontent.com/u/93353?v=4"},{"login":"willwhite","avatarUrl":"https://avatars1.githubusercontent.com/u/93564?u=3e17a4a45e3ce686ca811d9ed79257db04ff345f\u0026v=4"}],"fundingLinks":[],"contactLinks":[],"stars":873,"forks":111,"topics":[]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"mapbox-polylabel"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>