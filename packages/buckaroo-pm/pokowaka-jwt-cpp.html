<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/pokowaka-jwt-cpp/logo.png"/></div><div><h1>buckaroo-pm/pokowaka-jwt-cpp</h1><div style="max-width:600px">A C++ library for handling JWT tokens</div><br/><div><b>86</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Buck</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Manifest</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">LockFile</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Dependencies</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><h1>Jwt-cpp</h1><p><img src="https://travis-ci.org/pokowaka/jwt-cpp.svg?branch=master" alt="Build status"/>
<a href="https://raw.githubusercontent.com/pokowaka/jwt-cpp/master/LICENSE.MIT"><img src="https://img.shields.io/badge/license-MIT-blue.svg" alt="GitHub license"/></a>
<a href="http://github.com/pokowaka/jwt-cpp/issues"><img src="https://img.shields.io/github/issues/pokowaka/jwt-cpp.svg" alt="Github Issues"/></a></p><p>A C++11 implementation of the <a href="http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html">JSON Web
Token</a>
standard.</p><p>jwt-cpp is licensed under the <a href="http://opensource.org/licenses/mit-license.php">MIT license</a>;
see LICENSE in the source distribution for details.</p><p>Currently it supports the following:</p><p>Sign, Verify JWS:</p><ul><li>HS256, HS384, HS512</li><li>RS256, RS384, RS512</li><li><em>none</em></li></ul><p>Payload validators:</p><ul><li>iss check</li><li>sub check</li><li>aud check</li><li>exp check</li><li>nbf check</li><li>iat check</li></ul><p><strong>NOTE</strong>: We keep private and public keys unencrypted in memory for the duration of the
existence of any of the validators.</p><h2>Compilation and Installation</h2><p>Jwt-cpp uses the <a href="http://www.cmake.org/">CMake</a> cross platform build tools to
build. Once you have installed the proper dependencies you can do the following:</p><p>For release:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mkdir release
</span>cd release
<!-- -->cmake -DCMAKE_BUILD_TYPE=Release ..
<!-- -->make install
</code></pre><p>For debug:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mkdir debug
</span>cd debug
<!-- -->cmake -DCMAKE_BUILD_TYPE=Debug ..
<!-- -->make
</code></pre><p>Running the tests with code coverage:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>mkdir debug
</span>cd debug
<!-- -->cmake -DCMAKE_BUILD_TYPE=Debug ..
<!-- -->make cov_all_tests
</code></pre><h3>Dependencies in linux</h3><p>You will need to install the following dependencies:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>sudo apt-get install libssl-dev cmake lcov</span></code></pre><h3>How to build in Mac OS</h3><p>First make sure you have the proper dependencies. The easiest way is to use
<a href="http://brew.sh/">Homebrew</a>.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>brew install cmake lcov openssl@1.1</span></code></pre><h3>How to build in Windows</h3><p>Beside cmake and Visual Studio, you need to install OpenSSL binaries:
<a href="https://slproweb.com/products/Win32OpenSSL.html">Win32 OpenSSL</a></p><p>After installation, configure cmake for your Visual Studio and set openssl folders:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>MD build
</span>CD build
<!-- -->cmake -G &quot;Visual Studio 14&quot; -DCMAKE_INSTALL_PREFIX=..\install -DOPENSSL_INCLUDE_DIRS=C:\OpenSSL-Win32\include -DOPENSSL_LIBRARY_DIRS=C:\OpenSSL-Win32\lib ..
<!-- -->cmake --build . --clean-first --target install
</code></pre><p>Find your binaries at <code>install</code> folder.</p><p>To run tests on Windows, add openssl bins to your path:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>set &quot;PATH=C:\OpenSSL-Win32\bin;%PATH%&quot;
</span>ctest
</code></pre><h2>Usage</h2><p>You can find detailed <a href="test/token/sample.cpp">samples</a> that are executed as part
of the tests.  We make use of <a href="https://github.com/nlohmann/json">JSON for Modern C++</a> library
to create json payload.</p><h3>Signing tokens</h3><p>For example we can create a signed token with HS256 as follows:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&quot;jwt/jwt_all.h&quot;</span><span>
</span><span></span><span class="token" style="color:#07a">using</span><span> json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> nlohmann</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Setup a signer</span><span>
</span><span>    HS256Validator </span><span class="token" style="color:#DD4A68">signer</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;secret!&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Create the json payload that expires 01/01/2017 @ 12:00am (UTC)</span><span>
</span><span>    json payload </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">{</span><span class="token" style="color:#690">&quot;sub&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;subject&quot;</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#690">&quot;exp&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">1483228800</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Let&#x27;s encode the token to a string</span><span>
</span><span>    </span><span class="token" style="color:#07a">auto</span><span> token </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">JWT</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Encode</span><span class="token" style="color:#999">(</span><span>signer</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> token </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>On my mac with homebrew installed at ~/homebrew (it is usually in /usr/local) it can be compiled as follows:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>g++ -std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>c++11 </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/opt/openssl@1.1/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/opt/openssl@1.1/lib </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/lib -lcrypto -ljwt </span><span class="token" style="color:#999">\</span><span>
</span>sign.cpp -o sign
</code></pre><p>Executing this should result in something like:</p><p>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzdWJqZWN0IiwiZXhwIjoxNDgzMjI4ODAwfQ.4Vjr_Htx4oBy9cHFNbpLsVC_YgIA4_hrUIV1unApUUs</p><h3>Validating tokens</h3><p>Validation is straightforward:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&quot;jwt/jwt_all.h&quot;</span><span>
</span><span></span><span class="token" style="color:#07a">using</span><span> json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> nlohmann</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    ExpValidator exp</span><span class="token" style="color:#999">;</span><span>
</span><span>    HS256Validator </span><span class="token" style="color:#DD4A68">signer</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;secret!&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Now let&#x27;s use these validators to parse and verify the token we created</span><span>
</span><span>    </span><span class="token" style="color:slategray">// in the previous example</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>string str_token </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">try</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:slategray">// Decode and validate the token</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">;</span><span>
</span>
<span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">tie</span><span class="token" style="color:#999">(</span><span>header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">JWT</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Decode</span><span class="token" style="color:#999">(</span><span>str_token</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>signer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>exp</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Header: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> header </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Payload: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> payload </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">catch</span><span> </span><span class="token" style="color:#999">(</span><span>InvalidTokenError </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>tfe</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:slategray">// An invalid token</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Validation failed: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> tfe</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">what</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>Again we compile it:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>g++ -std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>c++11  </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/opt/openssl@1.1/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/opt/openssl@1.1/lib </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/lib -lcrypto -ljwt -lssl </span><span class="token" style="color:#999">\</span><span>
</span>validate.cpp -o validate
</code></pre><h4>An example using factories</h4><p>Usually your validators will be a little more complex than just validating one
property. The easiest way to use more complex verifiers and validators is by
using <code>ClaimValidatorFactory::Build</code> or <code>MessageValidatorFactory::Build</code>.
Both methods accept a json string or a json object, and produce a claim validator or message
validator.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&quot;jwt/jwt_all.h&quot;</span><span>
</span><span></span><span class="token" style="color:#07a">using</span><span> json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> nlohmann</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Let&#x27;s setup a claim validator where we will accept tokens that</span><span>
</span><span>    </span><span class="token" style="color:slategray">// are have been issues by either foo or bar</span><span>
</span><span>    </span><span class="token" style="color:slategray">// and have an optional expiration claim with a leeway of 32s.</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>string json_claim </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;{ \&quot;all\&quot; : &quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;  [ &quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;    { \&quot;optional\&quot; : { \&quot;exp\&quot; : { \&quot;leeway\&quot; : 32} } },&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;    { \&quot;iss\&quot; : [\&quot;foo\&quot;, \&quot;bar\&quot;] }&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;  ]&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;}&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Lets build the claim validator</span><span>
</span><span>    claim_ptr </span><span class="token" style="color:#DD4A68">claim_validator</span><span class="token" style="color:#999">(</span><span class="token" style="color:#DD4A68">ClaimValidatorFactory</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Build</span><span class="token" style="color:#999">(</span><span>json_claim</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Next we are going to setup the message validators. We will accept</span><span>
</span><span>    </span><span class="token" style="color:slategray">// the HS256 &amp; HS512 validators with the given secrets.</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>string json_validators </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;{ \&quot;set\&quot; : [ &quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;  { \&quot;HS256\&quot; : { \&quot;secret\&quot; : \&quot;secret!\&quot; } }, &quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;  { \&quot;HS512\&quot; : { \&quot;secret\&quot; : \&quot;supersafe\&quot; } }&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot; ]&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;}&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>    validator_ptr </span><span class="token" style="color:#DD4A68">message_validator</span><span class="token" style="color:#999">(</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">MessageValidatorFactory</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Build</span><span class="token" style="color:#999">(</span><span>json_validators</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Now let&#x27;s use these validators to parse and verify the token we created</span><span>
</span><span>    </span><span class="token" style="color:slategray">// with a previous sample.</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>string str_token </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">try</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">tie</span><span class="token" style="color:#999">(</span><span>header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">JWT</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Decode</span><span class="token" style="color:#999">(</span><span>
</span><span>            str_token</span><span class="token" style="color:#999">,</span><span> message_validator</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> claim_validator</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Header: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> header </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Payload: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> payload </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">catch</span><span> </span><span class="token" style="color:#999">(</span><span>InvalidTokenError </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>tfe</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> tfe</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">what</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>Again compile and run it:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>g++ -std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>c++11  </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/opt/openssl@1.1/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/opt/openssl@1.1/lib </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/lib -lcrypto -ljwt -lssl </span><span class="token" style="color:#999">\</span><span>
</span>factories.cpp -o factories
</code></pre><h4>Dealing with failures</h4><p>There will come a time when tokens are not valid. When tokens fail to validate exceptions will be thrown:</p><ul><li><strong>InvalidTokenError</strong>: base class for token errors</li><li><strong>TokenFormatError</strong>: the token is wrongly encoded. No information can be retrieved.</li><li><strong>InvalidSignatureError</strong>: failed to verify the signature. You can still retrieve the token by disabling verification.</li><li><strong>InvalidClaimError</strong>: failed to verify the claims. You can still retrieve the token by disabling validation</li><li><strong>std::logic_error</strong>: you should never see this. If you do a bug needs to be fixed.</li></ul><p>The sample below shows how you can deal with errors:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&quot;jwt/jwt_all.h&quot;</span><span>
</span><span></span><span class="token" style="color:#07a">using</span><span> json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> nlohmann</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>json</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    ExpValidator exp</span><span class="token" style="color:#999">;</span><span>
</span><span>    HS256Validator </span><span class="token" style="color:#DD4A68">signer</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;secret&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Now we use these validators to parse and verify the token we created</span><span>
</span><span>    </span><span class="token" style="color:slategray">// in the previous example</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>string token </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.&quot;</span><span>
</span><span>        </span><span class="token" style="color:#690">&quot;u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">try</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        json header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">tie</span><span class="token" style="color:#999">(</span><span>header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">JWT</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Decode</span><span class="token" style="color:#999">(</span><span>token</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>signer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>exp</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;You should not see this line&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">catch</span><span> </span><span class="token" style="color:#999">(</span><span>TokenFormatError </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>tfe</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:slategray">// No data can be recovered..</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">catch</span><span> </span><span class="token" style="color:#999">(</span><span>InvalidTokenError </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>tfe</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        json header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">tie</span><span class="token" style="color:#999">(</span><span>header</span><span class="token" style="color:#999">,</span><span> payload</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">JWT</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">Decode</span><span class="token" style="color:#999">(</span><span>token</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Payload: &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> payload </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>Again compile and run it:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>g++ -std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>c++11  </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-I ~/homebrew/opt/openssl@1.1/include </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/opt/openssl@1.1/lib </span><span class="token" style="color:#999">\</span><span>
</span><span>-L ~/homebrew/lib -lcrypto -ljwt -lssl </span><span class="token" style="color:#999">\</span><span>
</span>failed.cpp -o failed
</code></pre><p>Should result in something like this:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Payload: {&quot;exp&quot;:1483228800,&quot;iss&quot;:&quot;foo&quot;}</span></code></pre><h2>The JSON Factories</h2><p>The json factories make it easier to construct signers and validators. The BNF schemas below show you how you can construct signers. Note that signers can also be used as validators as well.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>signer ::=
</span>  &quot;none&quot;  : null |
<!-- -->  &quot;HS256&quot; : { &quot;secret&quot; : &quot;*your actual secret*} |
<!-- -->  &quot;HS384&quot; : { &quot;secret&quot; : &quot;*your actual secret*} |
<!-- -->  &quot;HS512&quot; : { &quot;secret&quot; : &quot;*your actual secret*&quot; } |
<!-- -->  &quot;RS256&quot; : { &quot;public&quot;  : (&quot;PEM block with key&quot; | { &quot;fromfile&quot; : &quot;/path/to/file/with/pem&quot; }),
<!-- -->              &quot;private&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
<!-- -->  &quot;RS384&quot; : { &quot;public&quot;  : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }),
<!-- -->              &quot;private&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
<!-- -->  &quot;RS512&quot; : { &quot;public&quot;  : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }),
<!-- -->              &quot;private&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
</code></pre><p>The BNF used to construct validators looks as follows:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>validator ::=
</span>  &quot;none&quot;  : null |
<!-- -->  &quot;HS256&quot; : { &quot;secret&quot; : &quot;....&quot; } |
<!-- -->  &quot;HS384&quot; : { &quot;secret&quot; : &quot;....&quot; } |
<!-- -->  &quot;HS512&quot; : { &quot;secret&quot; : &quot;....&quot; } |
<!-- -->  &quot;RS256&quot; : { &quot;public&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
<!-- -->  &quot;RS384&quot; : { &quot;public&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
<!-- -->  &quot;RS512&quot; : { &quot;public&quot; : (&quot;PEM...&quot; | { &quot;fromfile&quot; : &quot;....&quot; }) } |
<!-- -->  &quot;set&quot;   : [ validator+ ] |
<!-- -->  &quot;kid&quot;   : ( { id : validator } )+
</code></pre><ul><li><p>A <strong>set</strong> validator will accept the token if any of the validators in the set accepts the token.</p></li><li><p>A <strong>kid</strong> validator will accept the token if the kid field of the token is
validated by the given validator. For example if the validator is declared as follows:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-json" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#905">&quot;kid&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;id1&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;HS256&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;secret&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;f13rc3&quot;</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>            </span><span class="token" style="color:#905">&quot;id2&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;HS256&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;secret&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;d0ntt3llmama&quot;</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>            </span><span class="token" style="color:#905">&quot;id3&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;HS256&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">&quot;secret&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;longlama&quot;</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span>          </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
</code></pre><p>and a token is being validated with the following JOSE header:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-json" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#905">&quot;kid&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;id2&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#905">&quot;alg&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;HS256&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#905">&quot;typ&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;JWT&quot;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>it will try to validate the token using the validator with &quot;id2&quot;. In the example above it is the HMAC256 validator with the secret &quot;d0ntt3llmama&quot;.</p><p>See the <a href="test/token/sample.cpp">sample</a> for more details on how this works.</p></li></ul><p>You can build a MessageValidator by invoking the factory:
<code>MessageValidator* MessageValidatorFactory::Build(std::string toBuild)</code>
<code>MessageSigner* MessageValidatorFactory::BuildSigner(std::string toBuild)</code></p><p><em>Note: Never include the none validator alongside other validators! See this
<a href="https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/">blog post</a>
for details.</em></p><p>Claimvalidators:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>claims ::=
</span>  single_claim |
<!-- -->  &quot;optional&quot; : { (single_claim) } |
<!-- -->  &quot;any&quot; : [ (claim)+ ] |
<!-- -->  &quot;all&quot; : [ (claim)+ ]
<!-- --> single_claim ::=
<!-- -->  &quot;exp&quot; : (null | { &quot;leeway&quot; : .... }) |
<!-- -->  &quot;nbf&quot; : (null | { &quot;leeway&quot; : .... }) |
<!-- -->  &quot;iat&quot; : (null | { &quot;leeway&quot; : .... }) |
<!-- -->  &quot;iss&quot; : [ &quot;...&quot;+ ] |
<!-- -->  &quot;sub&quot; : [ &quot;...&quot;+ ] |
<!-- -->  &quot;aud&quot; : [ &quot;...&quot;+ ] |
</code></pre><p>For example:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>{
</span>   &quot;all&quot;:[
<!-- -->      {
<!-- -->         &quot;optional&quot;:{ &quot;exp&quot;:{ &quot;leeway&quot;:32 } }
<!-- -->      },
<!-- -->      {
<!-- -->         &quot;iss&quot;:[ &quot;foo&quot;, &quot;bar&quot; ]
<!-- -->      }
<!-- -->   ]
<!-- -->}
</code></pre><p>Indicates that the claims set has the following:</p><ul><li>If an expiration is set, its expiration should be no later than the current time + 32 seconds</li><li>It has been issued by either <em>foo</em>, or <em>bar</em></li></ul></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/pokowaka-jwt-cpp","name":"pokowaka/jwt-cpp","licence":"MIT","description":"A C++ library for handling JWT tokens","readme":"Jwt-cpp\n=======\n\n![Build status](https://travis-ci.org/pokowaka/jwt-cpp.svg?branch=master)\n[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://raw.githubusercontent.com/pokowaka/jwt-cpp/master/LICENSE.MIT)\n[![Github Issues](https://img.shields.io/github/issues/pokowaka/jwt-cpp.svg)](http://github.com/pokowaka/jwt-cpp/issues)\n\n\nA C++11 implementation of the [JSON Web\nToken](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html)\nstandard.\n\njwt-cpp is licensed under the [MIT license](http://opensource.org/licenses/mit-license.php);\nsee LICENSE in the source distribution for details.\n\nCurrently it supports the following:\n\nSign, Verify JWS:\n\n- HS256, HS384, HS512\n- RS256, RS384, RS512\n- *none*\n\nPayload validators:\n\n- iss check\n- sub check\n- aud check\n- exp check\n- nbf check\n- iat check\n\n**NOTE**: We keep private and public keys unencrypted in memory for the duration of the\nexistence of any of the validators.\n\n## Compilation and Installation\n\nJwt-cpp uses the [CMake](http://www.cmake.org/) cross platform build tools to\nbuild. Once you have installed the proper dependencies you can do the following:\n\nFor release:\n\n```\nmkdir release\ncd release\ncmake -DCMAKE_BUILD_TYPE=Release ..\nmake install\n```\n\nFor debug:\n```\nmkdir debug\ncd debug\ncmake -DCMAKE_BUILD_TYPE=Debug ..\nmake\n```\n\nRunning the tests with code coverage:\n```\nmkdir debug\ncd debug\ncmake -DCMAKE_BUILD_TYPE=Debug ..\nmake cov_all_tests\n```\n\n\n### Dependencies in linux\n\nYou will need to install the following dependencies:\n```\nsudo apt-get install libssl-dev cmake lcov\n```\n\n\n### How to build in Mac OS\n\nFirst make sure you have the proper dependencies. The easiest way is to use\n[Homebrew](http://brew.sh/).\n\n```\nbrew install cmake lcov openssl@1.1\n```\n\n### How to build in Windows\nBeside cmake and Visual Studio, you need to install OpenSSL binaries:\n[Win32 OpenSSL](https://slproweb.com/products/Win32OpenSSL.html)\n\nAfter installation, configure cmake for your Visual Studio and set openssl folders:\n```\nMD build\nCD build\ncmake -G \"Visual Studio 14\" -DCMAKE_INSTALL_PREFIX=..\\install -DOPENSSL_INCLUDE_DIRS=C:\\OpenSSL-Win32\\include -DOPENSSL_LIBRARY_DIRS=C:\\OpenSSL-Win32\\lib ..\ncmake --build . --clean-first --target install\n```\nFind your binaries at `install` folder.\n\nTo run tests on Windows, add openssl bins to your path:\n```\nset \"PATH=C:\\OpenSSL-Win32\\bin;%PATH%\"\nctest\n```\n\n## Usage\n\nYou can find detailed [samples](test/token/sample.cpp) that are executed as part\nof the tests.  We make use of [JSON for Modern C++](https://github.com/nlohmann/json) library\nto create json payload.\n\n### Signing tokens\n\nFor example we can create a signed token with HS256 as follows:\n\n```cpp\n#include \u003ciostream\u003e\n#include \"jwt/jwt_all.h\"\nusing json = nlohmann::json;\n\nint main() {\n    // Setup a signer\n    HS256Validator signer(\"secret!\");\n\n    // Create the json payload that expires 01/01/2017 @ 12:00am (UTC)\n    json payload = {{\"sub\", \"subject\"}, {\"exp\", 1483228800}};\n\n    // Let's encode the token to a string\n    auto token = JWT::Encode(signer, payload);\n\n    std::cout \u003c\u003c token \u003c\u003c std::endl;\n}\n```\n\nOn my mac with homebrew installed at ~/homebrew (it is usually in /usr/local) it can be compiled as follows:\n\n```bash\ng++ -std=c++11 \\\n-I ~/homebrew/include \\\n-I ~/homebrew/opt/openssl@1.1/include \\\n-L ~/homebrew/opt/openssl@1.1/lib \\\n-L ~/homebrew/lib -lcrypto -ljwt \\\nsign.cpp -o sign\n```\n\nExecuting this should result in something like:\n\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzdWJqZWN0IiwiZXhwIjoxNDgzMjI4ODAwfQ.4Vjr_Htx4oBy9cHFNbpLsVC_YgIA4_hrUIV1unApUUs\n\n### Validating tokens\nValidation is straightforward:\n\n```cpp\n#include \u003ciostream\u003e\n#include \"jwt/jwt_all.h\"\nusing json = nlohmann::json;\n\nint main() {\n    ExpValidator exp;\n    HS256Validator signer(\"secret!\");\n\n    // Now let's use these validators to parse and verify the token we created\n    // in the previous example\n    std::string str_token =\n        \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.\"\n        \"eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.\"\n        \"u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo\";\n    try {\n        // Decode and validate the token\n        ::json header, payload;\n\n        std::tie(header, payload) = JWT::Decode(str_token, \u0026signer, \u0026exp);\n        std::cout \u003c\u003c \"Header: \" \u003c\u003c header \u003c\u003c std::endl;\n        std::cout \u003c\u003c \"Payload: \" \u003c\u003c payload \u003c\u003c std::endl;\n    } catch (InvalidTokenError \u0026tfe) {\n        // An invalid token\n        std::cout \u003c\u003c \"Validation failed: \" \u003c\u003c tfe.what() \u003c\u003c std::endl;\n    }\n}\n```\n\nAgain we compile it:\n\n```bash\ng++ -std=c++11  \\\n-I ~/homebrew/include \\\n-I ~/homebrew/opt/openssl@1.1/include \\\n-L ~/homebrew/opt/openssl@1.1/lib \\\n-L ~/homebrew/lib -lcrypto -ljwt -lssl \\\nvalidate.cpp -o validate\n```\n\n#### An example using factories\nUsually your validators will be a little more complex than just validating one\nproperty. The easiest way to use more complex verifiers and validators is by\nusing ``ClaimValidatorFactory::Build`` or ``MessageValidatorFactory::Build``.\nBoth methods accept a json string or a json object, and produce a claim validator or message\nvalidator.\n\n```cpp\n#include \u003ciostream\u003e\n#include \"jwt/jwt_all.h\"\nusing json = nlohmann::json;\n\nint main() {\n    // Let's setup a claim validator where we will accept tokens that\n    // are have been issues by either foo or bar\n    // and have an optional expiration claim with a leeway of 32s.\n    std::string json_claim =\n        \"{ \\\"all\\\" : \"\n        \"  [ \"\n        \"    { \\\"optional\\\" : { \\\"exp\\\" : { \\\"leeway\\\" : 32} } },\"\n        \"    { \\\"iss\\\" : [\\\"foo\\\", \\\"bar\\\"] }\"\n        \"  ]\"\n        \"}\";\n\n    // Lets build the claim validator\n    claim_ptr claim_validator(ClaimValidatorFactory::Build(json_claim));\n\n    // Next we are going to setup the message validators. We will accept\n    // the HS256 \u0026 HS512 validators with the given secrets.\n    std::string json_validators =\n        \"{ \\\"set\\\" : [ \"\n        \"  { \\\"HS256\\\" : { \\\"secret\\\" : \\\"secret!\\\" } }, \"\n        \"  { \\\"HS512\\\" : { \\\"secret\\\" : \\\"supersafe\\\" } }\"\n        \" ]\"\n        \"}\";\n    validator_ptr message_validator(\n        MessageValidatorFactory::Build(json_validators));\n\n    // Now let's use these validators to parse and verify the token we created\n    // with a previous sample.\n    std::string str_token =\n        \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.\"\n        \"eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.\"\n        \"u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo\";\n    try {\n        ::json header, payload;\n        std::tie(header, payload) = JWT::Decode(\n            str_token, message_validator.get(), claim_validator.get());\n        std::cout \u003c\u003c \"Header: \" \u003c\u003c header \u003c\u003c std::endl;\n        std::cout \u003c\u003c \"Payload: \" \u003c\u003c payload \u003c\u003c std::endl;\n    } catch (InvalidTokenError \u0026tfe) {\n        std::cout \u003c\u003c tfe.what() \u003c\u003c std::endl;\n    }\n}\n```\n\nAgain compile and run it:\n\n```bash\ng++ -std=c++11  \\\n-I ~/homebrew/include \\\n-I ~/homebrew/opt/openssl@1.1/include \\\n-L ~/homebrew/opt/openssl@1.1/lib \\\n-L ~/homebrew/lib -lcrypto -ljwt -lssl \\\nfactories.cpp -o factories\n```\n#### Dealing with failures\nThere will come a time when tokens are not valid. When tokens fail to validate exceptions will be thrown:\n\n- **InvalidTokenError**: base class for token errors\n- **TokenFormatError**: the token is wrongly encoded. No information can be retrieved.\n- **InvalidSignatureError**: failed to verify the signature. You can still retrieve the token by disabling verification.\n- **InvalidClaimError**: failed to verify the claims. You can still retrieve the token by disabling validation\n- **std::logic_error**: you should never see this. If you do a bug needs to be fixed.\n\nThe sample below shows how you can deal with errors:\n\n```cpp\n#include \u003ciostream\u003e\n#include \"jwt/jwt_all.h\"\nusing json = nlohmann::json;\n\nint main() {\n    ExpValidator exp;\n    HS256Validator signer(\"secret\");\n\n    // Now we use these validators to parse and verify the token we created\n    // in the previous example\n    std::string token =\n        \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.\"\n        \"eyJpc3MiOiJmb28iLCJleHAiOjE0ODMyMjg4MDB9.\"\n        \"u3JTUx1tJDo601olQv0rHk4kGkKadIj3cvy-DDZKVRo\";\n    try {\n        json header, payload;\n        std::tie(header, payload) = JWT::Decode(token, \u0026signer, \u0026exp);\n        std::cout \u003c\u003c \"You should not see this line\" \u003c\u003c std::endl;\n    } catch (TokenFormatError \u0026tfe) {\n        // No data can be recovered..\n    } catch (InvalidTokenError \u0026tfe) {\n        json header, payload;\n        std::tie(header, payload) = JWT::Decode(token);\n        std::cout \u003c\u003c \"Payload: \" \u003c\u003c payload \u003c\u003c std::endl;\n    }\n}\n```\n\nAgain compile and run it:\n\n```bash\ng++ -std=c++11  \\\n-I ~/homebrew/include \\\n-I ~/homebrew/opt/openssl@1.1/include \\\n-L ~/homebrew/opt/openssl@1.1/lib \\\n-L ~/homebrew/lib -lcrypto -ljwt -lssl \\\nfailed.cpp -o failed\n```\n\nShould result in something like this:\n\n```\nPayload: {\"exp\":1483228800,\"iss\":\"foo\"}\n```\n\n## The JSON Factories\nThe json factories make it easier to construct signers and validators. The BNF schemas below show you how you can construct signers. Note that signers can also be used as validators as well.\n\n```\nsigner ::=\n  \"none\"  : null |\n  \"HS256\" : { \"secret\" : \"*your actual secret*} |\n  \"HS384\" : { \"secret\" : \"*your actual secret*} |\n  \"HS512\" : { \"secret\" : \"*your actual secret*\" } |\n  \"RS256\" : { \"public\"  : (\"PEM block with key\" | { \"fromfile\" : \"/path/to/file/with/pem\" }),\n              \"private\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n  \"RS384\" : { \"public\"  : (\"PEM...\" | { \"fromfile\" : \"....\" }),\n              \"private\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n  \"RS512\" : { \"public\"  : (\"PEM...\" | { \"fromfile\" : \"....\" }),\n              \"private\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n```\n\nThe BNF used to construct validators looks as follows:\n\n```\nvalidator ::=\n  \"none\"  : null |\n  \"HS256\" : { \"secret\" : \"....\" } |\n  \"HS384\" : { \"secret\" : \"....\" } |\n  \"HS512\" : { \"secret\" : \"....\" } |\n  \"RS256\" : { \"public\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n  \"RS384\" : { \"public\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n  \"RS512\" : { \"public\" : (\"PEM...\" | { \"fromfile\" : \"....\" }) } |\n  \"set\"   : [ validator+ ] |\n  \"kid\"   : ( { id : validator } )+\n```\n\n- A **set** validator will accept the token if any of the validators in the set accepts the token.\n- A **kid** validator will accept the token if the kid field of the token is\n  validated by the given validator. For example if the validator is declared as follows:\n\n  ```json\n  {\n    \"kid\" : { \"id1\" : { \"HS256\" : { \"secret\" : \"f13rc3\" } },\n              \"id2\" : { \"HS256\" : { \"secret\" : \"d0ntt3llmama\" } },\n              \"id3\" : { \"HS256\" : { \"secret\" : \"longlama\" } }\n            }\n  }\n\n  ```\n\n  and a token is being validated with the following JOSE header:\n\n  ```json\n  {\n    \"kid\" : \"id2\",\n    \"alg\" : \"HS256\",\n    \"typ\" : \"JWT\"\n  }\n  ```\n\n  it will try to validate the token using the validator with \"id2\". In the example above it is the HMAC256 validator with the secret \"d0ntt3llmama\".\n\n  See the [sample](test/token/sample.cpp) for more details on how this works.\n\nYou can build a MessageValidator by invoking the factory:\n``MessageValidator* MessageValidatorFactory::Build(std::string toBuild)``\n``MessageSigner* MessageValidatorFactory::BuildSigner(std::string toBuild)``\n\n*Note: Never include the none validator alongside other validators! See this\n[blog post](https://auth0.com/blog/2015/03/31/critical-vulnerabilities-in-json-web-token-libraries/)\nfor details.*\n\nClaimvalidators:\n\n```\nclaims ::=\n  single_claim |\n  \"optional\" : { (single_claim) } |\n  \"any\" : [ (claim)+ ] |\n  \"all\" : [ (claim)+ ]\n single_claim ::=\n  \"exp\" : (null | { \"leeway\" : .... }) |\n  \"nbf\" : (null | { \"leeway\" : .... }) |\n  \"iat\" : (null | { \"leeway\" : .... }) |\n  \"iss\" : [ \"...\"+ ] |\n  \"sub\" : [ \"...\"+ ] |\n  \"aud\" : [ \"...\"+ ] |\n```\n\nFor example:\n\n```\n{\r\n   \"all\":[\r\n      {\r\n         \"optional\":{ \"exp\":{ \"leeway\":32 } }\r\n      },\r\n      {\r\n         \"iss\":[ \"foo\", \"bar\" ]\r\n      }\r\n   ]\r\n}\n```\n\nIndicates that the claims set has the following:\n\n- If an expiration is set, its expiration should be no later than the current time + 32 seconds\n- It has been issued by either *foo*, or *bar*\n","versions":[{"ref":"master","manifest":"targets = [ \"//:jwt-cpp\" ]\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/host-dl\"\nversion = \"*\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/openssl\"\nversion = \"*\"\n","lockFile":"manifest = \"b2ad311c397c6652e25ba09a7a20ffe20948b197f51e30832d662bc1d0727bf4\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/host-dl\"\ntarget = \"//:dl\"\n\n[[dependency]]\npackage = \"github.com/buckaroo-pm/openssl\"\ntarget = \"//:openssl\"\n\n[lock.\"github.com/buckaroo-pm/host-dl\"]\nversions = [ \"branch=master\" ]\nrevision = \"69a239353756c2ef5c97e5a56a0964fb7ac6eb49\"\n\n[lock.\"github.com/buckaroo-pm/openssl\"]\nversions = [ \"tag=1.0.2j\" ]\nrevision = \"e61671249ee5dfa59b663d135b64dd6fe9efe9d0\"\n","buck":"load('//:subdir_glob.bzl', 'subdir_glob')\nload('//:buckaroo_macros.bzl', 'buckaroo_deps_from_package')\n\nlinux_deps = \\\n  buckaroo_deps_from_package('github.com/buckaroo-pm/openssl') + \\\n  buckaroo_deps_from_package('github.com/buckaroo-pm/host-dl')\n\nmacos_deps = \\\n  buckaroo_deps_from_package('github.com/buckaroo-pm/openssl')\n\ncxx_library(\n  name = 'jwt-cpp',\n  header_namespace = '',\n  exported_headers = subdir_glob([\n    ('src/include', 'jwt/**/*.hpp'),\n    ('src/include', 'jwt/**/*.h'),\n  ]),\n  headers = subdir_glob([\n    ('src/include', 'private/**/*.h'),\n  ]),\n  srcs = glob([\n    'src/**/*.cpp',\n  ]),\n  platform_deps = [\n    ('linux.*', linux_deps),\n    ('macos.*', macos_deps),\n  ],\n  visibility = [\n    'PUBLIC',\n  ],\n)\n","bazel":"","deps":[{"uri":"github.com/buckaroo-pm/host-dl","name":"buckaroo-pm/host-dl","version":"*"},{"uri":"github.com/buckaroo-pm/openssl","name":"buckaroo-pm/openssl","version":"*"}],"lock":[{"uri":"github.com/buckaroo-pm/host-dl","name":"buckaroo-pm/host-dl","spec":{"versions":["branch=master"],"revision":"69a239353756c2ef5c97e5a56a0964fb7ac6eb49"}},{"uri":"github.com/buckaroo-pm/openssl","name":"buckaroo-pm/openssl","spec":{"versions":["tag=1.0.2j"],"revision":"e61671249ee5dfa59b663d135b64dd6fe9efe9d0"}}]}],"updated":"2019-02-01T16:05:01Z","updatedUpstream":"2021-01-05T15:30:29Z","contributors":[{"login":"martindederer","avatarUrl":"https://avatars3.githubusercontent.com/u/156674?v=4"},{"login":"faragon","avatarUrl":"https://avatars0.githubusercontent.com/u/518864?u=2ab5b83540e82d6b7923575c59d2753884894929\u0026v=4"},{"login":"GSIO01","avatarUrl":"https://avatars2.githubusercontent.com/u/1201965?v=4"},{"login":"pokowaka","avatarUrl":"https://avatars0.githubusercontent.com/u/4935150?u=7510fd2628d6d5ff45abd27b8a69ea39ea42a937\u0026v=4"},{"login":"winfriedd","avatarUrl":"https://avatars3.githubusercontent.com/u/6376326?v=4"},{"login":"dyremeen","avatarUrl":"https://avatars1.githubusercontent.com/u/7857593?v=4"},{"login":"sdamm","avatarUrl":"https://avatars2.githubusercontent.com/u/11834140?v=4"},{"login":"jiri-novotny","avatarUrl":"https://avatars2.githubusercontent.com/u/13260918?v=4"},{"login":"wdobbe","avatarUrl":"https://avatars2.githubusercontent.com/u/19475596?v=4"},{"login":"DanFTRX","avatarUrl":"https://avatars1.githubusercontent.com/u/22240134?v=4"},{"login":"fvarose","avatarUrl":"https://avatars2.githubusercontent.com/u/22502546?v=4"},{"login":"mdr1384","avatarUrl":"https://avatars0.githubusercontent.com/u/32360633?v=4"}],"fundingLinks":[],"contactLinks":[],"stars":86,"forks":43,"topics":[]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"pokowaka-jwt-cpp"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>