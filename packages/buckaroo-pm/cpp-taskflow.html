<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/cpp-taskflow/logo.png"/></div><div><h1>buckaroo-pm/cpp-taskflow</h1><div style="max-width:600px">Modern C++ Parallel Task Programming Library</div><br/><div><b>4778</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">parallel-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">threadpool</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">concurrent-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">high-performance-computing</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">multicore-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">multi-threading</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">taskparallelism</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">multithreading</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">parallel-computing</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">work-stealing</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">gpu-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">heterogeneous-parallel-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">cuda-programming</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">cuda</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">gpgpu</span></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><h1>Cpp-Taskflow <!-- -->&lt;img align=&quot;right&quot; width=&quot;10%&quot; src=&quot;image/cpp-taskflow_logo.png&quot;&gt;</h1><p><a href="https://travis-ci.com/cpp-taskflow/cpp-taskflow"><img src="https://travis-ci.com/cpp-taskflow/cpp-taskflow.svg?branch=master" alt="Linux Build Status"/></a>
<a href="https://ci.appveyor.com/project/TsungWeiHuang/cpp-taskflow"><img src="https://ci.appveyor.com/api/projects/status/te9bjp4yfhq7f8hq?svg=true" alt="Windows Build status"/></a>
<a href="https://en.wikipedia.org/wiki/C%2B%2B#Standardization"><img src="image/cpp17.svg" alt="Standard"/></a>
<a href="https://github.com/cpp-taskflow/cpp-taskflow/archive/master.zip"><img src="image/download.svg" alt="Download"/></a>
<a href="https://cpp-taskflow.github.io/cpp-taskflow/index.html"><img src="image/doc-wiki.svg" alt="Wiki"/></a>
<a href="https://github.com/cpp-taskflow/cpp-taskflow/pulse"><img src="image/maintained.svg" alt="Insights"/></a>
<a href="./LICENSE"><img src="./image/license_badge.svg" alt="License: MIT"/></a></p><p>A fast C++ header-only library to help you quickly write parallel programs with complex task dependencies</p><h1>Why Cpp-Taskflow?</h1><p>Cpp-Taskflow is by far faster, more expressive, fewer lines of code, and easier for drop-in integration
than existing parallel task programming libraries such as <a href="http://www.nersc.gov/users/software/programming-models/openmp/openmp-tasking/">OpenMP Tasking</a> and Intel <a href="https://www.threadingbuildingblocks.org/tutorial-intel-tbb-flow-graph">TBB FlowGraph</a>.</p><p><img src="image/performance.jpg" alt=""/></p><p>Cpp-Taskflow enables you to implement efficient task decomposition strategies
that incorporate both regular loop-based parallelism
and irregular compute patterns to optimize multicore performance.</p><table><thead><tr><th>Without Cpp-Taskflow</th><th>With Cpp-Taskflow</th></tr></thead><tbody><tr><td><img src="image/profile_without_taskflow.gif" alt=""/></td><td><img src="image/profile_with_taskflow.gif" alt=""/></td></tr></tbody></table><p>Cpp-Taskflow has a unified interface for both <em>static</em> tasking and <em>dynamic</em> tasking,
allowing users to quickly master our parallel task programming model in a natural idiom.</p><table><thead><tr><th style="text-align:center">Static Tasking</th><th style="text-align:center">Dynamic Tasking</th></tr></thead><tbody><tr><td style="text-align:center"><img src="image/static_graph.png" alt=""/></td><td style="text-align:center"><img src="image/dynamic_graph.png" alt=""/></td></tr></tbody></table><p>Cpp-Taskflow is committed to support both academic and industry research projects,
making it reliable and cost-effective for long-term and large-scale developments.</p><ul><li><em>&quot;Cpp-Taskflow is the cleanest Task API I&#x27;ve ever seen.&quot; <a href="https://github.com/damienhocking">damienhocking</a></em></li><li><em>&quot;Cpp-Taskflow has a very simple and elegant tasking interface. The performance also scales very well.&quot; <a href="https://github.com/totalgee">totalgee</a></em></li><li><em>&quot;Best poster award for open-source parallel programming library.&quot; <a href="https://github.com/CppCon/CppCon2018">Cpp Conference 2018</a></em></li></ul><p>See a quick <a href="https://cpp-taskflow.github.io/">presentation</a> and
visit the <a href="https://cpp-taskflow.github.io/cpp-taskflow/index.html">documentation</a> to learn more about Cpp-Taskflow.</p><h1>Get Started with Cpp-Taskflow</h1><p>The following example <a href="./example/simple.cpp">simple.cpp</a> shows the basic Cpp-Taskflow API
you need in most applications.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;taskflow/taskflow.hpp&gt;</span><span class="token macro" style="color:#905">  </span><span class="token macro" style="color:slategray">// Cpp-Taskflow is header-only</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span>  
<span>  tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>Taskflow tf</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A</span><span class="token" style="color:#999">,</span><span> B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> D</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;TaskA\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>               </span><span class="token" style="color:slategray">//  task dependency graph</span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;TaskB\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>               </span><span class="token" style="color:slategray">// </span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;TaskC\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>               </span><span class="token" style="color:slategray">//          +---+          </span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;TaskD\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>                </span><span class="token" style="color:slategray">//    +----&gt;| B |-----+   </span><span>
</span><span>  </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>                                                 </span><span class="token" style="color:slategray">//    |     +---+     |</span><span>
</span><span>                                                     </span><span class="token" style="color:slategray">//  +---+           +-v-+ </span><span>
</span><span>  A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// A runs before B                  //  | A |           | D | </span><span>
</span><span>  A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>C</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// A runs before C                  //  +---+           +-^-+ </span><span>
</span><span>  B</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// B runs before D                  //    |     +---+     |    </span><span>
</span><span>  C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// C runs before D                  //    +----&gt;| C |-----+    </span><span>
</span><span>                                                     </span><span class="token" style="color:slategray">//          +---+          </span><span>
</span><span>  tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_all</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// block until finish</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><p>Compile and run the code with the following commands:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>~$ g++ simple.cpp -std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>c++1z -O2 -lpthread -o simple
</span>~$ ./simple
<!-- -->TaskA
<span>TaskC  </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>-- concurrent with TaskB
</span><span>TaskB  </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>-- concurrent with TaskC
</span>TaskD
</code></pre><p>It is clear now Cpp-Taskflow is powerful in parallelizing tasks with complex dependencies.
The following example demonstrates a concurrent execution of 10 tasks with 15 dependencies.
With Cpp-Taskflow, you only need <em><strong>15 lines of code</strong></em>.</p>&lt;img align=&quot;right&quot; src=&quot;image/complex.png&quot; width=&quot;30%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// source dependencies</span><span>
</span><span>S</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// S runs before a0</span><span>
</span><span>S</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// S runs before b0</span><span>
</span><span>S</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// S runs before a1</span><span>
</span>
<span></span><span class="token" style="color:slategray">// a_ -&gt; others</span><span>
</span><span>a0</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// a0 runs before a1</span><span>
</span><span>a0</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// a0 runs before b2</span><span>
</span><span>a1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// a1 runs before a2</span><span>
</span><span>a1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// a1 runs before b3</span><span>
</span><span>a2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// a2 runs before a3</span><span>
</span>
<span></span><span class="token" style="color:slategray">// b_ -&gt; others</span><span>
</span><span>b0</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// b0 runs before b1</span><span>
</span><span>b1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// b1 runs before b2</span><span>
</span><span>b2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>b3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// b2 runs before b3</span><span>
</span><span>b2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>a3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// b2 runs before a3</span><span>
</span>
<span></span><span class="token" style="color:slategray">// target dependencies</span><span>
</span><span>a3</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>T</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// a3 runs before T</span><span>
</span><span>b1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>T</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// b1 runs before T</span><span>
</span><span>b3</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>T</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>    </span><span class="token" style="color:slategray">// b3 runs before T</span></code></pre><h1>Create a Taskflow Graph</h1><p>Cpp-Taskflow has very expressive and neat methods to create dependency graphs.
Most applications are developed through the following three steps.</p><h2>Step 1: Create a Task</h2><p>A task is a callable object for which <a href="https://en.cppreference.com/w/cpp/utility/functional/invoke">std::invoke</a> is applicable.
Create a taskflow object to start a task dependency graph.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>Taskflow tf</span><span class="token" style="color:#999">;</span></code></pre><p>Create a task from a callable object via the method <code>silent_emplace</code>
to get a task handle.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task A\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>You can create multiple tasks at one time.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A</span><span class="token" style="color:#999">,</span><span> B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> D</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task A\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task B\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task C\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task D\n&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h2>Step 2: Define Task Dependencies</h2><p>Once tasks are created in the pool, you need to specify task dependencies in a
<a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">Directed Acyclic Graph (DAG)</a> fashion.
The handle <code>Task</code> supports different methods for you to describe task dependencies.</p><p><strong>Precede</strong>: Adding a preceding link forces one task to run ahead of one another.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// A runs before B.</span></code></pre><p><strong>Gather</strong>: Adding a gathering link forces one task to run after other(s).</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">gather</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// A runs after B</span></code></pre><h2>Step 3: Execute the Tasks</h2><p>There are three methods to execute a task dependency graph,
<code>dispatch</code>, <code>silent_dispatch</code>, and <code>wait_for_all</code>.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> future </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// non-blocking, returns with a future immediately.</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>         </span><span class="token" style="color:slategray">// non-blocking, no return</span></code></pre><p>Calling <code>wait_for_all</code> will block until all tasks complete.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_all</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>Each of these methods dispatches the current graph to threads for execution
and create a data structure called <em>topology</em> to store the execution status.</p><h1>Dynamic Tasking</h1><p>Another powerful feature of Taskflow is <em>dynamic</em> tasking.
A dynamic task is created during the execution of a dispatched taskflow graph, i.e.,
topology.
These tasks are spawned by a parent task and are grouped together to a <em>subflow</em> graph.
The example below demonstrates how to create a subflow
that spawns three tasks during its execution.</p>&lt;img align=&quot;right&quot; src=&quot;image/subflow_join.png&quot; width=&quot;40%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// create three regular tasks</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> C </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;C&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> D </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;D&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a subflow graph (dynamic tasking)</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> B1 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B1&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> B2 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B2&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> B3 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B3&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  B1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  B2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>            
<span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// B runs after A </span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>C</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// C runs after A </span><span>
</span><span>B</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// D runs after B </span><span>
</span><span>C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// D runs after C </span><span>
</span>
<span></span><span class="token" style="color:slategray">// execute the graph without cleanning up topologies</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dump_topologies</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>By default, a subflow graph joins to its parent node.
This guarantees a subflow graph to finish before the successors of
its parent node.
You can disable this feature by calling <code>subflow.detach()</code>.
Detaching the above subflow will result in the following execution flow.</p>&lt;img align=&quot;right&quot; src=&quot;image/subflow_detach.png&quot; width=&quot;65%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// detach a subflow graph</span><span>
</span><span></span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span class="token" style="color:#999">.</span><span>
</span><span>  B1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  B2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B3</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:slategray">// detach from B </span><span>
</span><span>  subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">detach</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;TaskB&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h2>Step 1: Create a Subflow</h2><p>Cpp-Taskflow has an unified interface for static and dynamic tasking.
To create a subflow for dynamic tasking,
emplace a callable on one argument of type <code>tf::SubflowBuilder</code>.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>SubflowBuilder</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>Similarly, you can get a <a href="https://en.cppreference.com/w/cpp/thread/future">std::future</a> object to the execution status of the subflow.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A</span><span class="token" style="color:#999">,</span><span> fu</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>SubflowBuilder</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>A subflow builder is a lightweight object that allows you to create
arbitrary dependency graphs on the fly.
All graph building methods defined in taskflow
can be used in a subflow builder.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>SubflowBuilder</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;Task A is spawning two subtasks A1 and A2&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A1</span><span class="token" style="color:#999">,</span><span> A2</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;subtask A1&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;subtask A2&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span>    A1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>A2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>A subflow can also be nested or recursive. You can create another subflow from
the execution of a subflow and so on.</p>&lt;img align=&quot;right&quot; src=&quot;image/nested_subflow.png&quot; width=&quot;45%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> sbf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>  std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;A spawns A1 &amp; subflow A2\n&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> A1 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sbf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;subtask A1\n&quot;</span><span class="token" style="color:#999">;</span><span> 
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A1&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">auto</span><span> A2 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sbf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> sbf2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;A2 spawns A2_1 &amp; A2_2\n&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">auto</span><span> A2_1 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sbf2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>      std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;subtask A2_1\n&quot;</span><span class="token" style="color:#999">;</span><span> 
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A2_1&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">auto</span><span> A2_2 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sbf2</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>      std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;subtask A2_2\n&quot;</span><span class="token" style="color:#999">;</span><span> 
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A2_2&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    A2_1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>A2_2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A2&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  A1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>A2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h2>Step 2: Detach or Join a Subflow</h2><p>A subflow has no methods to dispatch its tasks.
Instead, a subflow will be executed after leaving the context of the callable.
By default, a subflow joins to its parent task.
Depending on applications, you can detach a subflow to enable more parallelism.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>SubflowBuilder</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">detach</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// detach this subflow from its parent task A</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// subflow starts to run after the callable scope</span></code></pre><p>Detaching or Joining a subflow has different meaning in the ready status of
the future object referred to it.
In a joined subflow,
the completion of its parent node is defined as when all tasks
inside the subflow (possibly nested) finish.</p>&lt;img align=&quot;right&quot; src=&quot;image/joined_subflow_future.png&quot; width=&quot;40%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">int</span><span> value </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a joined subflow</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A</span><span class="token" style="color:#999">,</span><span> fuA</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>    value </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">;</span><span> 
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// some arbitrary value</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a task B after A</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>  </span><span class="token" style="color:#DD4A68">assert</span><span class="token" style="color:#999">(</span><span>value </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> 
</span><span>  </span><span class="token" style="color:#DD4A68">assert</span><span class="token" style="color:#999">(</span><span>fuA</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span>s</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>future_status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>ready</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// A1 must finish before A and therefore before B</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>When a subflow is detached from its parent task, it becomes a parallel
execution line to the current flow graph and will eventually
join to the same topology.</p>&lt;img align=&quot;right&quot; src=&quot;image/detached_subflow_future.png&quot; width=&quot;40%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">int</span><span> value </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a detached subflow</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>A</span><span class="token" style="color:#999">,</span><span> fuA</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> value </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">detach</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// some arbitrary value</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a task B after A</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>  </span><span class="token" style="color:slategray">// no guarantee for value to be 10 nor fuA ready</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>Debug a Taskflow Graph</h1><p>Concurrent programs are notoriously difficult to debug.
Cpp-Taskflow leverages the graph properties to relieve the debugging pain.
To debug a taskflow graph,
(1) name tasks and dump the graph, and
(2) start with one thread before going multiple.
Currently, Cpp-Taskflow supports <a href="https://www.graphviz.org/">GraphViz</a> format.</p><h2>Dump the Present Taskflow Graph</h2><p>Each time you create a task or add a dependency,
it adds a node or an edge to the present taskflow graph.
The graph is not dispatched yet and you can dump it to a GraphViz format.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// debug.cpp</span><span>
</span><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>Taskflow </span><span class="token" style="color:#DD4A68">tf</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// use only the master thread</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> C </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;C&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> D </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;D&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> E </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;E&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> E</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> 
</span><span>C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>B</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>D</span><span class="token" style="color:#999">,</span><span> E</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> 
</span>
<span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dump</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>Run the program and inspect whether dependencies are expressed in the right way.
There are a number of free <a href="https://github.com/CodeFreezr/awesome-graphviz">GraphViz tools</a> you could find online
to visualize your Taskflow graph.</p>&lt;img align=&quot;right&quot; src=&quot;image/graphviz.png&quot; width=&quot;25%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>~$ ./debug
</span>
<!-- -->// Taskflow with five tasks and six dependencies
<span>digraph Taskflow </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;A&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;B&quot;</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;A&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;C&quot;</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;A&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;E&quot;</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;B&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;D&quot;</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;B&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;E&quot;</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;C&quot;</span><span> -</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#690">&quot;D&quot;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><h2>Dump the Dispatched Graphs</h2><p>When you have dynamic tasks (subflows),
you cannot simply use the <code>dump</code> method because it displays only the static portion.
Instead, you need to execute the graph first to include dynamic tasks
and then use the <code>dump_topologies</code> method.</p>&lt;img align=&quot;right&quot; src=&quot;image/debug_subflow.png&quot; width=&quot;40%&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>Taskflow </span><span class="token" style="color:#DD4A68">tf</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span><span class="token" style="color:slategray">// use only the master thread</span><span>
</span>
<span></span><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;A&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// create a subflow of two tasks B1-&gt;B2</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> subflow</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> B1 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B1&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">auto</span><span> B2 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> subflow</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B2&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  B1</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B2</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;B&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// dispatch the graph without cleanning up topologies</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// dump the entire graph (including dynamic tasks)</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dump_topologies</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>API Reference</h1><h2>Taskflow API</h2><p>The class <code>tf::Taskflow</code> is the main place to create and execute task dependency graph.
The table below summarizes a list of commonly used methods.
Visit <a href="https://cpp-taskflow.github.io/cpp-taskflow/index.html">documentation</a> to see the complete list.</p><table><thead><tr><th>Method</th><th>Argument</th><th>Return</th><th>Description</th></tr></thead><tbody><tr><td>Taskflow</td><td>none</td><td>none</td><td>construct a taskflow with the worker count equal to max hardware concurrency</td></tr><tr><td>Taskflow</td><td>size</td><td>none</td><td>construct a taskflow with a given number of workers</td></tr><tr><td>emplace</td><td>callables</td><td>tasks, futures</td><td>insert nodes to execute the given callables; results can be retrieved from the returned futures</td></tr><tr><td>silent_emplace</td><td>callables</td><td>tasks</td><td>insert nodes to execute the given callables</td></tr><tr><td>placeholder</td><td>none</td><td>task</td><td>insert a node without any work; work can be assigned later</td></tr><tr><td>linearize</td><td>task list</td><td>none</td><td>create a linear dependency in the given task list</td></tr><tr><td>parallel_for</td><td>beg, end, callable, group</td><td>task pair</td><td>apply the callable in parallel and group-by-group to the result of dereferencing every iterator in the range</td><td></td></tr><tr><td>parallel_for</td><td>beg, end, step, callable, group</td><td>task pair</td><td>apply the callable in parallel and group-by-group to a index-based range</td><td></td></tr><tr><td>reduce</td><td>beg, end, res, bop</td><td>task pair</td><td>reduce a range of elements to a single result through a binary operator</td><td></td></tr><tr><td>transform_reduce</td><td>beg, end, res, bop, uop</td><td>task pair</td><td>apply a unary operator to each element in the range and reduce them to a single result through a binary operator</td><td></td></tr><tr><td>dispatch</td><td>none</td><td>future</td><td>dispatch the current graph and return a shared future to block on completion</td></tr><tr><td>silent_dispatch</td><td>none</td><td>none</td><td>dispatch the current graph</td><td></td></tr><tr><td>wait_for_all</td><td>none</td><td>none</td><td>dispatch the current graph and block until all graphs finish, including all previously dispatched ones, and then clear all graphs</td></tr><tr><td>wait_for_topologies</td><td>none</td><td>none</td><td>block until all dispatched graphs (topologies) finish, and then clear these graphs</td></tr><tr><td>num_nodes</td><td>none</td><td>size</td><td>query the number of nodes in the current graph</td><td></td></tr><tr><td>num_workers</td><td>none</td><td>size</td><td>query the number of working threads in the pool</td><td></td></tr><tr><td>num_topologies</td><td>none</td><td>size</td><td>query the number of dispatched graphs</td></tr><tr><td>dump</td><td>none</td><td>string</td><td>dump the current graph to a string of GraphViz format</td></tr><tr><td>dump_topologies</td><td>none</td><td>string</td><td>dump dispatched topologies to a string of GraphViz format</td></tr></tbody></table><h3><em>emplace/silent_emplace/placeholder</em></h3><p>The main different between <code>emplace</code> and <code>silent_emplace</code> is the return value.
The method <code>emplace</code> gives you a <a href="https://en.cppreference.com/w/cpp/thread/future">std::future</a> object to retrieve the result of the callable
when the task completes.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// create a task through emplace</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>task</span><span class="token" style="color:#999">,</span><span> future</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_all</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#DD4A68">assert</span><span class="token" style="color:#999">(</span><span>future</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">==</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>If you don&#x27;t care the return result, using <code>silent_emplace</code> to create a task can give you slightly better performance.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// create a task through silent_emplace</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> task </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_all</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>When task cannot be determined beforehand, you can create a placeholder and assign the calalble later.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// create a placeholder and use it to build dependency</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> A </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">silent_emplace</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> B </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">placeholder</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// assign the callable later in the control flow</span><span>
</span><span>B</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">work</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">/* do something */</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3><em>linearize</em></h3><p>The method <code>linearize</code> lets you add a linear dependency between each adjacent pair of a task sequence.</p>&lt;img align=&quot;right&quot; width=&quot;40%&quot; src=&quot;image/linearize.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// linearize five tasks</span><span>
</span><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">linearize</span><span class="token" style="color:#999">(</span><span>A</span><span class="token" style="color:#999">,</span><span> B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> D</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3><em>parallel_for</em></h3><p>The method <code>parallel_for</code> creates a subgraph that applies the callable to each item in the given range of
a container.</p>&lt;img align=&quot;right&quot; width=&quot;40%&quot; src=&quot;image/parallel_for.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// apply callable to each container item in parallel</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> v </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#690">&#x27;A&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;B&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;C&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;D&#x27;</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">parallel_for</span><span class="token" style="color:#999">(</span><span>
</span><span>  v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">begin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>    </span><span class="token" style="color:slategray">// beg of range</span><span>
</span><span>  v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">end</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>      </span><span class="token" style="color:slategray">// end of range</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;parallel in &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:slategray">// add dependencies via S and T.</span></code></pre><p>Changing the group size can force intra-group tasks to run sequentially
and inter-group tasks to run in parallel.
Depending on applications, different group sizes can result in significant performance hit.</p>&lt;img align=&quot;right&quot; width=&quot;20%&quot; src=&quot;image/parallel_for_2.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// apply callable to two container items at a time in parallel</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> v </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#690">&#x27;A&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;B&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;C&#x27;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;D&#x27;</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">parallel_for</span><span class="token" style="color:#999">(</span><span>
</span><span>  v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">begin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>    </span><span class="token" style="color:slategray">// beg of range</span><span>
</span><span>  v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">end</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>      </span><span class="token" style="color:slategray">// end of range</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> 
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;AB and CD run in parallel&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#905">2</span><span>  </span><span class="token" style="color:slategray">// group two tasks at a time</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>By default, taskflow performs an even partition over worker threads
if the group size is not specified (or equal to 0).</p><p>In addition to range-based iterator, parallel_for has another overload on an index-based loop.
The first three argument to this overload indicates
starting index, ending index (exclusive), and step size.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// [0, 10) with a step size of 2</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">parallel_for</span><span class="token" style="color:#999">(</span><span>
</span><span>  </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> 
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;parallel_for on index &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> 
</span><span>  </span><span class="token" style="color:#905">2</span><span>  </span><span class="token" style="color:slategray">// group two tasks at a time</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:slategray">// will print 0, 2, 4, 6, 8 (three groups, {0, 2}, {4, 6}, {8})</span></code></pre><p>You can also go opposite direction by reversing the starting index and the ending index
with a negative step size.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// [10, 0) with a step size of -2</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">parallel_for</span><span class="token" style="color:#999">(</span><span>
</span><span>  </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> 
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;parallel_for on index &quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:slategray">// will print 10, 8, 6, 4, 2 (group size decided by taskflow)</span></code></pre><h3><em>reduce/transform_reduce</em></h3><p>The method <code>reduce</code> creates a subgraph that applies a binary operator to a range of items.
The result will be stored in the referenced <code>res</code> object passed to the method.
It is your responsibility to assign it a correct initial value to reduce.</p>&lt;img align=&quot;right&quot; width=&quot;45%&quot; src=&quot;image/reduce.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> v </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">4</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span> 
</span><span></span><span class="token" style="color:#07a">int</span><span> sum </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">reduce</span><span class="token" style="color:#999">(</span><span>    </span><span class="token" style="color:slategray">// for example, 2 threads</span><span>
</span><span>  v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">begin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">end</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> sum</span><span class="token" style="color:#999">,</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>plus</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">int</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>  </span></code></pre><p>The method <code>transform_reduce</code> is similar to reduce, except it applies a unary operator before reduction.
This is particular useful when you need additional data processing to reduce a range of elements.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>vector</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>pari</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">int</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">int</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;&gt;</span><span> v </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">5</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">4</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">4</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">int</span><span> min </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">numeric_limits</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">int</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">max</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">auto</span><span> </span><span class="token" style="color:#999">[</span><span>S</span><span class="token" style="color:#999">,</span><span> T</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">transform_reduce</span><span class="token" style="color:#999">(</span><span>v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">begin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> v</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">end</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> min</span><span class="token" style="color:#999">,</span><span> 
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> l</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">int</span><span> r</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">min</span><span class="token" style="color:#999">(</span><span>l</span><span class="token" style="color:#999">,</span><span> r</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">const</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>pair</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">int</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">int</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> pair</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#07a">return</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span class="token" style="color:#DD4A68">min</span><span class="token" style="color:#999">(</span><span>p</span><span class="token" style="color:#999">.</span><span>first</span><span class="token" style="color:#999">,</span><span> p</span><span class="token" style="color:#999">.</span><span>second</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>By default, all reduce methods distribute the workload evenly across threads.</p><h3><em>dispatch/silent_dispatch/wait_for_topologies/wait_for_all</em></h3><p>Dispatching a taskflow graph will schedule threads to execute the current graph and return immediately.
The method <code>dispatch</code> gives you a <a href="https://en.cppreference.com/w/cpp/thread/future">std::future</a> object to probe the execution progress while
<code>silent_dispatch</code> doesn&#x27;t.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">auto</span><span> future </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:slategray">// do something else to overlap with the execution </span><span>
</span><span></span><span class="token" style="color:slategray">// ...</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;now I need to block on completion&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span>future</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">get</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;all tasks complete&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span></code></pre><p>If you need to block your program flow until all tasks finish
(including the present taskflow graph), use <code>wait_for_all</code> instead.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_all</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;all tasks complete&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span></code></pre><p>If you only need to block your program flow until all dispatched taskflow graphs finish,
use <code>wait_for_topologies</code>.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>tf</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">wait_for_topologies</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;all topologies complete&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&#x27;\n&#x27;</span><span class="token" style="color:#999">;</span></code></pre><h2>Task API</h2><p>Each time you create a task, the taskflow object adds a node to the present task dependency graph
and return a <em>task handle</em> to you.
A task handle is a lightweight object that defines a set of methods for users to
access and modify the attributes of the associated task.
The table below summarizes the list of commonly used methods.
Visit <a href="https://cpp-taskflow.github.io/cpp-taskflow/index.html">documentation</a> to see the complete list.</p><table><thead><tr><th>Method</th><th>Argument</th><th>Return</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td>string</td><td>self</td><td>assign a human-readable name to the task</td></tr><tr><td>work</td><td>callable</td><td>self</td><td>assign a work of a callable object to the task</td></tr><tr><td>precede</td><td>task</td><td>self</td><td>enable this task to run <em>before</em> the given task</td></tr><tr><td>gather</td><td>task list</td><td>self</td><td>enable this task to run <em>after</em> the given tasks</td></tr><tr><td>num_dependents</td><td>none</td><td>size</td><td>return the number of dependents (inputs) of this task</td></tr><tr><td>num_successors</td><td>none</td><td>size</td><td>return the number of successors (outputs) of this task</td></tr></tbody></table><h3><em>name</em></h3><p>The method <code>name</code> lets you assign a human-readable string to a task.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">name</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;my name is A&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3><em>work</em></h3><p>The method <code>work</code> lets you assign a callable to a task.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">work</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;hello world!&quot;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3><em>precede</em></h3><p>The method <code>precede</code> is the basic building block to add a precedence between two tasks.</p>&lt;img align=&quot;right&quot; width=&quot;20%&quot; src=&quot;image/precede.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// make A runs before B</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><p>You can precede multiple tasks at one time.</p>&lt;img align=&quot;right&quot; width=&quot;30%&quot; src=&quot;image/broadcast.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// make A run before B, C, D, and E</span><span>
</span><span></span><span class="token" style="color:slategray">// B, C, D, and E run in parallel</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">precede</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> D</span><span class="token" style="color:#999">,</span><span> E</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h3><em>gather</em></h3><p>The method <code>gather</code> lets you add multiple precedences to a task.</p>&lt;img align=&quot;right&quot; width=&quot;30%&quot; src=&quot;image/gather.png&quot;&gt;<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// B, C, D, and E run in parallel</span><span>
</span><span></span><span class="token" style="color:slategray">// A runs after B, C, D, and E complete</span><span>
</span><span>A</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">gather</span><span class="token" style="color:#999">(</span><span>B</span><span class="token" style="color:#999">,</span><span> C</span><span class="token" style="color:#999">,</span><span> D</span><span class="token" style="color:#999">,</span><span> E</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>Caveats</h1><p>While Cpp-Taskflow enables the expression of very complex task dependency graph that might contain
thousands of task nodes and links, there are a few amateur pitfalls and mistakes to be aware of.</p><ul><li>Having a cycle in a graph may result in running forever</li><li>Trying to modify a dispatched task can result in undefined behavior</li><li>Touching a taskflow from multiple threads are not safe</li></ul><p>Cpp-Taskflow is known to work on Linux distributions, MAC OSX, and Microsoft Visual Studio.
Please <a href="mailto:twh760812@gmail.com">let me know</a> if you found any issues in a particular platform.</p><h1>System Requirements</h1><p>To use Cpp-Taskflow, you only need a <a href="https://en.wikipedia.org/wiki/C%2B%2B17">C++17</a> compiler:</p><ul><li>GNU C++ Compiler v7.3 with -std=c++1z</li><li>Clang C++ Compiler v6.0 with -std=c++17</li><li>Microsoft Visual Studio Version 15.7 (MSVC++ 19.14)</li></ul><h1>Compile Unit Tests and Examples</h1><p>Cpp-Taskflow uses <a href="https://cmake.org/">CMake</a> to build examples and unit tests.
We recommend using out-of-source build.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>~$ cmake --version  </span><span class="token" style="color:slategray"># must be at least 3.9 or higher</span><span>
</span><span>~$ </span><span class="token" style="color:#DD4A68">mkdir</span><span> build
</span><span>~$ </span><span class="token" style="color:#DD4A68">cd</span><span> build
</span><span>~$ cmake </span><span class="token" style="color:#999">..</span><span>/
</span><span>~$ </span><span class="token" style="color:#DD4A68">make</span><span> </span></code></pre><h2>Unit Tests</h2><p>Cpp-Taskflow uses <a href="https://github.com/onqtam/doctest">Doctest</a> for unit tests.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>~$ ./unittest/taskflow</span></code></pre><p>Alternatively, you can use CMake&#x27;s testing framework to run the unittest.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-bash" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>~$ </span><span class="token" style="color:#DD4A68">cd</span><span> build
</span><span>~$ </span><span class="token" style="color:#DD4A68">make</span><span> </span><span class="token" style="color:#DD4A68">test</span></code></pre><h2>Examples</h2><p>The folder <code>example/</code> contains several examples and is a great place to learn to use Cpp-Taskflow.</p><table><thead><tr><th>Example</th><th>Description</th></tr></thead><tbody><tr><td><a href="./example/simple.cpp">simple.cpp</a></td><td>uses basic task building blocks to create a trivial taskflow  graph</td></tr><tr><td><a href="./example/debug.cpp">debug.cpp</a></td><td>inspects a taskflow through the dump method</td></tr><tr><td><a href="./example/emplace.cpp">emplace.cpp</a></td><td>demonstrates the difference between the emplace method and the silent_emplace method</td></tr><tr><td><a href="./example/matrix.cpp">matrix.cpp</a></td><td>creates two set of matrices and multiply each individually in parallel</td></tr><tr><td><a href="./example/dispatch.cpp">dispatch.cpp</a></td><td>demonstrates how to dispatch a task dependency graph and assign a callback to execute</td></tr><tr><td><a href="./example/multiple_dispatch.cpp">multiple_dispatch.cpp</a></td><td>illustrates dispatching multiple taskflow graphs as independent batches (which all run on the same threadpool)</td></tr><tr><td><a href="./example/parallel_for.cpp">parallel_for.cpp</a></td><td>parallelizes a for loop with unbalanced workload</td></tr><tr><td><a href="./example/reduce.cpp">reduce.cpp</a></td><td>performs reduce operations over linear containers</td></tr><tr><td><a href="./example/subflow.cpp">subflow.cpp</a></td><td>demonstrates how to create a subflow graph that spawns three dynamic tasks</td></tr><tr><td><a href="./example/threadpool.cpp">threadpool.cpp</a></td><td>benchmarks different threadpool implementations</td></tr><tr><td><a href="./example/threadpool_cxx14.cpp">threadpool_cxx14.cpp</a></td><td>shows use of the C++14-compatible threadpool implementation, which may be used when you have no inter-task (taskflow) dependencies to express</td></tr><tr><td><a href="./example/taskflow.cpp">taskflow.cpp</a></td><td>benchmarks taskflow on different task dependency graphs</td></tr><tr><td><a href="./example/executor.cpp">executor.cpp</a></td><td>shows how to create multiple taskflow objects sharing one executor to avoid the thread over-subscription problem</td></tr></tbody></table><h1>Get Involved</h1><ul><li>Report bugs/issues by submitting a <a href="https://github.com/cpp-taskflow/cpp-taskflow/issues">GitHub issue</a></li><li>Submit contributions using <a href="https://github.com/cpp-taskflow/cpp-taskflow/pulls">pull requests</a></li><li>Learn more about Cpp-Taskflow by reading the <a href="https://cpp-taskflow.github.io/cpp-taskflow/index.html">documentation</a></li></ul><h1>Who is Using Cpp-Taskflow?</h1><p>Cpp-Taskflow is being used in both industry and academic projects to scale up existing workloads
that incorporate complex task dependencies.</p><ul><li><a href="https://github.com/OpenTimer/OpenTimer">OpenTimer</a>: A High-performance Timing Analysis Tool for Very Large Scale Integration (VLSI) Systems</li><li><a href="http://dtcraft.web.engr.illinois.edu/">DtCraft</a>: A General-purpose Distributed Programming Systems using Data-parallel Streams</li><li><a href="https://github.com/ForgeMistress/Firestorm">Firestorm</a>: Fighting Game Engine with Asynchronous Resource Loaders (developed by <a href="https://github.com/ForgeMistress">ForgeMistress</a>)</li><li><a href="https://shiva.gitbook.io/project/shiva">Shiva</a>: An extensible engine via an entity component system through scripts, DLLs, and header-only (C++)</li></ul><p>Please <a href="mailto:twh760812@gmail.com">let me know</a> if I forgot your project!</p><h1>Contributors</h1><p>Cpp-Taskflow is being actively developed and contributed by the following people:</p><ul><li><a href="https://twhuang.ece.illinois.edu/">Tsung-Wei Huang</a> created the Cpp-Taskflow project and implemented the core routines</li><li><a href="https://github.com/clin99">Chun-Xun Lin</a> co-created the Cpp-Taskflow project and implemented the core routines</li><li><a href="https://ece.illinois.edu/directory/profile/mdfwong">Martin Wong</a> supported the Cpp-Taskflow project through NSF and DARPA funding</li><li><a href="https://github.com/aolofsson">Andreas Olofsson</a> supported the Cpp-Taskflow project through the DARPA IDEA project</li><li><a href="https://github.com/NanXiao">Nan Xiao</a> fixed compilation error of unittest on the Arch platform</li><li><a href="https://github.com/innermous">Vladyslav</a> fixed comment errors in README.md and examples</li><li><a href="https://github.com/vblanco20-1">vblanco20-1</a> fixed compilation error on Microsoft Visual Studio</li><li><a href="https://github.com/totalgee">Glen Fraser</a> created a standalone C++14-compatible <a href="./taskflow/threadpool/threadpool_cxx14.hpp">threadpool</a> for taskflow; various other fixes and examples</li><li><a href="https://github.com/gguo4">Guannan Guo</a> added different threadpool implementations to enhance the performance for taskflow</li><li><a href="https://github.com/patrikhuber">Patrik Huber</a> helped fixed typos in the documentation</li><li><a href="https://github.com/ForgeMistress">ForgeMistress</a> provided API ideas about sharing the executor to avoid thread over-subscriptiong issues</li><li><a href="https://github.com/Neumann-A">Alexander Neumann</a> helped modify the cmake build to make Cpp-Taskflow importable from external cmake projects</li></ul><p>Meanwhile, we appreciate the support from many organizations for our development on Cpp-Taskflow.
Please <a href="mailto:twh760812@gmail.com">let me know</a> if I forgot someone!</p><table><thead><tr><th style="text-align:center"><a href="https://illinois.edu/">&lt;img src=&quot;image/uiuc.png&quot; width=&quot;100px&quot;&gt;</a></th><th style="text-align:center"><a href="https://csl.illinois.edu/">&lt;img src=&quot;image/csl.png&quot; width=&quot;100px&quot;&gt;</a></th><th style="text-align:center"><a href="https://www.nsf.gov/">&lt;img src=&quot;image/nsf.png&quot; width=&quot;100px&quot;&gt;</a></th><th style="text-align:center"><a href="https://www.darpa.mil/news-events/2017-09-13">&lt;img src=&quot;image/darpa.png&quot; width=&quot;100px&quot;&gt;</a></th></tr></thead></table><h1>License</h1><p>Cpp-Taskflow is licensed under the <a href="./LICENSE">MIT License</a>.</p><hr/></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/cpp-taskflow","name":"taskflow/taskflow","licence":"MIT","description":"Modern C++ Parallel Task Programming Library","readme":"# Cpp-Taskflow \u003cimg align=\"right\" width=\"10%\" src=\"image/cpp-taskflow_logo.png\"\u003e\n\n[![Linux Build Status](https://travis-ci.com/cpp-taskflow/cpp-taskflow.svg?branch=master)](https://travis-ci.com/cpp-taskflow/cpp-taskflow)\n[![Windows Build status](https://ci.appveyor.com/api/projects/status/te9bjp4yfhq7f8hq?svg=true)](https://ci.appveyor.com/project/TsungWeiHuang/cpp-taskflow)\n[![Standard](image/cpp17.svg)](https://en.wikipedia.org/wiki/C%2B%2B#Standardization)\n[![Download](image/download.svg)](https://github.com/cpp-taskflow/cpp-taskflow/archive/master.zip)\n[![Wiki](image/doc-wiki.svg)][wiki]\n[![Insights](image/maintained.svg)][GitHub insights]\n[![License: MIT](./image/license_badge.svg)](./LICENSE)\n\nA fast C++ header-only library to help you quickly write parallel programs with complex task dependencies\n\n# Why Cpp-Taskflow?\n\nCpp-Taskflow is by far faster, more expressive, fewer lines of code, and easier for drop-in integration\nthan existing parallel task programming libraries such as [OpenMP Tasking][OpenMP Tasking] and Intel [TBB FlowGraph][TBB FlowGraph].\n\n![](image/performance.jpg)\n\nCpp-Taskflow enables you to implement efficient task decomposition strategies\nthat incorporate both regular loop-based parallelism \nand irregular compute patterns to optimize multicore performance.\n\n\n| Without Cpp-Taskflow | With Cpp-Taskflow |\n| -------------------- | ----------------- |\n| ![](image/profile_without_taskflow.gif) | ![](image/profile_with_taskflow.gif) |\n\nCpp-Taskflow has a unified interface for both *static* tasking and *dynamic* tasking,\nallowing users to quickly master our parallel task programming model in a natural idiom.\n\n| Static Tasking | Dynamic Tasking |\n| :------------: | :-------------: |\n| ![](image/static_graph.png) | ![](image/dynamic_graph.png) |\n\nCpp-Taskflow is committed to support both academic and industry research projects,\nmaking it reliable and cost-effective for long-term and large-scale developments.\n\n+ *\"Cpp-Taskflow is the cleanest Task API I've ever seen.\" [damienhocking][damienhocking]*\n+ *\"Cpp-Taskflow has a very simple and elegant tasking interface. The performance also scales very well.\" [totalgee][totalgee]*\n+ *\"Best poster award for open-source parallel programming library.\" [Cpp Conference 2018][Cpp Conference 2018]*\n\nSee a quick [presentation][Presentation] and \nvisit the [documentation][wiki] to learn more about Cpp-Taskflow.\n\n# Get Started with Cpp-Taskflow\n\nThe following example [simple.cpp](./example/simple.cpp) shows the basic Cpp-Taskflow API\nyou need in most applications.\n\n```cpp\n#include \u003ctaskflow/taskflow.hpp\u003e  // Cpp-Taskflow is header-only\n\nint main(){\n  \n  tf::Taskflow tf;\n\n  auto [A, B, C, D] = tf.silent_emplace(\n    [] () { std::cout \u003c\u003c \"TaskA\\n\"; },               //  task dependency graph\n    [] () { std::cout \u003c\u003c \"TaskB\\n\"; },               // \n    [] () { std::cout \u003c\u003c \"TaskC\\n\"; },               //          +---+          \n    [] () { std::cout \u003c\u003c \"TaskD\\n\"; }                //    +----\u003e| B |-----+   \n  );                                                 //    |     +---+     |\n                                                     //  +---+           +-v-+ \n  A.precede(B);  // A runs before B                  //  | A |           | D | \n  A.precede(C);  // A runs before C                  //  +---+           +-^-+ \n  B.precede(D);  // B runs before D                  //    |     +---+     |    \n  C.precede(D);  // C runs before D                  //    +----\u003e| C |-----+    \n                                                     //          +---+          \n  tf.wait_for_all();  // block until finish\n\n  return 0;\n}\n```\n\nCompile and run the code with the following commands:\n\n```bash\n~$ g++ simple.cpp -std=c++1z -O2 -lpthread -o simple\n~$ ./simple\nTaskA\nTaskC  \u003c-- concurrent with TaskB\nTaskB  \u003c-- concurrent with TaskC\nTaskD\n```\n\nIt is clear now Cpp-Taskflow is powerful in parallelizing tasks with complex dependencies.\nThe following example demonstrates a concurrent execution of 10 tasks with 15 dependencies.\nWith Cpp-Taskflow, you only need ***15 lines of code***.\n\n\u003cimg align=\"right\" src=\"image/complex.png\" width=\"30%\"\u003e\n\n```cpp\n// source dependencies\nS.precede(a0);    // S runs before a0\nS.precede(b0);    // S runs before b0\nS.precede(a1);    // S runs before a1\n\n// a_ -\u003e others\na0.precede(a1);   // a0 runs before a1\na0.precede(b2);   // a0 runs before b2\na1.precede(a2);   // a1 runs before a2\na1.precede(b3);   // a1 runs before b3\na2.precede(a3);   // a2 runs before a3\n\n// b_ -\u003e others\nb0.precede(b1);   // b0 runs before b1\nb1.precede(b2);   // b1 runs before b2\nb2.precede(b3);   // b2 runs before b3\nb2.precede(a3);   // b2 runs before a3\n\n// target dependencies\na3.precede(T);    // a3 runs before T\nb1.precede(T);    // b1 runs before T\nb3.precede(T);    // b3 runs before T\n```\n\n# Create a Taskflow Graph\n\nCpp-Taskflow has very expressive and neat methods to create dependency graphs.\nMost applications are developed through the following three steps.\n\n## Step 1: Create a Task\n\nA task is a callable object for which [std::invoke][std::invoke] is applicable.\nCreate a taskflow object to start a task dependency graph.\n\n```cpp\ntf::Taskflow tf;\n```\n\nCreate a task from a callable object via the method `silent_emplace`\nto get a task handle.\n\n```cpp\nauto A = tf.silent_emplace([](){ std::cout \u003c\u003c \"Task A\\n\"; });\n```\n\nYou can create multiple tasks at one time.\n\n```cpp\nauto [A, B, C, D] = tf.silent_emplace(\n  [] () { std::cout \u003c\u003c \"Task A\\n\"; },\n  [] () { std::cout \u003c\u003c \"Task B\\n\"; },\n  [] () { std::cout \u003c\u003c \"Task C\\n\"; },\n  [] () { std::cout \u003c\u003c \"Task D\\n\"; }\n);\n```\n\n## Step 2: Define Task Dependencies\n\nOnce tasks are created in the pool, you need to specify task dependencies in a \n[Directed Acyclic Graph (DAG)](https://en.wikipedia.org/wiki/Directed_acyclic_graph) fashion.\nThe handle `Task` supports different methods for you to describe task dependencies.\n\n**Precede**: Adding a preceding link forces one task to run ahead of one another.\n```cpp\nA.precede(B);  // A runs before B.\n```\n\n**Gather**: Adding a gathering link forces one task to run after other(s).\n```cpp\nA.gather(B);  // A runs after B\n```\n\n## Step 3: Execute the Tasks\n\nThere are three methods to execute a task dependency graph, \n`dispatch`, `silent_dispatch`, and `wait_for_all`.\n\n```cpp\nauto future = tf.dispatch();  // non-blocking, returns with a future immediately.\ntf.silent_dispatch();         // non-blocking, no return\n```\n\nCalling `wait_for_all` will block until all tasks complete.\n\n```cpp\ntf.wait_for_all();\n```\n\nEach of these methods dispatches the current graph to threads for execution\nand create a data structure called *topology* to store the execution status.\n\n\n# Dynamic Tasking\n\nAnother powerful feature of Taskflow is *dynamic* tasking.\nA dynamic task is created during the execution of a dispatched taskflow graph, i.e.,\ntopology.\nThese tasks are spawned by a parent task and are grouped together to a *subflow* graph.\nThe example below demonstrates how to create a subflow\nthat spawns three tasks during its execution.\n\n\u003cimg align=\"right\" src=\"image/subflow_join.png\" width=\"40%\"\u003e\n\n```cpp\n// create three regular tasks\nauto A = tf.silent_emplace([](){}).name(\"A\");\nauto C = tf.silent_emplace([](){}).name(\"C\");\nauto D = tf.silent_emplace([](){}).name(\"D\");\n\n// create a subflow graph (dynamic tasking)\nauto B = tf.silent_emplace([] (auto\u0026 subflow) {\n  auto B1 = subflow.silent_emplace([](){}).name(\"B1\");\n  auto B2 = subflow.silent_emplace([](){}).name(\"B2\");\n  auto B3 = subflow.silent_emplace([](){}).name(\"B3\");\n  B1.precede(B3);\n  B2.precede(B3);\n}).name(\"B\");\n            \nA.precede(B);  // B runs after A \nA.precede(C);  // C runs after A \nB.precede(D);  // D runs after B \nC.precede(D);  // D runs after C \n\n// execute the graph without cleanning up topologies\ntf.dispatch().get();\nstd::cout \u003c\u003c tf.dump_topologies();\n```\n\nBy default, a subflow graph joins to its parent node. \nThis guarantees a subflow graph to finish before the successors of \nits parent node.\nYou can disable this feature by calling `subflow.detach()`.\nDetaching the above subflow will result in the following execution flow.\n\n\u003cimg align=\"right\" src=\"image/subflow_detach.png\" width=\"65%\"\u003e\n\n```cpp\n// detach a subflow graph\n[] (auto\u0026 subflow) {\n  ...\n  B1.precede(B3);\n  B2.precede(B3);\n\n  // detach from B \n  subflow.detach();\n}).name(\"TaskB\");\n```\n\n## Step 1: Create a Subflow\n\nCpp-Taskflow has an unified interface for static and dynamic tasking.\nTo create a subflow for dynamic tasking, \nemplace a callable on one argument of type `tf::SubflowBuilder`.\n\n```cpp\nauto A = tf.silent_emplace([] (tf::SubflowBuilder\u0026 subflow) {});\n```\n\nSimilarly, you can get a [std::future][std::future] object to the execution status of the subflow.\n\n```cpp\nauto [A, fu] = tf.emplace([] (tf::SubflowBuilder\u0026 subflow) {});\n```\n\nA subflow builder is a lightweight object that allows you to create \narbitrary dependency graphs on the fly.\nAll graph building methods defined in taskflow\ncan be used in a subflow builder.\n\n```cpp\nauto A = tf.silent_emplace([] (tf::SubflowBuilder\u0026 subflow) {\n  std::cout \u003c\u003c \"Task A is spawning two subtasks A1 and A2\" \u003c\u003c '\\n';\n  auto [A1, A2] = subflow.silent_emplace(\n    [] () { std::cout \u003c\u003c \"subtask A1\" \u003c\u003c '\\n'; },\n    [] () { std::cout \u003c\u003c \"subtask A2\" \u003c\u003c '\\n'; }\n    A1.precede(A2);\n  );\n});\n```\n\nA subflow can also be nested or recursive. You can create another subflow from\nthe execution of a subflow and so on.\n\n\u003cimg align=\"right\" src=\"image/nested_subflow.png\" width=\"45%\"\u003e\n\n```cpp\nauto A = tf.silent_emplace([] (auto\u0026 sbf){\n  std::cout \u003c\u003c \"A spawns A1 \u0026 subflow A2\\n\";\n  auto A1 = sbf.silent_emplace([] () { \n    std::cout \u003c\u003c \"subtask A1\\n\"; \n  }).name(\"A1\");\n\n  auto A2 = sbf.silent_emplace([] (auto\u0026 sbf2){\n    std::cout \u003c\u003c \"A2 spawns A2_1 \u0026 A2_2\\n\";\n    auto A2_1 = sbf2.silent_emplace([] () { \n      std::cout \u003c\u003c \"subtask A2_1\\n\"; \n    }).name(\"A2_1\");\n    auto A2_2 = sbf2.silent_emplace([] () { \n      std::cout \u003c\u003c \"subtask A2_2\\n\"; \n    }).name(\"A2_2\");\n    A2_1.precede(A2_2);\n  }).name(\"A2\");\n  A1.precede(A2);\n}).name(\"A\");\n```\n\n## Step 2: Detach or Join a Subflow\n\nA subflow has no methods to dispatch its tasks.\nInstead, a subflow will be executed after leaving the context of the callable.\nBy default, a subflow joins to its parent task.\nDepending on applications, you can detach a subflow to enable more parallelism.\n\n```cpp\nauto A = tf.silent_emplace([] (tf::SubflowBuilder\u0026 subflow) {\n  subflow.detach();  // detach this subflow from its parent task A\n});  // subflow starts to run after the callable scope\n```\n\nDetaching or Joining a subflow has different meaning in the ready status of \nthe future object referred to it.\nIn a joined subflow, \nthe completion of its parent node is defined as when all tasks\ninside the subflow (possibly nested) finish.\n\n\u003cimg align=\"right\" src=\"image/joined_subflow_future.png\" width=\"40%\"\u003e\n\n```cpp\nint value {0};\n\n// create a joined subflow\nauto [A, fuA] = tf.emplace([\u0026] (auto\u0026 subflow) {\n  subflow.silent_emplace([\u0026]() { \n    value = 10; \n  });\n  return 100;   // some arbitrary value\n});\n\n// create a task B after A\nauto B = tf.silent_emplace([\u0026] () { \n  assert(value == 10); \n  assert(fuA.wait_for(0s) == std::future_status::ready);\n});\n\n// A1 must finish before A and therefore before B\nA.precede(B);\n```\n\nWhen a subflow is detached from its parent task, it becomes a parallel\nexecution line to the current flow graph and will eventually\njoin to the same topology.\n\n\u003cimg align=\"right\" src=\"image/detached_subflow_future.png\" width=\"40%\"\u003e\n\n```cpp\nint value {0};\n\n// create a detached subflow\nauto [A, fuA] = tf.emplace([\u0026] (auto\u0026 subflow) {\n  subflow.silent_emplace([\u0026]() { value = 10; });\n  subflow.detach();\n  return 100;   // some arbitrary value\n});\n\n// create a task B after A\nauto B = tf.silent_emplace([\u0026] () { \n  // no guarantee for value to be 10 nor fuA ready\n});\nA.precede(B);\n```\n\n\n# Debug a Taskflow Graph\n\nConcurrent programs are notoriously difficult to debug.\nCpp-Taskflow leverages the graph properties to relieve the debugging pain.\nTo debug a taskflow graph,\n(1) name tasks and dump the graph, and\n(2) start with one thread before going multiple.\nCurrently, Cpp-Taskflow supports [GraphViz][GraphViz] format.\n\n## Dump the Present Taskflow Graph\n\nEach time you create a task or add a dependency, \nit adds a node or an edge to the present taskflow graph.\nThe graph is not dispatched yet and you can dump it to a GraphViz format.\n\n```cpp\n// debug.cpp\ntf::Taskflow tf(0);  // use only the master thread\nauto A = tf.silent_emplace([] () {}).name(\"A\");\nauto B = tf.silent_emplace([] () {}).name(\"B\");\nauto C = tf.silent_emplace([] () {}).name(\"C\");\nauto D = tf.silent_emplace([] () {}).name(\"D\");\nauto E = tf.silent_emplace([] () {}).name(\"E\");\n\nA.precede(B, C, E); \nC.precede(D);\nB.precede(D, E); \n\nstd::cout \u003c\u003c tf.dump();\n```\n\nRun the program and inspect whether dependencies are expressed in the right way. \nThere are a number of free [GraphViz tools][AwesomeGraphViz] you could find online\nto visualize your Taskflow graph.\n\n\u003cimg align=\"right\" src=\"image/graphviz.png\" width=\"25%\"\u003e\n\n```bash\n~$ ./debug\n\n// Taskflow with five tasks and six dependencies\ndigraph Taskflow {\n  \"A\" -\u003e \"B\"\n  \"A\" -\u003e \"C\"\n  \"A\" -\u003e \"E\"\n  \"B\" -\u003e \"D\"\n  \"B\" -\u003e \"E\"\n  \"C\" -\u003e \"D\"\n}\n```\n\n## Dump the Dispatched Graphs\n\nWhen you have dynamic tasks (subflows),\nyou cannot simply use the `dump` method because it displays only the static portion.\nInstead, you need to execute the graph first to include dynamic tasks\nand then use the `dump_topologies` method.\n\n\u003cimg align=\"right\" src=\"image/debug_subflow.png\" width=\"40%\"\u003e\n\n```cpp\ntf::Taskflow tf(0);  // use only the master thread\n\nauto A = tf.silent_emplace([](){}).name(\"A\");\n\n// create a subflow of two tasks B1-\u003eB2\nauto B = tf.silent_emplace([] (auto\u0026 subflow) {\n  auto B1 = subflow.silent_emplace([](){}).name(\"B1\");\n  auto B2 = subflow.silent_emplace([](){}).name(\"B2\");\n  B1.precede(B2);\n}).name(\"B\");\n\nA.precede(B);\n\n// dispatch the graph without cleanning up topologies\ntf.dispatch().get();\n\n// dump the entire graph (including dynamic tasks)\nstd::cout \u003c\u003c tf.dump_topologies();\n```\n\n# API Reference\n\n## Taskflow API\n\nThe class `tf::Taskflow` is the main place to create and execute task dependency graph.\nThe table below summarizes a list of commonly used methods.\nVisit [documentation][wiki] to see the complete list.\n\n| Method   | Argument  | Return  | Description |\n| -------- | --------- | ------- | ----------- |\n| Taskflow | none      | none    | construct a taskflow with the worker count equal to max hardware concurrency |\n| Taskflow | size      | none    | construct a taskflow with a given number of workers |\n| emplace  | callables | tasks, futures | insert nodes to execute the given callables; results can be retrieved from the returned futures |\n| silent_emplace  | callables | tasks         | insert nodes to execute the given callables |\n| placeholder     | none        | task         | insert a node without any work; work can be assigned later |\n| linearize       | task list   | none         | create a linear dependency in the given task list |\n| parallel_for    | beg, end, callable, group | task pair | apply the callable in parallel and group-by-group to the result of dereferencing every iterator in the range | \n| parallel_for    | beg, end, step, callable, group | task pair | apply the callable in parallel and group-by-group to a index-based range | \n| reduce | beg, end, res, bop | task pair | reduce a range of elements to a single result through a binary operator | \n| transform_reduce | beg, end, res, bop, uop | task pair | apply a unary operator to each element in the range and reduce them to a single result through a binary operator | \n| dispatch        | none        | future | dispatch the current graph and return a shared future to block on completion |\n| silent_dispatch | none        | none | dispatch the current graph | \n| wait_for_all    | none        | none | dispatch the current graph and block until all graphs finish, including all previously dispatched ones, and then clear all graphs |\n| wait_for_topologies | none    | none | block until all dispatched graphs (topologies) finish, and then clear these graphs |\n| num_nodes       | none        | size | query the number of nodes in the current graph |  \n| num_workers     | none        | size | query the number of working threads in the pool |  \n| num_topologies  | none        | size | query the number of dispatched graphs |\n| dump            | none        | string | dump the current graph to a string of GraphViz format |\n| dump_topologies | none        | string | dump dispatched topologies to a string of GraphViz format |\n\n### *emplace/silent_emplace/placeholder*\n\nThe main different between `emplace` and `silent_emplace` is the return value.\nThe method `emplace` gives you a [std::future][std::future] object to retrieve the result of the callable \nwhen the task completes.\n\n```cpp\n// create a task through emplace\nauto [task, future] = tf.emplace([](){ return 1; });\ntf.wait_for_all();\nassert(future.get() == 1);\n```\n\nIf you don't care the return result, using `silent_emplace` to create a task can give you slightly better performance.\n```cpp\n// create a task through silent_emplace\nauto task = tf.emplace([](){ return; });\ntf.wait_for_all();\n```\n\nWhen task cannot be determined beforehand, you can create a placeholder and assign the calalble later.\n```cpp\n// create a placeholder and use it to build dependency\nauto A = tf.silent_emplace([](){});\nauto B = tf.placeholder();\nA.precede(B);\n\n// assign the callable later in the control flow\nB.work([](){ /* do something */ });\n```\n\n### *linearize*\n\nThe method `linearize` lets you add a linear dependency between each adjacent pair of a task sequence.\n\n\u003cimg align=\"right\" width=\"40%\" src=\"image/linearize.png\"\u003e\n\n```cpp\n// linearize five tasks\ntf.linearize(A, B, C, D);\n```\n\n### *parallel_for*\n\nThe method `parallel_for` creates a subgraph that applies the callable to each item in the given range of\na container.\n\n\u003cimg align=\"right\" width=\"40%\" src=\"image/parallel_for.png\"\u003e\n\n```cpp\n// apply callable to each container item in parallel\nauto v = {'A', 'B', 'C', 'D'};\nauto [S, T] = tf.parallel_for(\n  v.begin(),    // beg of range\n  v.end(),      // end of range\n  [] (int i) { \n    std::cout \u003c\u003c \"parallel in \" \u003c\u003c i \u003c\u003c '\\n';\n  }\n);\n// add dependencies via S and T.\n```\n\nChanging the group size can force intra-group tasks to run sequentially\nand inter-group tasks to run in parallel.\nDepending on applications, different group sizes can result in significant performance hit.\n\n\u003cimg align=\"right\" width=\"20%\" src=\"image/parallel_for_2.png\"\u003e\n\n```cpp\n// apply callable to two container items at a time in parallel\nauto v = {'A', 'B', 'C', 'D'};\nauto [S, T] = tf.parallel_for(\n  v.begin(),    // beg of range\n  v.end(),      // end of range\n  [] (int i) { \n    std::cout \u003c\u003c \"AB and CD run in parallel\" \u003c\u003c '\\n';\n  },\n  2  // group two tasks at a time\n);\n```\n\nBy default, taskflow performs an even partition over worker threads\nif the group size is not specified (or equal to 0).\n\nIn addition to range-based iterator, parallel\\_for has another overload on an index-based loop.\nThe first three argument to this overload indicates \nstarting index, ending index (exclusive), and step size.\n\n```cpp\n// [0, 10) with a step size of 2\nauto [S, T] = tf.parallel_for(\n  0, 10, 2, \n  [] (int i) {\n    std::cout \u003c\u003c \"parallel_for on index \" \u003c\u003c i \u003c\u003c std::endl;\n  }, \n  2  // group two tasks at a time\n);\n// will print 0, 2, 4, 6, 8 (three groups, {0, 2}, {4, 6}, {8})\n```\n\nYou can also go opposite direction by reversing the starting index and the ending index\nwith a negative step size.\n\n```cpp\n// [10, 0) with a step size of -2\nauto [S, T] = tf.parallel_for(\n  10, 0, 2, \n  [] (int i) {\n    std::cout \u003c\u003c \"parallel_for on index \" \u003c\u003c i \u003c\u003c std::endl;\n  }\n);\n// will print 10, 8, 6, 4, 2 (group size decided by taskflow)\n```\n\n### *reduce/transform_reduce*\n\nThe method `reduce` creates a subgraph that applies a binary operator to a range of items.\nThe result will be stored in the referenced `res` object passed to the method. \nIt is your responsibility to assign it a correct initial value to reduce.\n\n\u003cimg align=\"right\" width=\"45%\" src=\"image/reduce.png\"\u003e\n\n```cpp\nauto v = {1, 2, 3, 4}; \nint sum {0};\nauto [S, T] = tf.reduce(    // for example, 2 threads\n  v.begin(), v.end(), sum, std::plus\u003cint\u003e()\n);  \n```\n\nThe method `transform_reduce` is similar to reduce, except it applies a unary operator before reduction.\nThis is particular useful when you need additional data processing to reduce a range of elements.\n\n```cpp\nstd::vector\u003cstd::pari\u003cint, int\u003e\u003e v = { {1, 5}, {6, 4}, {-6, 4} };\nint min = std::numeric_limits\u003cint\u003e::max();\nauto [S, T] = tf.transform_reduce(v.begin(), v.end(), min, \n  [] (int l, int r) { return std::min(l, r); },\n  [] (const std::pair\u003cint, int\u003e\u0026 pair) { return std::min(p.first, p.second); }\n);\n```\n\nBy default, all reduce methods distribute the workload evenly across threads.\n\n### *dispatch/silent_dispatch/wait_for_topologies/wait_for_all*\n\nDispatching a taskflow graph will schedule threads to execute the current graph and return immediately.\nThe method `dispatch` gives you a [std::future][std::future] object to probe the execution progress while\n`silent_dispatch` doesn't.\n\n```cpp\nauto future = tf.dispatch();\n// do something else to overlap with the execution \n// ...\nstd::cout \u003c\u003c \"now I need to block on completion\" \u003c\u003c '\\n';\nfuture.get();\nstd::cout \u003c\u003c \"all tasks complete\" \u003c\u003c '\\n';\n```\n\nIf you need to block your program flow until all tasks finish \n(including the present taskflow graph), use `wait_for_all` instead.\n\n```cpp\ntf.wait_for_all();\nstd::cout \u003c\u003c \"all tasks complete\" \u003c\u003c '\\n';\n```\n\nIf you only need to block your program flow until all dispatched taskflow graphs finish,\nuse `wait_for_topologies`.\n\n```cpp\ntf.wait_for_topologies();\nstd::cout \u003c\u003c \"all topologies complete\" \u003c\u003c '\\n';\n```\n\n## Task API\n\nEach time you create a task, the taskflow object adds a node to the present task dependency graph\nand return a *task handle* to you.\nA task handle is a lightweight object that defines a set of methods for users to\naccess and modify the attributes of the associated task.\nThe table below summarizes the list of commonly used methods.\nVisit [documentation][wiki] to see the complete list.\n\n| Method         | Argument    | Return | Description |\n| -------------- | ----------- | ------ | ----------- |\n| name           | string      | self   | assign a human-readable name to the task |\n| work           | callable    | self   | assign a work of a callable object to the task |\n| precede        | task        | self   | enable this task to run *before* the given task |\n| gather         | task list   | self   | enable this task to run *after* the given tasks |\n| num_dependents | none        | size   | return the number of dependents (inputs) of this task |\n| num_successors | none        | size   | return the number of successors (outputs) of this task |\n\n### *name*\n\nThe method `name` lets you assign a human-readable string to a task.\n\n```cpp\nA.name(\"my name is A\");\n```\n\n### *work*\n\nThe method `work` lets you assign a callable to a task.\n\n```cpp\nA.work([] () { std::cout \u003c\u003c \"hello world!\"; });\n```\n\n### *precede*\n\nThe method `precede` is the basic building block to add a precedence between two tasks.\n\n\u003cimg align=\"right\" width=\"20%\" src=\"image/precede.png\"\u003e\n\n```cpp\n// make A runs before B\nA.precede(B);\n```\n\nYou can precede multiple tasks at one time.\n\n\u003cimg align=\"right\" width=\"30%\" src=\"image/broadcast.png\"\u003e\n\n```cpp\n// make A run before B, C, D, and E\n// B, C, D, and E run in parallel\nA.precede(B, C, D, E);\n```\n\n### *gather*\n\nThe method `gather` lets you add multiple precedences to a task.\n\n\u003cimg align=\"right\" width=\"30%\" src=\"image/gather.png\"\u003e\n\n```cpp\n// B, C, D, and E run in parallel\n// A runs after B, C, D, and E complete\nA.gather(B, C, D, E);\n```\n\n# Caveats\n\nWhile Cpp-Taskflow enables the expression of very complex task dependency graph that might contain \nthousands of task nodes and links, there are a few amateur pitfalls and mistakes to be aware of.\n\n+ Having a cycle in a graph may result in running forever\n+ Trying to modify a dispatched task can result in undefined behavior\n+ Touching a taskflow from multiple threads are not safe\n\nCpp-Taskflow is known to work on Linux distributions, MAC OSX, and Microsoft Visual Studio.\nPlease [let me know][email me] if you found any issues in a particular platform.\n\n# System Requirements\n\nTo use Cpp-Taskflow, you only need a [C++17][C++17] compiler:\n+ GNU C++ Compiler v7.3 with -std=c++1z\n+ Clang C++ Compiler v6.0 with -std=c++17\n+ Microsoft Visual Studio Version 15.7 (MSVC++ 19.14)\n\n# Compile Unit Tests and Examples\n\nCpp-Taskflow uses [CMake](https://cmake.org/) to build examples and unit tests.\nWe recommend using out-of-source build.\n\n```bash\n~$ cmake --version  # must be at least 3.9 or higher\n~$ mkdir build\n~$ cd build\n~$ cmake ../\n~$ make \n```\n\n## Unit Tests\n\nCpp-Taskflow uses [Doctest](https://github.com/onqtam/doctest) for unit tests.\n\n```bash\n~$ ./unittest/taskflow\n```\n\nAlternatively, you can use CMake's testing framework to run the unittest.\n\n```bash\n~$ cd build\n~$ make test\n```\n\n## Examples\n\nThe folder `example/` contains several examples and is a great place to learn to use Cpp-Taskflow.\n\n| Example |  Description |\n| ------- |  ----------- | \n| [simple.cpp](./example/simple.cpp) | uses basic task building blocks to create a trivial taskflow  graph |\n| [debug.cpp](./example/debug.cpp)| inspects a taskflow through the dump method |\n| [emplace.cpp](./example/emplace.cpp)| demonstrates the difference between the emplace method and the silent_emplace method |\n| [matrix.cpp](./example/matrix.cpp) | creates two set of matrices and multiply each individually in parallel |\n| [dispatch.cpp](./example/dispatch.cpp) | demonstrates how to dispatch a task dependency graph and assign a callback to execute |\n| [multiple_dispatch.cpp](./example/multiple_dispatch.cpp) | illustrates dispatching multiple taskflow graphs as independent batches (which all run on the same threadpool) |\n| [parallel_for.cpp](./example/parallel_for.cpp)| parallelizes a for loop with unbalanced workload |\n| [reduce.cpp](./example/reduce.cpp)| performs reduce operations over linear containers |\n| [subflow.cpp](./example/subflow.cpp)| demonstrates how to create a subflow graph that spawns three dynamic tasks |\n| [threadpool.cpp](./example/threadpool.cpp)| benchmarks different threadpool implementations |\n| [threadpool_cxx14.cpp](./example/threadpool_cxx14.cpp)| shows use of the C++14-compatible threadpool implementation, which may be used when you have no inter-task (taskflow) dependencies to express |\n| [taskflow.cpp](./example/taskflow.cpp)| benchmarks taskflow on different task dependency graphs |\n| [executor.cpp](./example/executor.cpp)| shows how to create multiple taskflow objects sharing one executor to avoid the thread over-subscription problem |\n\n# Get Involved\n\n+ Report bugs/issues by submitting a [GitHub issue][GitHub issues]\n+ Submit contributions using [pull requests][GitHub pull requests]\n+ Learn more about Cpp-Taskflow by reading the [documentation][wiki]\n\n# Who is Using Cpp-Taskflow?\n\nCpp-Taskflow is being used in both industry and academic projects to scale up existing workloads \nthat incorporate complex task dependencies. \n\n- [OpenTimer][OpenTimer]: A High-performance Timing Analysis Tool for Very Large Scale Integration (VLSI) Systems\n- [DtCraft][DtCraft]: A General-purpose Distributed Programming Systems using Data-parallel Streams\n- [Firestorm][Firestorm]: Fighting Game Engine with Asynchronous Resource Loaders (developed by [ForgeMistress][ForgeMistress])\n- [Shiva][Shiva]: An extensible engine via an entity component system through scripts, DLLs, and header-only (C++)\n\nPlease [let me know][email me] if I forgot your project!\n\n# Contributors\n\nCpp-Taskflow is being actively developed and contributed by the following people:\n\n- [Tsung-Wei Huang][Tsung-Wei Huang] created the Cpp-Taskflow project and implemented the core routines\n- [Chun-Xun Lin][Chun-Xun Lin] co-created the Cpp-Taskflow project and implemented the core routines\n- [Martin Wong][Martin Wong] supported the Cpp-Taskflow project through NSF and DARPA funding\n- [Andreas Olofsson][Andreas Olofsson] supported the Cpp-Taskflow project through the DARPA IDEA project\n- [Nan Xiao](https://github.com/NanXiao) fixed compilation error of unittest on the Arch platform\n- [Vladyslav](https://github.com/innermous) fixed comment errors in README.md and examples\n- [vblanco20-1](https://github.com/vblanco20-1) fixed compilation error on Microsoft Visual Studio\n- [Glen Fraser](https://github.com/totalgee) created a standalone C++14-compatible [threadpool](./taskflow/threadpool/threadpool_cxx14.hpp) for taskflow; various other fixes and examples\n- [Guannan Guo](https://github.com/gguo4) added different threadpool implementations to enhance the performance for taskflow\n- [Patrik Huber][Patrik Huber] helped fixed typos in the documentation\n- [ForgeMistress][ForgeMistress] provided API ideas about sharing the executor to avoid thread over-subscriptiong issues\n- [Alexander Neumann](https://github.com/Neumann-A) helped modify the cmake build to make Cpp-Taskflow importable from external cmake projects\n\nMeanwhile, we appreciate the support from many organizations for our development on Cpp-Taskflow.\nPlease [let me know][email me] if I forgot someone!\n\n| [\u003cimg src=\"image/uiuc.png\" width=\"100px\"\u003e][UIUC] | [\u003cimg src=\"image/csl.png\" width=\"100px\"\u003e][CSL] | [\u003cimg src=\"image/nsf.png\" width=\"100px\"\u003e][NSF] | [\u003cimg src=\"image/darpa.png\" width=\"100px\"\u003e][DARPA IDEA] |\n| :---: | :---: | :---: | :---: |\n\n\n\n# License\n\nCpp-Taskflow is licensed under the [MIT License](./LICENSE).\n\n* * *\n\n[Tsung-Wei Huang]:       https://twhuang.ece.illinois.edu/\n[Chun-Xun Lin]:          https://github.com/clin99\n[Martin Wong]:           https://ece.illinois.edu/directory/profile/mdfwong\n[Andreas Olofsson]:      https://github.com/aolofsson\n[Gitter]:                https://gitter.im/cpp-taskflow/Lobby\n[Gitter badge]:          ./image/gitter_badge.svg\n[GitHub releases]:       https://github.com/coo-taskflow/cpp-taskflow/releases\n[GitHub issues]:         https://github.com/cpp-taskflow/cpp-taskflow/issues\n[GitHub insights]:       https://github.com/cpp-taskflow/cpp-taskflow/pulse\n[GitHub pull requests]:  https://github.com/cpp-taskflow/cpp-taskflow/pulls\n[GraphViz]:              https://www.graphviz.org/\n[AwesomeGraphViz]:       https://github.com/CodeFreezr/awesome-graphviz\n[OpenMP Tasking]:        http://www.nersc.gov/users/software/programming-models/openmp/openmp-tasking/\n[TBB FlowGraph]:         https://www.threadingbuildingblocks.org/tutorial-intel-tbb-flow-graph\n[OpenTimer]:             https://github.com/OpenTimer/OpenTimer\n[DtCraft]:               http://dtcraft.web.engr.illinois.edu/\n[totalgee]:              https://github.com/totalgee\n[damienhocking]:         https://github.com/damienhocking\n[ForgeMistress]:         https://github.com/ForgeMistress\n[Patrik Huber]:          https://github.com/patrikhuber\n[DARPA IDEA]:            https://www.darpa.mil/news-events/2017-09-13\n[NSF]:                   https://www.nsf.gov/\n[UIUC]:                  https://illinois.edu/\n[CSL]:                   https://csl.illinois.edu/\n[wiki]:                  https://cpp-taskflow.github.io/cpp-taskflow/index.html\n[PayMe]:                 https://www.paypal.me/twhuang/10\n[C++17]:                 https://en.wikipedia.org/wiki/C%2B%2B17\n[email me]:              mailto:twh760812@gmail.com\n[Cpp Conference 2018]:   https://github.com/CppCon/CppCon2018\n\n[std::invoke]:           https://en.cppreference.com/w/cpp/utility/functional/invoke\n[std::future]:           https://en.cppreference.com/w/cpp/thread/future\n\n[Firestorm]:             https://github.com/ForgeMistress/Firestorm\n[Shiva]:                 https://shiva.gitbook.io/project/shiva\n\n[Presentation]:          https://cpp-taskflow.github.io/\n\n\n","versions":[],"updated":"2020-05-04T16:56:48Z","updatedUpstream":"2021-01-13T19:55:52Z","contributors":[{"login":"arun11299","avatarUrl":"https://avatars0.githubusercontent.com/u/214426?u=83c959708aca505936c771b3ab3c98a602579d62\u0026v=4"},{"login":"totalgee","avatarUrl":"https://avatars2.githubusercontent.com/u/306082?v=4"},{"login":"iplayfast","avatarUrl":"https://avatars2.githubusercontent.com/u/751306?u=6154aec048f07c938f7256877f43765a0adb7634\u0026v=4"},{"login":"SamuelMarks","avatarUrl":"https://avatars1.githubusercontent.com/u/807580?u=163debc9c32e7086f42128064501f6075a5c771e\u0026v=4"},{"login":"musteresel","avatarUrl":"https://avatars2.githubusercontent.com/u/912651?v=4"},{"login":"xgdgsc","avatarUrl":"https://avatars1.githubusercontent.com/u/1189869?v=4"},{"login":"vblanco20-1","avatarUrl":"https://avatars3.githubusercontent.com/u/1417000?v=4"},{"login":"tjhei","avatarUrl":"https://avatars2.githubusercontent.com/u/1531285?u=c46170e7d7c82d85441043632f00c502fb540db3\u0026v=4"},{"login":"leokolln","avatarUrl":"https://avatars2.githubusercontent.com/u/1807853?u=e71f9af16ee5bab62eabd3ea0c2463b79345e117\u0026v=4"},{"login":"NanXiao","avatarUrl":"https://avatars1.githubusercontent.com/u/2338189?u=50478039e7023a74d21a235ff834a3ff655a9fe2\u0026v=4"},{"login":"matt77hias","avatarUrl":"https://avatars0.githubusercontent.com/u/2464019?v=4"},{"login":"corporateshark","avatarUrl":"https://avatars2.githubusercontent.com/u/2510143?u=de3596226340b359d2dca1475ac1e452f33618f9\u0026v=4"},{"login":"patrikhuber","avatarUrl":"https://avatars3.githubusercontent.com/u/4967343?u=a9baad289285da38364dfc4971351f01ab968ff7\u0026v=4"},{"login":"vtronko","avatarUrl":"https://avatars2.githubusercontent.com/u/8950786?u=188e0fb06514a9a9e2dd4c9646e0f5bf11faa0c2\u0026v=4"},{"login":"Croolman","avatarUrl":"https://avatars1.githubusercontent.com/u/8963977?u=f1b6f859402e298130c0354fc884d0af5d4cacf7\u0026v=4"},{"login":"Levi-Armstrong","avatarUrl":"https://avatars2.githubusercontent.com/u/9803128?u=f6e9c208021299989b6d8a27c8cf60e69c3340ac\u0026v=4"},{"login":"remz1337","avatarUrl":"https://avatars0.githubusercontent.com/u/9980037?u=2c686e855b1288b5d00894f79961cb056d68e0d9\u0026v=4"},{"login":"netcan","avatarUrl":"https://avatars1.githubusercontent.com/u/11377070?u=a2c15d68fabc306aee2f5bb156dcd9b82aac7278\u0026v=4"},{"login":"mpowelson","avatarUrl":"https://avatars0.githubusercontent.com/u/12128406?v=4"},{"login":"tsung-wei-huang","avatarUrl":"https://avatars0.githubusercontent.com/u/13237509?u=3f41067960daea532c5f8c4d0fed179982cb5c02\u0026v=4"},{"login":"dian-lun-lin","avatarUrl":"https://avatars3.githubusercontent.com/u/14581032?u=35b04aff81844594e08b875e05a28eb1de7a8abb\u0026v=4"},{"login":"Ubpa","avatarUrl":"https://avatars1.githubusercontent.com/u/15104079?u=8f9636871c42da051cbac6df7a28e206d6a8676c\u0026v=4"},{"login":"MambaWong","avatarUrl":"https://avatars2.githubusercontent.com/u/16932438?u=c21836c32277772fe32ecbb2cdae52915180c1b3\u0026v=4"},{"login":"gzz2000","avatarUrl":"https://avatars1.githubusercontent.com/u/19143357?v=4"},{"login":"soonho-tri","avatarUrl":"https://avatars0.githubusercontent.com/u/20779767?u=608da8ce5f4be3ce52b6153b3caf3c8bbda5a750\u0026v=4"}],"fundingLinks":["https://github.com/taskflow"],"contactLinks":[],"stars":4778,"forks":548,"topics":["parallel-programming","threadpool","concurrent-programming","high-performance-computing","multicore-programming","multi-threading","taskparallelism","multithreading","parallel-computing","work-stealing","gpu-programming","heterogeneous-parallel-programming","cuda-programming","cuda","gpgpu"]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"cpp-taskflow"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>