<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/kuba-zip/logo.png"/></div><div><h1>buckaroo-pm/kuba-zip</h1><div style="max-width:600px">A portable, simple zip library written in C</div><br/><div><b>555</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">zip</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">compression</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">c</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">miniz</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">portable</span><span class="tag" style="border-radius:5px;padding:10px;background:white;color:black;font-size:0.7em;margin:5px">hacking</span></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Buck</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Manifest</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Dependencies</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><h3>A portable (OSX/Linux/Windows), simple zip library written in C</h3><p>This is done by hacking awesome <a href="https://code.google.com/p/miniz">miniz</a> library and layering functions on top of the miniz v1.15 API.</p><p><a href="https://ci.appveyor.com/project/kuba--/zip"><img src="https://ci.appveyor.com/api/projects/status/bph8dr3jacgmjv32/branch/master?svg=true&amp;label=windows" alt="Windows"/></a>
<a href="https://travis-ci.org/kuba--/zip"><img src="https://travis-ci.org/kuba--/zip.svg?branch=master&amp;label=linux%2fosx" alt="Linux"/></a>
<a href="https://github.com/kuba--/zip/releases"><img src="https://badge.fury.io/gh/kuba--%2Fzip.svg" alt="Version"/></a>
<a href="https://codecov.io/gh/kuba--/zip"><img src="https://codecov.io/gh/kuba--/zip/branch/master/graph/badge.svg" alt="Codecov"/></a></p><h1>The Idea</h1>&lt;img src=&quot;zip.png&quot; name=&quot;zip&quot; /&gt;
... Some day, I was looking for zip library written in C for my project, but I could not find anything simple enough and lightweight.
Everything what I tried required &#x27;crazy mental gymnastics&#x27; to integrate or had some limitations or was too heavy.
I hate frameworks, factories and adding new dependencies. If I must to install all those dependencies and link new library, I&#x27;m getting almost sick.
I wanted something powerfull and small enough, so I could add just a few files and compile them into my project.
And finally I found miniz.
Miniz is a lossless, high performance data compression library in a single source file. I only needed simple interface to append buffers or files to the current zip-entry. Thanks to this feature I&#x27;m able to merge many files/buffers and compress them on-the-fly.<p>It was the reason, why I decided to write zip module on top of the miniz. It required a little bit hacking and wrapping some functions, but I kept simplicity. So, you can grab these 3 files and compile them into your project. I hope that interface is also extremely simple, so you will not have any problems to understand it.</p><h1>Examples</h1><ul><li>Create a new zip archive with default compression level.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> ZIP_DEFAULT_COMPRESSION_LEVEL</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;w&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-1.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;Some data here...\0&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_write</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> buf</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#DD4A68">strlen</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:slategray">// merge 3 files into one entry and compress them on-the-fly.</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_fwrite</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.1.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_fwrite</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.2.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_fwrite</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.3.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Append to the existing zip archive.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> ZIP_DEFAULT_COMPRESSION_LEVEL</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;a&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-3.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;Append some data here...\0&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_write</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> buf</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#DD4A68">strlen</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Extract a zip archive into a folder.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#DD4A68">on_extract_entry</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>filename</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>arg</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">static</span><span> </span><span class="token" style="color:#07a">int</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">int</span><span> n </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token" style="color:#999">)</span><span>arg</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">printf</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;Extracted: %s (%d of %d)\n&quot;</span><span class="token" style="color:#999">,</span><span> filename</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span>i</span><span class="token" style="color:#999">,</span><span> n</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">return</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">int</span><span> arg </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_extract</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;/tmp&quot;</span><span class="token" style="color:#999">,</span><span> on_extract_entry</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>arg</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Extract a zip entry into memory.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">NULL</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#DD4A68">size_t</span><span> bufsize</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;r&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-1.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_read</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>buf</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>bufsize</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#DD4A68">free</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Extract a zip entry into memory (no internal allocation).</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">unsigned</span><span> </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>buf</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#DD4A68">size_t</span><span> bufsize</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;r&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-1.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        bufsize </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_entry_size</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">calloc</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">sizeof</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">unsigned</span><span> </span><span class="token" style="color:#07a">char</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> bufsize</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>        </span><span class="token" style="color:#DD4A68">zip_entry_noallocread</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token" style="color:#999">)</span><span>buf</span><span class="token" style="color:#999">,</span><span> bufsize</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#DD4A68">free</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Extract a zip entry into memory using callback.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">buffer_t</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>data</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">size_t</span><span> size</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">static</span><span> </span><span class="token" style="color:#DD4A68">size_t</span><span> </span><span class="token" style="color:#DD4A68">on_extract</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>arg</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">unsigned</span><span> </span><span class="token" style="color:#07a">long</span><span> </span><span class="token" style="color:#07a">long</span><span> offset</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>data</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#DD4A68">size_t</span><span> size</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">buffer_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">buffer_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token" style="color:#999">)</span><span>arg</span><span class="token" style="color:#999">;</span><span>
</span><span>    buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>data </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">realloc</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>data</span><span class="token" style="color:#999">,</span><span> buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>size </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> size </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> </span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">assert</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">NULL</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!=</span><span> buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>data</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#DD4A68">memcpy</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>data</span><span class="token" style="color:#999">[</span><span>buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>size</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> data</span><span class="token" style="color:#999">,</span><span> size</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>size </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+=</span><span> size</span><span class="token" style="color:#999">;</span><span>
</span><span>    buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>data</span><span class="token" style="color:#999">[</span><span>buf</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-&gt;</span><span>size</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">return</span><span> size</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">buffer_t</span><span> buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;r&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-1.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_extract</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> on_extract</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span>buf</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#DD4A68">free</span><span class="token" style="color:#999">(</span><span>buf</span><span class="token" style="color:#999">.</span><span>data</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>Extract a zip entry into a file.</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;r&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">zip_entry_fread</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;foo-2.txt&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><ul><li>List of all zip entries</li></ul><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-c" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">struct</span><span> </span><span class="token" style="color:#DD4A68">zip_t</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;foo.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;r&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">int</span><span> i</span><span class="token" style="color:#999">,</span><span> n </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_total_entries</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">for</span><span> </span><span class="token" style="color:#999">(</span><span>i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> n</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span>i</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_openbyindex</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> i</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">char</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>name </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_entry_name</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#07a">int</span><span> isdir </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_entry_isdir</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#07a">unsigned</span><span> </span><span class="token" style="color:#07a">long</span><span> </span><span class="token" style="color:#07a">long</span><span> size </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_entry_size</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#07a">unsigned</span><span> </span><span class="token" style="color:#07a">int</span><span> crc32 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">zip_entry_crc32</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></pre><h1>Bindings</h1><p>Compile zip library as a dynamic library.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ </span><span class="token" style="color:#DD4A68">mkdir</span><span> build
</span><span>$ </span><span class="token" style="color:#DD4A68">cd</span><span> build
</span><span>$ cmake -DBUILD_SHARED_LIBS</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>true </span><span class="token" style="color:#999">..</span><span>
</span><span>$ </span><span class="token" style="color:#DD4A68">make</span></code></pre><h3>Go (cgo)</h3><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-go" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">package</span><span> main
</span>
<span></span><span class="token" style="color:slategray">/*
</span><span class="token" style="color:slategray">#cgo CFLAGS: -I../src
</span><span class="token" style="color:slategray">#cgo LDFLAGS: -L. -lzip
</span><span class="token" style="color:slategray">#include &lt;zip.h&gt;
</span><span class="token" style="color:slategray">*/</span><span>
</span><span></span><span class="token" style="color:#07a">import</span><span> </span><span class="token" style="color:#690">&quot;C&quot;</span><span>
</span><span></span><span class="token" style="color:#07a">import</span><span> </span><span class="token" style="color:#690">&quot;unsafe&quot;</span><span>
</span>
<span></span><span class="token" style="color:#07a">func</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>	path </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">CString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;/tmp/go.zip&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span>	zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">zip_open</span><span class="token" style="color:#999">(</span><span>path</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;w&#x27;</span><span class="token" style="color:#999">)</span><span>
</span>
<span>	entryname </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">CString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;test&quot;</span><span class="token" style="color:#999">)</span><span>
</span><span>	C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">zip_entry_open</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> entryname</span><span class="token" style="color:#999">)</span><span>
</span>
<span>	content </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> </span><span class="token" style="color:#690">&quot;test content&quot;</span><span>
</span><span>	buf </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> unsafe</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">Pointer</span><span class="token" style="color:#999">(</span><span>C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">CString</span><span class="token" style="color:#999">(</span><span>content</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span><span>	bufsize </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:=</span><span> C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">size_t</span><span class="token" style="color:#999">(</span><span class="token" style="color:#DD4A68">len</span><span class="token" style="color:#999">(</span><span>content</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span><span>	C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">zip_entry_write</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">,</span><span> buf</span><span class="token" style="color:#999">,</span><span> bufsize</span><span class="token" style="color:#999">)</span><span>
</span>
<span>	C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">zip_entry_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span>
</span>
<span>	C</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">zip_close</span><span class="token" style="color:#999">(</span><span>zip</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><h3>Ruby (ffi)</h3><p>Install <em>ffi</em> gem.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ gem </span><span class="token" style="color:#DD4A68">install</span><span> ffi</span></code></pre><p>Bind in your module.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ruby" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">require</span><span> </span><span class="token" style="color:#690">&#x27;ffi&#x27;</span><span>
</span>
<span></span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#905">Zip</span><span>
</span><span>  </span><span class="token" style="color:#07a">extend</span><span> </span><span class="token" style="color:#905">FFI</span><span class="token" style="color:#999">:</span><span class="token" style="color:#999">:</span><span class="token" style="color:#905">Library</span><span>
</span><span>  ffi_lib </span><span class="token" style="color:#690">&quot;./libzip.</span><span class="token interpolation delimiter" style="color:#905">#{</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#905">FFI</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#905">Platform</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#999">:</span><span class="token interpolation" style="color:#905">LIBSUFFIX</span><span class="token interpolation delimiter" style="color:#905">}</span><span class="token" style="color:#690">&quot;</span><span>
</span>
<span>  attach_function </span><span class="token" style="color:#905">:zip_open</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">:string</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:int</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:char</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:pointer</span><span>
</span><span>  attach_function </span><span class="token" style="color:#905">:zip_close</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">:pointer</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:void</span><span>
</span>
<span>  attach_function </span><span class="token" style="color:#905">:zip_entry_open</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">:pointer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:string</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:int</span><span>
</span><span>  attach_function </span><span class="token" style="color:#905">:zip_entry_close</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">:pointer</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:void</span><span>
</span><span>  attach_function </span><span class="token" style="color:#905">:zip_entry_write</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">:pointer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:string</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:int</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">:int</span><span>
</span><span></span><span class="token" style="color:#07a">end</span><span>
</span>
<span>ptr </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">Zip</span><span class="token" style="color:#999">.</span><span>zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;/tmp/ruby.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;w&quot;</span><span class="token" style="color:#999">.</span><span>bytes</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">[</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span>
</span>
<span>status </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_open</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;test&quot;</span><span class="token" style="color:#999">)</span><span>
</span>
<span>content </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;test content&quot;</span><span>
</span><span>status </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_write</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">,</span><span> content</span><span class="token" style="color:#999">,</span><span> content</span><span class="token" style="color:#999">.</span><span>size</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span>
<span></span><span class="token" style="color:#905">Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_close</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#905">Zip</span><span class="token" style="color:#999">.</span><span>zip_close</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">)</span></code></pre><h3>Python (cffi)</h3><p>Install <em>cffi</em> package</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>$ pip </span><span class="token" style="color:#DD4A68">install</span><span> cffi</span></code></pre><p>Bind in your package.</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-python" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">import</span><span> ctypes</span><span class="token" style="color:#999">.</span><span>util
</span><span></span><span class="token" style="color:#07a">from</span><span> cffi </span><span class="token" style="color:#07a">import</span><span> FFI
</span>
<span>ffi </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> FFI</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span>
</span><span>ffi</span><span class="token" style="color:#999">.</span><span>cdef</span><span class="token" style="color:#999">(</span><span class="token triple-quoted-string" style="color:#690">&quot;&quot;&quot;
</span><span class="token triple-quoted-string" style="color:#690">    struct zip_t *zip_open(const char *zipname, int level, char mode);
</span><span class="token triple-quoted-string" style="color:#690">    void zip_close(struct zip_t *zip);
</span><span class="token triple-quoted-string" style="color:#690">
</span><span class="token triple-quoted-string" style="color:#690">    int zip_entry_open(struct zip_t *zip, const char *entryname);
</span><span class="token triple-quoted-string" style="color:#690">    int zip_entry_close(struct zip_t *zip);
</span><span class="token triple-quoted-string" style="color:#690">    int zip_entry_write(struct zip_t *zip, const void *buf, size_t bufsize);
</span><span class="token triple-quoted-string" style="color:#690">&quot;&quot;&quot;</span><span class="token" style="color:#999">)</span><span>
</span>
<span>Zip </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> ffi</span><span class="token" style="color:#999">.</span><span>dlopen</span><span class="token" style="color:#999">(</span><span>ctypes</span><span class="token" style="color:#999">.</span><span>util</span><span class="token" style="color:#999">.</span><span>find_library</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;zip&quot;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span>
<span>ptr </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> Zip</span><span class="token" style="color:#999">.</span><span>zip_open</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&quot;/tmp/python.zip&quot;</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">6</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&#x27;w&#x27;</span><span class="token" style="color:#999">)</span><span>
</span>
<span>status </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_open</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">&quot;test&quot;</span><span class="token" style="color:#999">)</span><span>
</span>
<span>content </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&quot;test content&quot;</span><span>
</span><span>status </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_write</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">,</span><span> content</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#690">len</span><span class="token" style="color:#999">(</span><span>content</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span>
</span>
<span>Zip</span><span class="token" style="color:#999">.</span><span>zip_entry_close</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">)</span><span>
</span><span>Zip</span><span class="token" style="color:#999">.</span><span>zip_close</span><span class="token" style="color:#999">(</span><span>ptr</span><span class="token" style="color:#999">)</span></code></pre><h3>Ring</h3><p>The language comes with RingZip based on this library</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ring" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>load &quot;ziplib.ring&quot;
</span>
<!-- -->new Zip {
<!-- -->    setFileName(&quot;myfile.zip&quot;)
<!-- -->    open(&quot;w&quot;)
<!-- -->    newEntry() {
<!-- -->        open(&quot;test.c&quot;)
<!-- -->        writefile(&quot;test.c&quot;)
<!-- -->        close()
<!-- -->    }
<!-- -->    close()
<!-- -->}
</code></pre><h1>Contribution Rules/Coding Standards</h1><p>No need to throw away your coding style, just do your best to follow default clang-format style.
Apply <code>clang-format</code> to the source files before commit:</p><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>for file in $(git ls-files | \grep -E &#x27;\.(c|h)$&#x27; | \grep -v -- &#x27;#&#x27;)
</span>do
<!-- -->    clang-format -i $file
<!-- -->done
</code></pre></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/kuba-zip","name":"kuba--/zip","licence":"Unlicense","description":"A portable, simple zip library written in C","readme":"### A portable (OSX/Linux/Windows), simple zip library written in C\nThis is done by hacking awesome [miniz](https://code.google.com/p/miniz) library and layering functions on top of the miniz v1.15 API.\n\n[![Windows](https://ci.appveyor.com/api/projects/status/bph8dr3jacgmjv32/branch/master?svg=true\u0026label=windows)](https://ci.appveyor.com/project/kuba--/zip)\n[![Linux](https://travis-ci.org/kuba--/zip.svg?branch=master\u0026label=linux%2fosx)](https://travis-ci.org/kuba--/zip)\n[![Version](https://badge.fury.io/gh/kuba--%2Fzip.svg)](https://github.com/kuba--/zip/releases)\n[![Codecov](https://codecov.io/gh/kuba--/zip/branch/master/graph/badge.svg)](https://codecov.io/gh/kuba--/zip)\n\n\n# The Idea\n\u003cimg src=\"zip.png\" name=\"zip\" /\u003e\n... Some day, I was looking for zip library written in C for my project, but I could not find anything simple enough and lightweight.\nEverything what I tried required 'crazy mental gymnastics' to integrate or had some limitations or was too heavy.\nI hate frameworks, factories and adding new dependencies. If I must to install all those dependencies and link new library, I'm getting almost sick.\nI wanted something powerfull and small enough, so I could add just a few files and compile them into my project.\nAnd finally I found miniz.\nMiniz is a lossless, high performance data compression library in a single source file. I only needed simple interface to append buffers or files to the current zip-entry. Thanks to this feature I'm able to merge many files/buffers and compress them on-the-fly.\n\nIt was the reason, why I decided to write zip module on top of the miniz. It required a little bit hacking and wrapping some functions, but I kept simplicity. So, you can grab these 3 files and compile them into your project. I hope that interface is also extremely simple, so you will not have any problems to understand it.\n\n# Examples\n\n* Create a new zip archive with default compression level.\n```c\nstruct zip_t *zip = zip_open(\"foo.zip\", ZIP_DEFAULT_COMPRESSION_LEVEL, 'w');\n{\n    zip_entry_open(zip, \"foo-1.txt\");\n    {\n        const char *buf = \"Some data here...\\0\";\n        zip_entry_write(zip, buf, strlen(buf));\n    }\n    zip_entry_close(zip);\n\n    zip_entry_open(zip, \"foo-2.txt\");\n    {\n        // merge 3 files into one entry and compress them on-the-fly.\n        zip_entry_fwrite(zip, \"foo-2.1.txt\");\n        zip_entry_fwrite(zip, \"foo-2.2.txt\");\n        zip_entry_fwrite(zip, \"foo-2.3.txt\");\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n```\n\n* Append to the existing zip archive.\n```c\nstruct zip_t *zip = zip_open(\"foo.zip\", ZIP_DEFAULT_COMPRESSION_LEVEL, 'a');\n{\n    zip_entry_open(zip, \"foo-3.txt\");\n    {\n        const char *buf = \"Append some data here...\\0\";\n        zip_entry_write(zip, buf, strlen(buf));\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n```\n\n* Extract a zip archive into a folder.\n```c\nint on_extract_entry(const char *filename, void *arg) {\n    static int i = 0;\n    int n = *(int *)arg;\n    printf(\"Extracted: %s (%d of %d)\\n\", filename, ++i, n);\n\n    return 0;\n}\n\nint arg = 2;\nzip_extract(\"foo.zip\", \"/tmp\", on_extract_entry, \u0026arg);\n```\n\n* Extract a zip entry into memory.\n```c\nvoid *buf = NULL;\nsize_t bufsize;\n\nstruct zip_t *zip = zip_open(\"foo.zip\", 0, 'r');\n{\n    zip_entry_open(zip, \"foo-1.txt\");\n    {\n        zip_entry_read(zip, \u0026buf, \u0026bufsize);\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n\nfree(buf);\n```\n\n* Extract a zip entry into memory (no internal allocation).\n```c\nunsigned char *buf;\nsize_t bufsize;\n\nstruct zip_t *zip = zip_open(\"foo.zip\", 0, 'r');\n{\n    zip_entry_open(zip, \"foo-1.txt\");\n    {\n        bufsize = zip_entry_size(zip);\n        buf = calloc(sizeof(unsigned char), bufsize);\n\n        zip_entry_noallocread(zip, (void *)buf, bufsize);\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n\nfree(buf);\n```\n\n* Extract a zip entry into memory using callback.\n```c\nstruct buffer_t {\n    char *data;\n    size_t size;\n};\n\nstatic size_t on_extract(void *arg, unsigned long long offset, const void *data, size_t size) {\n    struct buffer_t *buf = (struct buffer_t *)arg;\n    buf-\u003edata = realloc(buf-\u003edata, buf-\u003esize + size + 1);\n    assert(NULL != buf-\u003edata);\n\n    memcpy(\u0026(buf-\u003edata[buf-\u003esize]), data, size);\n    buf-\u003esize += size;\n    buf-\u003edata[buf-\u003esize] = 0;\n\n    return size;\n}\n\nstruct buffer_t buf = {0};\nstruct zip_t *zip = zip_open(\"foo.zip\", 0, 'r');\n{\n    zip_entry_open(zip, \"foo-1.txt\");\n    {\n        zip_entry_extract(zip, on_extract, \u0026buf);\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n\nfree(buf.data);\n```\n\n\n* Extract a zip entry into a file.\n```c\nstruct zip_t *zip = zip_open(\"foo.zip\", 0, 'r');\n{\n    zip_entry_open(zip, \"foo-2.txt\");\n    {\n        zip_entry_fread(zip, \"foo-2.txt\");\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n```\n\n* List of all zip entries\n```c\nstruct zip_t *zip = zip_open(\"foo.zip\", 0, 'r');\nint i, n = zip_total_entries(zip);\nfor (i = 0; i \u003c n; ++i) {\n    zip_entry_openbyindex(zip, i);\n    {\n        const char *name = zip_entry_name(zip);\n        int isdir = zip_entry_isdir(zip);\n        unsigned long long size = zip_entry_size(zip);\n        unsigned int crc32 = zip_entry_crc32(zip);\n    }\n    zip_entry_close(zip);\n}\nzip_close(zip);\n```\n\n# Bindings\nCompile zip library as a dynamic library.\n```shell\n$ mkdir build\n$ cd build\n$ cmake -DBUILD_SHARED_LIBS=true ..\n$ make\n```\n\n### Go (cgo)\n```go\npackage main\n\n/*\n#cgo CFLAGS: -I../src\n#cgo LDFLAGS: -L. -lzip\n#include \u003czip.h\u003e\n*/\nimport \"C\"\nimport \"unsafe\"\n\nfunc main() {\n\tpath := C.CString(\"/tmp/go.zip\")\n\tzip := C.zip_open(path, 6, 'w')\n\n\tentryname := C.CString(\"test\")\n\tC.zip_entry_open(zip, entryname)\n\n\tcontent := \"test content\"\n\tbuf := unsafe.Pointer(C.CString(content))\n\tbufsize := C.size_t(len(content))\n\tC.zip_entry_write(zip, buf, bufsize)\n\n\tC.zip_entry_close(zip)\n\n\tC.zip_close(zip)\n}\n```\n\n### Ruby (ffi)\nInstall _ffi_ gem.\n```shell\n$ gem install ffi\n```\n\nBind in your module.\n```ruby\nrequire 'ffi'\n\nmodule Zip\n  extend FFI::Library\n  ffi_lib \"./libzip.#{::FFI::Platform::LIBSUFFIX}\"\n\n  attach_function :zip_open, [:string, :int, :char], :pointer\n  attach_function :zip_close, [:pointer], :void\n\n  attach_function :zip_entry_open, [:pointer, :string], :int\n  attach_function :zip_entry_close, [:pointer], :void\n  attach_function :zip_entry_write, [:pointer, :string, :int], :int\nend\n\nptr = Zip.zip_open(\"/tmp/ruby.zip\", 6, \"w\".bytes()[0])\n\nstatus = Zip.zip_entry_open(ptr, \"test\")\n\ncontent = \"test content\"\nstatus = Zip.zip_entry_write(ptr, content, content.size())\n\nZip.zip_entry_close(ptr)\nZip.zip_close(ptr)\n```\n\n### Python (cffi)\nInstall _cffi_ package\n```shell\n$ pip install cffi\n```\n\nBind in your package.\n```python\nimport ctypes.util\nfrom cffi import FFI\n\nffi = FFI()\nffi.cdef(\"\"\"\n    struct zip_t *zip_open(const char *zipname, int level, char mode);\n    void zip_close(struct zip_t *zip);\n\n    int zip_entry_open(struct zip_t *zip, const char *entryname);\n    int zip_entry_close(struct zip_t *zip);\n    int zip_entry_write(struct zip_t *zip, const void *buf, size_t bufsize);\n\"\"\")\n\nZip = ffi.dlopen(ctypes.util.find_library(\"zip\"))\n\nptr = Zip.zip_open(\"/tmp/python.zip\", 6, 'w')\n\nstatus = Zip.zip_entry_open(ptr, \"test\")\n\ncontent = \"test content\"\nstatus = Zip.zip_entry_write(ptr, content, len(content))\n\nZip.zip_entry_close(ptr)\nZip.zip_close(ptr)\n```\n\n### Ring\nThe language comes with RingZip based on this library\n```ring\nload \"ziplib.ring\"\n\nnew Zip {\n    setFileName(\"myfile.zip\")\n    open(\"w\")\n    newEntry() {\n        open(\"test.c\")\n        writefile(\"test.c\")\n        close()\n    }\n    close()\n}\n```\n\n# Contribution Rules/Coding Standards\nNo need to throw away your coding style, just do your best to follow default clang-format style.\nApply `clang-format` to the source files before commit:\n```sh\nfor file in $(git ls-files | \\grep -E '\\.(c|h)$' | \\grep -v -- '#')\ndo\n    clang-format -i $file\ndone\n```\n\n","versions":[{"ref":"master","manifest":"targets = [ \"//:miniz\" ]\n","lockFile":"manifest = \"1e2c172b3b7da10640f14d76872d4c3b2acfbd841665631531f3dac2594390fa\"\n\n","buck":"load('//:subdir_glob.bzl', 'subdir_glob')\n\ncxx_library(\n  name = 'miniz',\n  exported_headers = subdir_glob([\n    ('src', '*.h')\n  ]),\n  visibility = ['PUBLIC']\n)\n","bazel":"","deps":[],"lock":[]}],"updated":"2019-01-25T17:54:24Z","updatedUpstream":"2021-01-13T22:30:58Z","contributors":[{"login":"drizt","avatarUrl":"https://avatars1.githubusercontent.com/u/534665?u=d2b06fa87ed842eeb0e03e3c338727dd6709b4a9\u0026v=4"},{"login":"rbsheth","avatarUrl":"https://avatars3.githubusercontent.com/u/583212?u=13b551bc699fbb23cfe649033e43bfc10a5ed932\u0026v=4"},{"login":"nesbox","avatarUrl":"https://avatars2.githubusercontent.com/u/1101448?u=0eca70a6c88f2c8fbfa2cb2fa4e1f19fa1a630e7\u0026v=4"},{"login":"bvgastel","avatarUrl":"https://avatars3.githubusercontent.com/u/1301653?v=4"},{"login":"haozhun","avatarUrl":"https://avatars3.githubusercontent.com/u/2020503?v=4"},{"login":"kimkulling","avatarUrl":"https://avatars3.githubusercontent.com/u/2323156?u=b9dbe9412e050771885a4438b0bbacf4850b217c\u0026v=4"},{"login":"avp","avatarUrl":"https://avatars1.githubusercontent.com/u/2388586?u=07c8b12fd836734613cf6cd585158f231e3da97d\u0026v=4"},{"login":"Cgettys","avatarUrl":"https://avatars3.githubusercontent.com/u/3117273?v=4"},{"login":"kuba--","avatarUrl":"https://avatars1.githubusercontent.com/u/4056521?v=4"},{"login":"alihardan","avatarUrl":"https://avatars3.githubusercontent.com/u/4679877?v=4"},{"login":"jamesathey","avatarUrl":"https://avatars1.githubusercontent.com/u/5478953?u=bee141aff481cd4813e20e69f1425912848960db\u0026v=4"},{"login":"ForgottenTales","avatarUrl":"https://avatars2.githubusercontent.com/u/7306985?v=4"},{"login":"MahmoudFayed","avatarUrl":"https://avatars2.githubusercontent.com/u/9929374?u=60e7dece25ffc2042dda7c521b97d5155f0febf2\u0026v=4"},{"login":"mohe2015","avatarUrl":"https://avatars0.githubusercontent.com/u/13287984?v=4"},{"login":"mykhailopylyp","avatarUrl":"https://avatars3.githubusercontent.com/u/17161067?v=4"},{"login":"cpupreme","avatarUrl":"https://avatars0.githubusercontent.com/u/30322380?v=4"},{"login":"amiremohamadi","avatarUrl":"https://avatars0.githubusercontent.com/u/31338382?u=f60ed3a125596d0fe8ccae258363a67e121dd339\u0026v=4"},{"login":"jinfeihan57","avatarUrl":"https://avatars2.githubusercontent.com/u/38484902?v=4"},{"login":"timgates42","avatarUrl":"https://avatars1.githubusercontent.com/u/47873678?u=5979ac643b54da99a384068c6aa23fa56296b87e\u0026v=4"}],"fundingLinks":[],"contactLinks":[],"stars":555,"forks":136,"topics":["zip","compression","c","miniz","portable","hacking"]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"kuba-zip"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>