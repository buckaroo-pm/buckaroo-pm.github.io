<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/a0584ae5515792e72ab5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a0584ae5515792e72ab5.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ae3781fe50e43492a499.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9b549cceddc4472f1953.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" as="script"/><link rel="preload" href="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" as="script"/></head><body><div id="__next"><div class="site"><div class="navigation"><div class="view row space-between"><div class="links"><a class="buckaroo" href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="/blog">Blog</a></div><div class="search"><input placeholder="search for a module..." value=""/><button class="fa fa-search fa-large"></button></div><iframe id="star-button" src="https://ghbtns.com/github-btn.html?user=LoopPerfect&amp;repo=buckaroo&amp;type=star&amp;count=true&amp;size=large" frameBorder="0" scrolling="0" width="160px" height="30px"></iframe></div></div><div></div><div class="banner"><div style="display:flex"><div class="package"><img src="/packages/buckaroo-pm/mapbox-shelf-pack-cpp/logo.png"/></div><div><h1>buckaroo-pm/mapbox-shelf-pack-cpp</h1><div style="max-width:600px">C++ port of https://github.com/mapbox/shelf-pack</div><br/><div><b>7</b></div></div></div><div style="display:inline-flex;flex-flow:row wrap"></div></div><div style="display:flex;width:100%;justify-content:center;margin-top:-2.7em"><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:white;color:black;border:solid 1px #fff">ReadMe</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Buck</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Manifest</div><div class="tab-control" style="padding:0.5em;border-radius:0.2em;font-size:1.5em;background:none;color:white;border:solid 1px #fff">Dependencies</div></div><div class="banner white"><div class="view column"><h2>ReadMe</h2><p><a href="https://circleci.com/gh/mapbox/shelf-pack-cpp"><img src="https://circleci.com/gh/mapbox/shelf-pack-cpp.svg?style=shield" alt="Build Status"/></a></p><h2>shelf-pack-cpp</h2><p>C++ port of <a href="https://github.com/mapbox/shelf-pack">shelf-pack</a></p><p>A 2D rectangular <a href="https://en.wikipedia.org/wiki/Bin_packing_problem">bin packing</a>
data structure that uses the Shelf Best Height Fit heuristic.</p><h3>What is it?</h3><p><code>shelf-pack</code> is a library for packing little rectangles into a big rectangle.  This sounds simple enough,
but finding an optimal packing is a problem with <a href="https://en.wikipedia.org/wiki/NP-completeness">NP-Complete</a>
complexity.  One useful application of bin packing is to assemble icons or glyphs into a sprite texture.</p><p>There are many ways to approach the bin packing problem, but <code>shelf-pack</code> uses the Shelf Best
Height Fit heuristic.  It works by dividing the total space into &quot;shelves&quot;, each with a certain height.
The allocator packs rectangles onto whichever shelf minimizes the amount of wasted vertical space.</p><p><code>shelf-pack</code> is simple, fast, and works best when the rectangles have similar heights (icons and glyphs
are like this).  It is not a generalized bin packer, and can potentially waste a lot of space if the
rectangles vary significantly in height.</p><h3>Usage</h3><h4>Basic Usage</h4><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;shelf-pack.hpp&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">using</span><span> </span><span class="token" style="color:#07a">namespace</span><span> mapbox</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Initialize the sprite with a width and height..</span><span>
</span><span>    ShelfPack </span><span class="token" style="color:#DD4A68">sprite</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">64</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">64</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Pack bins one at a time..</span><span>
</span><span>    </span><span class="token" style="color:#07a">for</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">int</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> </span><span class="token" style="color:#905">5</span><span class="token" style="color:#999">;</span><span> i</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">packOne</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:slategray">// `packOne()` accepts parameters: `id`, `width`, `height`</span><span>
</span><span>        </span><span class="token" style="color:slategray">// and returns a pointer to a single allocated Bin object..</span><span>
</span><span>        </span><span class="token" style="color:slategray">// `id` is optional - pass `-1` and shelf-pack will make up a number for you..</span><span>
</span>
<span>        </span><span class="token" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>bin</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#07a">else</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#690">&quot;out of space&quot;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span>
</span>
<span>        </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">        Bin { id: 1, x: 0, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">        Bin { id: 2, x: 32, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">        Bin { id: 3, x: 0, y: 32, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">        Bin { id: 4, x: 32, y: 32, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">        out of space
</span><span class="token" style="color:slategray">        */</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Clear sprite and start over..</span><span>
</span><span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">clear</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Or, resize sprite by passing larger dimensions..</span><span>
</span><span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">resize</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">128</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">128</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>   </span><span class="token" style="color:slategray">// width, height</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></pre><h4>Batch packing</h4><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;shelf-pack.hpp&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// If you don&#x27;t want to think about the size of the sprite,</span><span>
</span><span>    </span><span class="token" style="color:slategray">// the `autoResize` option will allow it to grow as needed..</span><span>
</span><span>    ShelfPack</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>ShelfPackOptions options</span><span class="token" style="color:#999">;</span><span>
</span><span>    options</span><span class="token" style="color:#999">.</span><span>autoResize </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">;</span><span>
</span><span>    ShelfPack </span><span class="token" style="color:#DD4A68">sprite</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> options</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Bins can be allocated in batches..</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Each bin should be initialized with `id`, `w` (width), `h` (height)..</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>vector</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> bins</span><span class="token" style="color:#999">;</span><span>
</span><span>    bins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    bins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">12</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    bins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">12</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    bins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// `pack()` returns a vector of Bin* pointers, with `x`, `y`, `w`, `h` values..</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>vector</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> results </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">pack</span><span class="token" style="color:#999">(</span><span>bins</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">for</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> results</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 1, x: 0, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">    Bin { id: 2, x: 0, y: 10, w: 10, h: 12, maxw: 10, maxh: 12, refcount: 1 }
</span><span class="token" style="color:slategray">    Bin { id: 3, x: 10, y: 10, w: 10, h: 12, maxw: 10, maxh: 12, refcount: 1 }
</span><span class="token" style="color:slategray">    Bin { id: 4, x: 10, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// If you don&#x27;t mind letting ShelfPack modify your objects,</span><span>
</span><span>    </span><span class="token" style="color:slategray">// the `inPlace` option will assign `id`, `x`, `y` values to the incoming Bins.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Fancy!</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>vector</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> myBins</span><span class="token" style="color:#999">;</span><span>
</span><span>    myBins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">12</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">24</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    myBins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">12</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">12</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    myBins</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">emplace_back</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#905">1</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">10</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    ShelfPack</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>PackOptions options</span><span class="token" style="color:#999">;</span><span>
</span><span>    options</span><span class="token" style="color:#999">.</span><span>inPlace </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">true</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">pack</span><span class="token" style="color:#999">(</span><span>myBins</span><span class="token" style="color:#999">,</span><span> options</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">for</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> mybin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> myBins</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> mybin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    { id: 5, x: 0, y: 22, w: 12, h: 24, maxw: 12, maxh: 24, refcount: 1 }
</span><span class="token" style="color:slategray">    { id: 6, x: 20, y: 10, w: 12, h: 12, maxw: 12, maxh: 12, refcount: 1 }
</span><span class="token" style="color:slategray">    { id: 7, x: 20, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }
</span><span class="token" style="color:slategray">    */</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
</code></pre><h4>Reference Counting</h4><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-cpp" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;shelf-pack.hpp&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;iostream&gt;</span><span>
</span><span></span><span class="token macro directive-hash" style="color:#905">#</span><span class="token macro directive" style="color:#07a">include</span><span class="token macro" style="color:#905"> </span><span class="token macro" style="color:#690">&lt;array&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#DD4A68">main</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Initialize the sprite with a width and height..</span><span>
</span><span>    ShelfPack </span><span class="token" style="color:#DD4A68">sprite</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">64</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">64</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Allocated bins are automatically reference counted.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// They start out having a refcount of 1.</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>array</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#07a">int32_t</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">3</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> ids </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">101</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">102</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">for</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#07a">auto</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;</span><span> id </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> ids</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">packOne</span><span class="token" style="color:#999">(</span><span>id</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 100, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }
</span><span class="token" style="color:slategray">    Bin { id: 101, x: 16, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }
</span><span class="token" style="color:slategray">    Bin { id: 102, x: 32, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// If you try to pack the same id again, shelf-pack will not re-pack it.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Instead, it will increment the reference count automatically..</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin102 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">packOne</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">102</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin102 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 102, x: 32, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 2 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// You can also manually increment the reference count..</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin101 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">getBin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">101</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">ref</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin101</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin101 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 101, x: 16, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 2 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// ...and decrement it!</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin100 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">getBin</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">100</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">unref</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin100</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin100 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 100, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 0 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Bins with a refcount of 0 are considered free space.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// Next time a bin is packed, shelf-back tries to reuse free space first.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// See how Bin 103 gets allocated at [0,0] - Bin 100&#x27;s old spot!</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin103 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">packOne</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">103</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">15</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin103 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 103, x: 0, y: 0, w: 16, h: 15, maxw: 16, maxh: 16, refcount: 1 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">// Bin 103 may be smaller (16x15) but it knows 16x16 was its original size.</span><span>
</span><span>    </span><span class="token" style="color:slategray">// If that space becomes free again, a 16x16 bin will still fit there.</span><span>
</span><span>    sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">unref</span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin103</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    Bin</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> bin104 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> sprite</span><span class="token" style="color:#999">.</span><span class="token" style="color:#DD4A68">packOne</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">104</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">16</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>cout </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span>bin104 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span> std</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">::</span><span>endl</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:slategray">/* output:
</span><span class="token" style="color:slategray">    Bin { id: 104, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }
</span><span class="token" style="color:slategray">    */</span><span>
</span>
</code></pre><h3>Documentation</h3><p>Complete API documentation can be found on the JavaScript version of the project:
<a href="http://mapbox.github.io/shelf-pack/docs/">http://mapbox.github.io/shelf-pack/docs/</a></p><h3>See also</h3><p>J. Jylänky, &quot;A Thousand Ways to Pack the Bin - A Practical
Approach to Two-Dimensional Rectangle Bin Packing,&quot;
<a href="http://clb.demon.fi/files/RectangleBinPack.pdf">http://clb.demon.fi/files/RectangleBinPack.pdf</a>, 2010</p></div></div><div class="banner footer"><div class="view column"><div class="actions"><div class="links"><a href="/">Buckaroo</a><a href="https://github.com/LoopPerfect/buckaroo/wiki" target="_blank">Docs</a><a href="https://github.com/LoopPerfect/buckaroo" target="_blank">GitHub</a></div><div class="signup"><h1 class="action">Sign up for our Newsletter</h1><div class="info">Get the latest updates about new packages and Buckaroo releases.</div><button>Sign Up</button></div></div><div class="powered"><img src="/LoopPerfectInvertSmall.png"/><span>Powered by LoopPerfect</span></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"packageName":"buckaroo-pm/mapbox-shelf-pack-cpp","name":"mapbox/shelf-pack-cpp","licence":"ISC","description":"C++ port of https://github.com/mapbox/shelf-pack","readme":"[![Build Status](https://circleci.com/gh/mapbox/shelf-pack-cpp.svg?style=shield)](https://circleci.com/gh/mapbox/shelf-pack-cpp)\n\n## shelf-pack-cpp\n\nC++ port of [shelf-pack](https://github.com/mapbox/shelf-pack)\n\nA 2D rectangular [bin packing](https://en.wikipedia.org/wiki/Bin_packing_problem)\ndata structure that uses the Shelf Best Height Fit heuristic.\n\n\n### What is it?\n\n`shelf-pack` is a library for packing little rectangles into a big rectangle.  This sounds simple enough,\nbut finding an optimal packing is a problem with [NP-Complete](https://en.wikipedia.org/wiki/NP-completeness)\ncomplexity.  One useful application of bin packing is to assemble icons or glyphs into a sprite texture.\n\nThere are many ways to approach the bin packing problem, but `shelf-pack` uses the Shelf Best\nHeight Fit heuristic.  It works by dividing the total space into \"shelves\", each with a certain height.\nThe allocator packs rectangles onto whichever shelf minimizes the amount of wasted vertical space.\n\n`shelf-pack` is simple, fast, and works best when the rectangles have similar heights (icons and glyphs\nare like this).  It is not a generalized bin packer, and can potentially waste a lot of space if the\nrectangles vary significantly in height.\n\n\n### Usage\n\n#### Basic Usage\n\n```cpp\n#include \u003cshelf-pack.hpp\u003e\n#include \u003ciostream\u003e\n\nusing namespace mapbox;\n\nvoid main(void) {\n\n    // Initialize the sprite with a width and height..\n    ShelfPack sprite(64, 64);\n\n    // Pack bins one at a time..\n    for (int i = 0; i \u003c 5; i++) {\n        Bin* bin = sprite.packOne(-1, 10, 10);\n        // `packOne()` accepts parameters: `id`, `width`, `height`\n        // and returns a pointer to a single allocated Bin object..\n        // `id` is optional - pass `-1` and shelf-pack will make up a number for you..\n\n        if (bin) {\n            std::cout \u003c\u003c *bin \u003c\u003c std::endl;\n        } else {\n            std::cout \u003c\u003c \"out of space\" \u003c\u003c std::endl;\n        }\n\n        /* output:\n        Bin { id: 1, x: 0, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n        Bin { id: 2, x: 32, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n        Bin { id: 3, x: 0, y: 32, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n        Bin { id: 4, x: 32, y: 32, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n        out of space\n        */\n    }\n\n    // Clear sprite and start over..\n    sprite.clear();\n\n    // Or, resize sprite by passing larger dimensions..\n    sprite.resize(128, 128);   // width, height\n}\n```\n\n\n#### Batch packing\n\n```cpp\n#include \u003cshelf-pack.hpp\u003e\n#include \u003ciostream\u003e\n\nvoid main(void) {\n\n    // If you don't want to think about the size of the sprite,\n    // the `autoResize` option will allow it to grow as needed..\n    ShelfPack::ShelfPackOptions options;\n    options.autoResize = true;\n    ShelfPack sprite(10, 10, options);\n\n    // Bins can be allocated in batches..\n    // Each bin should be initialized with `id`, `w` (width), `h` (height)..\n    std::vector\u003cBin\u003e bins;\n    bins.emplace_back(-1, 10, 10);\n    bins.emplace_back(-1, 10, 12);\n    bins.emplace_back(-1, 10, 12);\n    bins.emplace_back(-1, 10, 10);\n\n    // `pack()` returns a vector of Bin* pointers, with `x`, `y`, `w`, `h` values..\n    std::vector\u003cBin*\u003e results = sprite.pack(bins);\n\n    for (const auto\u0026 bin : results) {\n        std::cout \u003c\u003c *bin \u003c\u003c std::endl;\n    }\n    /* output:\n    Bin { id: 1, x: 0, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n    Bin { id: 2, x: 0, y: 10, w: 10, h: 12, maxw: 10, maxh: 12, refcount: 1 }\n    Bin { id: 3, x: 10, y: 10, w: 10, h: 12, maxw: 10, maxh: 12, refcount: 1 }\n    Bin { id: 4, x: 10, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n    */\n\n    // If you don't mind letting ShelfPack modify your objects,\n    // the `inPlace` option will assign `id`, `x`, `y` values to the incoming Bins.\n    // Fancy!\n    std::vector\u003cBin\u003e myBins;\n    myBins.emplace_back(-1, 12, 24);\n    myBins.emplace_back(-1, 12, 12);\n    myBins.emplace_back(-1, 10, 10);\n\n    ShelfPack::PackOptions options;\n    options.inPlace = true;\n\n    sprite.pack(myBins, options);\n\n    for (const auto\u0026 mybin : myBins) {\n        std::cout \u003c\u003c mybin \u003c\u003c std::endl;\n    }\n\n    /* output:\n    { id: 5, x: 0, y: 22, w: 12, h: 24, maxw: 12, maxh: 24, refcount: 1 }\n    { id: 6, x: 20, y: 10, w: 12, h: 12, maxw: 12, maxh: 12, refcount: 1 }\n    { id: 7, x: 20, y: 0, w: 10, h: 10, maxw: 10, maxh: 10, refcount: 1 }\n    */\n}\n\n```\n\n#### Reference Counting\n\n```cpp\n#include \u003cshelf-pack.hpp\u003e\n#include \u003ciostream\u003e\n#include \u003carray\u003e\n\nvoid main(void) {\n\n    // Initialize the sprite with a width and height..\n    ShelfPack sprite(64, 64);\n    Bin* bin;\n\n    // Allocated bins are automatically reference counted.\n    // They start out having a refcount of 1.\n    std::array\u003cint32_t, 3\u003e ids = { 100, 101, 102 };\n    for(const auto\u0026 id : ids) {\n        bin = sprite.packOne(id, 16, 16);\n        std::cout \u003c\u003c *bin \u003c\u003c std::endl;\n    }\n\n    /* output:\n    Bin { id: 100, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }\n    Bin { id: 101, x: 16, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }\n    Bin { id: 102, x: 32, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }\n    */\n\n    // If you try to pack the same id again, shelf-pack will not re-pack it.\n    // Instead, it will increment the reference count automatically..\n    Bin* bin102 = sprite.packOne(102, 16, 16);\n    std::cout \u003c\u003c *bin102 \u003c\u003c std::endl;\n\n    /* output:\n    Bin { id: 102, x: 32, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 2 }\n    */\n\n    // You can also manually increment the reference count..\n    Bin* bin101 = sprite.getBin(101);\n    sprite.ref(*bin101);\n    std::cout \u003c\u003c *bin101 \u003c\u003c std::endl;\n\n    /* output:\n    Bin { id: 101, x: 16, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 2 }\n    */\n\n    // ...and decrement it!\n    Bin* bin100 = sprite.getBin(100);\n    sprite.unref(*bin100);\n    std::cout \u003c\u003c *bin100 \u003c\u003c std::endl;\n\n    /* output:\n    Bin { id: 100, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 0 }\n    */\n\n    // Bins with a refcount of 0 are considered free space.\n    // Next time a bin is packed, shelf-back tries to reuse free space first.\n    // See how Bin 103 gets allocated at [0,0] - Bin 100's old spot!\n    Bin* bin103 = sprite.packOne(103, 16, 15);\n    std::cout \u003c\u003c *bin103 \u003c\u003c std::endl;\n\n    /* output:\n    Bin { id: 103, x: 0, y: 0, w: 16, h: 15, maxw: 16, maxh: 16, refcount: 1 }\n    */\n\n    // Bin 103 may be smaller (16x15) but it knows 16x16 was its original size.\n    // If that space becomes free again, a 16x16 bin will still fit there.\n    sprite.unref(*bin103);\n    Bin* bin104 = sprite.packOne(104, 16, 16);\n    std::cout \u003c\u003c *bin104 \u003c\u003c std::endl;\n\n    /* output:\n    Bin { id: 104, x: 0, y: 0, w: 16, h: 16, maxw: 16, maxh: 16, refcount: 1 }\n    */\n\n```\n\n\n### Documentation\n\nComplete API documentation can be found on the JavaScript version of the project:\nhttp://mapbox.github.io/shelf-pack/docs/\n\n\n### See also\n\nJ. Jylänky, \"A Thousand Ways to Pack the Bin - A Practical\nApproach to Two-Dimensional Rectangle Bin Packing,\"\nhttp://clb.demon.fi/files/RectangleBinPack.pdf, 2010\n","versions":[{"ref":"master","manifest":"targets = [ \"//:shelf-pack-cpp\" ]\n","lockFile":"","buck":"prebuilt_cxx_library(\n  name = 'shelf-pack-cpp', \n  header_namespace = 'mapbox', \n  header_only = True, \n  exported_headers = subdir_glob([\n    ('include', '**/*.hpp'), \n  ]), \n  visibility = [\n    'PUBLIC', \n  ], \n)\n","bazel":"","deps":[],"lock":[]}],"updated":"2018-11-20T21:05:06Z","updatedUpstream":"2020-02-24T12:43:27Z","contributors":[{"login":"zugaldia","avatarUrl":"https://avatars1.githubusercontent.com/u/6964?u=e17bd7e9c8e0d4ca1df6956596cffc4ef10176de\u0026v=4"},{"login":"bookest","avatarUrl":"https://avatars1.githubusercontent.com/u/14640?u=75e815f366d32a63b0d223fe47182a1570a96bb3\u0026v=4"},{"login":"springmeyer","avatarUrl":"https://avatars1.githubusercontent.com/u/20300?v=4"},{"login":"mikelmaron","avatarUrl":"https://avatars1.githubusercontent.com/u/22896?u=f22126445e688b260ca316709407189f669c2083\u0026v=4"},{"login":"mourner","avatarUrl":"https://avatars2.githubusercontent.com/u/25395?u=6f04fa0e30ee06ee7ef8d13dd6c166d0ca70aeea\u0026v=4"},{"login":"sbma44","avatarUrl":"https://avatars2.githubusercontent.com/u/31717?v=4"},{"login":"sgillies","avatarUrl":"https://avatars3.githubusercontent.com/u/33697?u=518c359114c548926c56fef4b51a123e9a4a5d47\u0026v=4"},{"login":"bhousel","avatarUrl":"https://avatars1.githubusercontent.com/u/38784?u=79ec19b1b876a4ba09982a03406c2838b77ba772\u0026v=4"},{"login":"kkaefer","avatarUrl":"https://avatars1.githubusercontent.com/u/52399?u=7b3a53dfef51246b5c1342108a664842b4ea3571\u0026v=4"},{"login":"alfwatt","avatarUrl":"https://avatars1.githubusercontent.com/u/53469?u=ff9e35352887e919bfd74b6ad0bee578af80e165\u0026v=4"},{"login":"anderco","avatarUrl":"https://avatars1.githubusercontent.com/u/55106?v=4"},{"login":"yuletide","avatarUrl":"https://avatars3.githubusercontent.com/u/58695?u=6322adc3fcbff377e32f0e6299d7aaddd841dc6e\u0026v=4"},{"login":"artemp","avatarUrl":"https://avatars1.githubusercontent.com/u/59056?u=84b41abea2ca9e9c6e5a6af9277ee06e8376c68f\u0026v=4"},{"login":"tristen","avatarUrl":"https://avatars1.githubusercontent.com/u/61150?u=40b52d083ac2c6f414ef35c79271c776787e7bd0\u0026v=4"},{"login":"ivovandongen","avatarUrl":"https://avatars1.githubusercontent.com/u/64527?u=e284cc763f7ca8765196fc0f6279e7538742cdfd\u0026v=4"},{"login":"brunoabinader","avatarUrl":"https://avatars2.githubusercontent.com/u/76133?v=4"},{"login":"apendleton","avatarUrl":"https://avatars3.githubusercontent.com/u/78930?u=911348d600e91c721685538a958ee4252a854589\u0026v=4"},{"login":"yhahn","avatarUrl":"https://avatars1.githubusercontent.com/u/83384?u=b2c1ca34e763ba420f510b5a1d62201c1d9624eb\u0026v=4"},{"login":"PureW","avatarUrl":"https://avatars0.githubusercontent.com/u/85910?v=4"},{"login":"AlekseiCherkes","avatarUrl":"https://avatars3.githubusercontent.com/u/87640?u=f75d2bf7fd442db59db853feab57a208761fddef\u0026v=4"},{"login":"ianshward","avatarUrl":"https://avatars2.githubusercontent.com/u/91258?u=5e631aa4328b540f955d9c2e9e2588fcc1bd0d0d\u0026v=4"},{"login":"gundersen","avatarUrl":"https://avatars0.githubusercontent.com/u/93353?v=4"},{"login":"willwhite","avatarUrl":"https://avatars1.githubusercontent.com/u/93564?u=3e17a4a45e3ce686ca811d9ed79257db04ff345f\u0026v=4"},{"login":"lxbarth","avatarUrl":"https://avatars2.githubusercontent.com/u/98233?u=3ca609d2f417501e961958c5bef2f99327b3f84e\u0026v=4"},{"login":"jfirebaugh","avatarUrl":"https://avatars0.githubusercontent.com/u/98601?u=5b527e69ac7e93e41d9a9518e805e99bd4a08389\u0026v=4"}],"fundingLinks":[],"contactLinks":[],"stars":7,"forks":9,"topics":[]}},"__N_SSG":true},"page":"/packages/[owner]/[name]","query":{"owner":"buckaroo-pm","name":"mapbox-shelf-pack-cpp"},"buildId":"XEnVUsOG7VkTdg59Wro6f","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-617a3a2c770be2525c7f.js"></script><script src="/_next/static/chunks/main-7d1613afc8c8f43cb50f.js" async=""></script><script src="/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/_next/static/chunks/framework.ae3781fe50e43492a499.js" async=""></script><script src="/_next/static/chunks/commons.9b549cceddc4472f1953.js" async=""></script><script src="/_next/static/chunks/pages/_app-3e4ffec4bbf3a45ef50f.js" async=""></script><script src="/_next/static/chunks/c18d713dde5d8f274a9340ae8a63196292880c5e.7af0c42e7b17c91d2be5.js" async=""></script><script src="/_next/static/chunks/pages/packages/%5Bowner%5D/%5Bname%5D-bc25a6cf0982fd349b0a.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_buildManifest.js" async=""></script><script src="/_next/static/XEnVUsOG7VkTdg59Wro6f/_ssgManifest.js" async=""></script></body></html>