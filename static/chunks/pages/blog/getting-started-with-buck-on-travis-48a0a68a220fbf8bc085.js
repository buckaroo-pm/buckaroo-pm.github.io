_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[22],{KSTc:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return l})),t.d(a,"default",(function(){return m}));var n=t("rePB"),c=t("Ff2n"),s=(t("q1tI"),t("7ljp")),o=t("ZDfL");function p(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function r(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?p(Object(t),!0).forEach((function(a){Object(n.a)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var l={title:"Getting Started with Buck build on Travis CI",created:"2017-06-14T11:00:00.000Z",author:"Team Buckaroo",banner:"/posts/berlin.jpeg",attribution:"Travis CI, Made in Berlin (Photo by Markus Spiske)",__resourcePath:"blog/getting-started-with-buck-on-travis.md",__scans:{},layout:"index"},i={frontMatter:l},u=o.a;function m(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(s.a)(u,r(r(r({},i),t),{},{components:a,mdxType:"MDXLayout"}),Object(s.a)("p",null,"Getting Started with Buck build on Travis CI"),Object(s.a)("p",null,Object(s.a)("a",r({parentName:"p"},{href:"https://travis-ci.org/"}),"Travis CI")," is a service that offers free build servers for open-source projects (",Object(s.a)("a",r({parentName:"p"},{href:"https://www.crunchbase.com/organization/travis-ci/timeline#/timeline/index"}),"thanks, VCs!"),"). It has tight integration with GitHub, allowing you to automatically build and test code in a pull request before merging. This is great for projects with multiple contributors, because you can run tests without checking-out the code yourself."),Object(s.a)("p",null,"But how do you integrate a ",Object(s.a)("a",r({parentName:"p"},{href:"https://buckbuild.com/"}),"Buck")," based project with Travis CI?"),Object(s.a)("p",null,"To follow this guide you will need the following:"),Object(s.a)("ul",null,Object(s.a)("li",{parentName:"ul"},Object(s.a)("p",{parentName:"li"},"A ",Object(s.a)("a",r({parentName:"p"},{href:"https://github.com/njlr/buck-cxx-hello-world"}),"GitHub project")," that builds with Buck")),Object(s.a)("li",{parentName:"ul"},Object(s.a)("p",{parentName:"li"},"An account on ",Object(s.a)("a",r({parentName:"p"},{href:"https://travis-ci.org/"}),"Travis CI")))),Object(s.a)("h3",null,"TL;DR"),Object(s.a)("p",null,"Grab the relevant files from the ",Object(s.a)("a",r({parentName:"p"},{href:"https://github.com/njlr/buck-travis-example"}),"example repo on GitHub"),"."),Object(s.a)("h3",null,"Create a .travis.yml File"),Object(s.a)("p",null,"At the heart of a Travis project is the .travis.yml file. This is a YAML file that defines the build steps and build environment for your project. The most important property is script, which is the list of Bash commands."),Object(s.a)("p",null,"For example:"),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"dist"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," trusty\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"language"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," generic\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"script"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," ./build.sh\n")),Object(s.a)("h3",null,"Install Build Dependencies"),Object(s.a)("p",null,"Buck is not packaged with any of the Travis system images, so we will need to add an installation step to the Travis file. Installation steps live under the before_install element."),Object(s.a)("p",null,"The easiest way to get Buck running on Linux is via ",Object(s.a)("a",r({parentName:"p"},{href:"http://linuxbrew.sh/"}),"Linuxbrew"),", the Linux port of ",Object(s.a)("a",r({parentName:"p"},{href:"https://brew.sh/"}),"Homebrew"),". Like Homebrew, Linuxbrew allows us to easily install packages in userland, and it is mostly package-compatibile."),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"before_install"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Linuxbrew"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," git clone https",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"//github.com/Linuxbrew/brew.git $HOME/.linuxbrew\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' PATH="$HOME/.linuxbrew/bin',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$PATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," echo 'export PATH=\"$HOME/.linuxbrew/bin",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"$PATH\"' ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),"~/.bash_profile\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export MANPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/man",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$MANPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export INFOPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/info",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$INFOPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Buck"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew tap facebook/fb\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew install buck\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n")),Object(s.a)("p",null,"This snippet runs before the project is built. First, it installs Linuxbrew, then it uses Linuxbrew to install Buck."),Object(s.a)("p",null,"You might have noticed that we ",Object(s.a)("em",{parentName:"p"},"did not")," use the provided Linuxbrew install script. This is because it is best to keep everything in the home folder, which ensures that the Travis user has read and write access."),Object(s.a)("p",null,"Once we have Buck installed, the script portion of .travis.yml can call Buck:"),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"script"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck build ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"hello\n")),Object(s.a)("p",null,"Pulling everything together, we have the following:"),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"dist"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," trusty\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"language"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," generic\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"before_install"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Linuxbrew"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," git clone https",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"//github.com/Linuxbrew/brew.git $HOME/.linuxbrew\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' PATH="$HOME/.linuxbrew/bin',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$PATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," echo 'export PATH=\"$HOME/.linuxbrew/bin",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"$PATH\"' ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),"~/.bash_profile\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export MANPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/man",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$MANPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export INFOPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/info",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$INFOPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Buck"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew tap facebook/fb\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew install buck\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"script"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck build ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"hello\n")),Object(s.a)("p",null,"Add this file to the root of your project, and be sure to change the buck build command to point to the correct Buck target!"),Object(s.a)("h3",null,"Connect Travis CI to GitHub"),Object(s.a)("p",null,"Once the Travis file is in place, you need to connect Travis CI to your GitHub project. ",Object(s.a)("a",r({parentName:"p"},{href:"https://travis-ci.org/"}),"Create an account on Travis CI"),", then flick the switch on the project you want to integrate."),Object(s.a)("p",null,Object(s.a)("img",r({parentName:"p"},{src:"/posts/travis-toggles.png",alt:null}))),Object(s.a)("p",null,"Travis will now be integrated with your project, and it will start building master. You will also notice useful notifications appear in your pull requests!"),Object(s.a)("h3",null,"Accelerating the Build"),Object(s.a)("p",null,"The build will take a while because it has to install all of the dependencies each time! We can improve this massively by taking advantage of Travis CI\u2019s cache feature."),Object(s.a)("p",null,"Travis CI allows you to mark a directory as cached, which means it gets re-used between builds. Since we installed Linuxbrew in userland, we can just cache the whole ~/.linuxbrew directory. On subsequent builds, Linuxbrew will detect that our dependencies are already installed and skip the installation step."),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"cache"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"directories"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," $HOME/.linuxbrew/\n")),Object(s.a)("p",null,"We also need to make sure that we do not git clone Linuxbrew twice:"),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"before_install"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Linuxbrew"),"\n    ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," test ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"d $HOME/.linuxbrew/bin ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"|"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"|")," git clone https",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"//github.com/Linuxbrew/brew.git $HOME/.linuxbrew\n")),Object(s.a)("p",null,"Pulling everything together gives us the finished Travis file:"),Object(s.a)("pre",r({},{className:"language-yaml"}),Object(s.a)("code",r({parentName:"pre"},{className:"language-yaml"}),"\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"dist"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," trusty\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"language"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":")," generic\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"before_install"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Linuxbrew"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," test ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"d $HOME/.linuxbrew/bin ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"|"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"|")," git clone https",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"//github.com/Linuxbrew/brew.git $HOME/.linuxbrew\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' PATH="$HOME/.linuxbrew/bin',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$PATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," echo 'export PATH=\"$HOME/.linuxbrew/bin",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"$PATH\"' ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),">"),"~/.bash_profile\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export MANPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/man",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$MANPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),' export INFOPATH="$(brew ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"prefix)/share/info",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),'$INFOPATH"\n  ',Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token comment"}),"# Install Buck"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew tap facebook/fb\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," brew install buck\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"version\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"script"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," buck build ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"hello\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"branches"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"except"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," gh",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-"),"pages\n\n",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"cache"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n  ",Object(s.a)("span",r({parentName:"code"},{className:"token key atrule"}),"directories"),Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",Object(s.a)("span",r({parentName:"code"},{className:"token punctuation"}),"-")," $HOME/.linuxbrew/\n")),Object(s.a)("h3",null,"Conclusion"),Object(s.a)("p",null,"And that\u2019s it! The full Travis file should be enough to get started, or you can grab the relevant files from the ",Object(s.a)("a",r({parentName:"p"},{href:"https://github.com/njlr/buck-travis-example"}),"example repo on GitHub"),"."),Object(s.a)("p",null,Object(s.a)("img",r({parentName:"p"},{src:"https://cdn-images-1.medium.com/max/2272/1*0hqOaABQ7XGPT-OYNgiUBg.png",alt:null}))),Object(s.a)("p",null,Object(s.a)("img",r({parentName:"p"},{src:"https://cdn-images-1.medium.com/max/2272/1*Vgw1jkA6hgnvwzTsfMlnpg.png",alt:null}))),Object(s.a)("p",null,Object(s.a)("img",r({parentName:"p"},{src:"https://cdn-images-1.medium.com/max/2272/1*gKBpq1ruUi0FVK2UM_I4tQ.png",alt:null}))),Object(s.a)("blockquote",null,Object(s.a)("p",{parentName:"blockquote"},Object(s.a)("a",r({parentName:"p"},{href:"http://bit.ly/Hackernoon"}),"Hacker Noon")," is how hackers start their afternoons. We\u2019re a part of the ",Object(s.a)("a",r({parentName:"p"},{href:"http://bit.ly/atAMIatAMI"}),"@AMI")," family. We are now ",Object(s.a)("a",r({parentName:"p"},{href:"http://bit.ly/hackernoonsubmission"}),"accepting submissions")," and happy to ",Object(s.a)("a",r({parentName:"p"},{href:"mailto:partners@amipublications.com"}),"discuss advertising & sponsorship")," opportunities.\nIf you enjoyed this story, we recommend reading our ",Object(s.a)("a",r({parentName:"p"},{href:"http://bit.ly/hackernoonlatestt"}),"latest tech stories")," and ",Object(s.a)("a",r({parentName:"p"},{href:"https://hackernoon.com/trending"}),"trending tech stories"),". Until next time, don\u2019t take the realities of the world for granted!")),Object(s.a)("p",null,Object(s.a)("img",r({parentName:"p"},{src:"https://cdn-images-1.medium.com/max/30000/1*35tCjoPcvq6LbB3I6Wegqw.jpeg",alt:null}))))}m.isMDXComponent=!0},zOFG:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/getting-started-with-buck-on-travis",function(){return t("KSTc")}])}},[["zOFG",0,2,1,3,4]]]);