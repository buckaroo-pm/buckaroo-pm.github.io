_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[26],{"1GxQ":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/introducing-conduit-lazy-sequences-for-c",function(){return t("PWXq")}])},PWXq:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return r})),t.d(a,"default",(function(){return l}));var n=t("rePB"),c=t("Ff2n"),o=(t("q1tI"),t("7ljp")),s=t("ZDfL");function p(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function m(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?p(Object(t),!0).forEach((function(a){Object(n.a)(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}var r={title:"Introducing Conduit: Lazy Sequences Using the Coroutine TS",banner:"/posts/introducing-conduit.png",author:"Team Buckaroo",created:"2018-10-31T11:00:00.000Z",__resourcePath:"blog/introducing-conduit-lazy-sequences-for-c.md",__scans:{},layout:"index"},N={frontMatter:r},u=s.a;function l(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(o.a)(u,m(m(m({},N),t),{},{components:a,mdxType:"MDXLayout"}),Object(o.a)("p",null,Object(o.a)("a",m({parentName:"p"},{href:"https://github.com/LoopPerfect/conduit"}),"Conduit")," is a new library that leverages the ",Object(o.a)("a",m({parentName:"p"},{href:"https://lewissbaker.github.io/2017/09/25/coroutine-theory"}),"Coroutine TS")," to introduce lazy sequences to C++."),Object(o.a)("p",null,"Lazy sequences are an idea that\u2019s very popular in the functional-programming community, but less common in the C++ world."),Object(o.a)("blockquote",null,Object(o.a)("h1",{parentName:"blockquote"},Object(o.a)("strong",{parentName:"h1"},"Simply put, a lazy sequence is one where the elements are computed as they are requested, rather than in advance."))),Object(o.a)("p",null,"This can lead to big efficiency gains since you only perform the computation required. It also allows you to represent infinite sequences, which of course could never fit into a vector!"),Object(o.a)("p",null,"Let\u2019s see how Conduit works with some simple examples\u2026"),Object(o.a)("h2",null,"Square Numbers"),Object(o.a)("p",null,"Everyone is familiar with square numbers, so this is a great place to start."),Object(o.a)("blockquote",null,Object(o.a)("p",{parentName:"blockquote"},Object(o.a)("em",{parentName:"p"},"0, 1, 4, 9, 16, \u2026"))),Object(o.a)("p",null,"A Conduit sequence is defined using the seq template. Here we have a sequence of ints:"),Object(o.a)("pre",m({},{className:"language-cpp"}),Object(o.a)("code",m({parentName:"pre"},{className:"language-cpp"}),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," squares ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"->")," seq",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"while")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token boolean"}),"true"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"co_yield")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"*")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"++"),"x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(o.a)("p",null,"You might see the while (true) and be alarmed, but don\u2019t worry! This function is a coroutine, meaning it can suspend its execution and return control back to the caller. This prevents an infinite loop."),Object(o.a)("p",null,"The suspension point is co_yield x * x. This statement saves the stack onto the heap for later reuse, returns the next sequence element and jumps execution back to the caller."),Object(o.a)("p",null,"OK\u2026 but how do I use this in practice?"),Object(o.a)("p",null,"Every seq can be used as an iterator:"),Object(o.a)("pre",m({},{className:"language-cpp"}),Object(o.a)("code",m({parentName:"pre"},{className:"language-cpp"}),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," i ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"for")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),":")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"squares"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  std",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"::"),"cout ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<<")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<<")," std",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"::"),"endl",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// squares is infinite, so we need to break"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"if")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"i ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"10"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"break"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n  \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"++"),"i",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.a)("p",null,"Alternatively, you can save the whole sequence into a std::vector. Just be sure not to try this on an infinite sequence!"),Object(o.a)("pre",m({},{className:"language-cpp"}),Object(o.a)("code",m({parentName:"pre"},{className:"language-cpp"}),"std",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"::"),"vector",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," v ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"range"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"take"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"5"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"toVector"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// v = { 0, 1, 2, 3, 4 }"),"\n")),Object(o.a)("h2",null,"Sequence Transformations"),Object(o.a)("p",null,"This is pretty cool, but things get really interesting once you start combining and transforming sequences. To give you some idea, look at how concisely these functions can be implemented\u2026"),Object(o.a)("pre",m({},{className:"language-cpp"}),Object(o.a)("code",m({parentName:"pre"},{className:"language-cpp"}),Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// Sum of the first 10 squares "),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," total ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"squares"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"take"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"10"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"sum"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// Jumps between the first 10 squares"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," jumps ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"squares"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"scan"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," y",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"return")," y ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"-")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"take"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"10"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// The obligatory fibonacci"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," fibonacci ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"->")," seq",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," a ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";")," \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," b ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"1"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"while")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"(")," ",Object(o.a)("span",m({parentName:"code"},{className:"token boolean"}),"true")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"co_yield")," a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n    \n    ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"tie"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," b",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," tuple",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"a ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"+")," b",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// Cumulative sum of 6 pseduo-random dice rolls"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," randoms ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," seed",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"->")," seq",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"double"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token comment"}),"// pseudo-random"),"\n  std",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"::"),"mt19937 ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"engine"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"seed",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  std",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"::"),"uniform_real_distribution",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," dist",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"while")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token boolean"}),"true"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"co_yield")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"dist"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"engine",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," rolls ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"randoms"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"map"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"return")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"ceil"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"*")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"6"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"scan"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," y",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"return")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"+")," y",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"take"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"6"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n")),Object(o.a)("p",null,"As you can see, many sequences are simple transformations of others, and Conduit allows us to represent this with a terse syntax."),Object(o.a)("h2",null,"Compiler Optimization"),Object(o.a)("p",null,Object(o.a)("a",m({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Alan_Perlis"}),"Alan Perlis")," once joked that LISP programmers know the value of everything and the cost of nothing. And indeed a common criticism of lazy sequences is that they are far slower than transformations over vectors."),Object(o.a)("blockquote",null,Object(o.a)("h1",{parentName:"blockquote"},"LISP programmers know the value of everything and the cost of nothing. \u2014 Alan Perlis")),Object(o.a)("p",null,"However, with Clang and the Coroutine TS, we\u2019ve found that these abstractions usually compile away!"),Object(o.a)("p",null,"For example, consider this Fibonacci program:"),Object(o.a)("pre",m({},{className:"language-cpp"}),Object(o.a)("code",m({parentName:"pre"},{className:"language-cpp"}),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," fibonacci ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"["),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"]"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"->")," seq",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"<"),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"unsigned")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"long")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"long"),Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," a ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0ll"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";")," \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," b ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"1ll"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"while")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token boolean"}),"true"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"co_yield")," a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n    \n    ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"tie"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," b",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," tuple",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"a ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"+")," b",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),",")," a",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"static")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"long")," N ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"50"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"int")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"main"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," n ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," N",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," items ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"fibonacci"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," \n    ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"drop"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"n ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"-")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"10"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),">>")," ",Object(o.a)("span",m({parentName:"code"},{className:"token function"}),"take"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),"n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"unsigned")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"long")," ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"long")," result ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"=")," ",Object(o.a)("span",m({parentName:"code"},{className:"token number"}),"0"),Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"for")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"("),Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"auto")," x ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),":")," items",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),")")," ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"{"),"\n    result ",Object(o.a)("span",m({parentName:"code"},{className:"token operator"}),"+=")," x",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n  \n  ",Object(o.a)("span",m({parentName:"code"},{className:"token keyword"}),"return")," result",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(o.a)("span",m({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.a)("p",null,"Incredibly, Clang optimizes this to just:"),Object(o.a)("pre",null,Object(o.a)("code",m({parentName:"pre"},{}),"main: # @main\n  mov eax, 511172301\n  ret\n")),Object(o.a)("p",null,"Amazing stuff!"),Object(o.a)("h2",null,"Try Conduit"),Object(o.a)("p",null,"Conduit is available as a ",Object(o.a)("a",m({parentName:"p"},{href:"https://github.com/LoopPerfect/conduit/releases"}),"header-only library")," on ",Object(o.a)("a",m({parentName:"p"},{href:"https://github.com/loopperfect/conduit"}),"GitHub"),". All you need is a C++ compiler with the Coroutine TS."),Object(o.a)("p",null,"Want to contribute? We have an actively maintained list of issues over on the ",Object(o.a)("a",m({parentName:"p"},{href:"https://github.com/loopperfect/conduit/issues"}),"tracker"),". \ud83d\udc96"),Object(o.a)("h2",null,"Since You\u2019re Here\u2026"),Object(o.a)("p",null,"We recently announced ",Object(o.a)("a",m({parentName:"p"},{href:"https://buildinfer.loopperfect.com/"}),"BuildInfer"),", a new tool to optimize your C/C++ build scripts. ",Object(o.a)("a",m({parentName:"p"},{href:"https://buildinfer.loopperfect.com/"}),"Take a look"),"!"),Object(o.a)("p",null,Object(o.a)("img",m({parentName:"p"},{src:"https://cdn-images-1.medium.com/max/2000/1*pkwieX1RSK5S0LXbFyaEJg.png",alt:null}))))}l.isMDXComponent=!0}},[["1GxQ",0,2,1,3,4]]]);